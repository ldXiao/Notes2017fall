\documentclass[11pt]{article}
\usepackage{amssymb}
\usepackage{latexsym}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{stmaryrd}
\usepackage{fancyhdr}
\pagestyle{headings}
\usepackage{dsfont}
\usepackage{pifont}
\usepackage{mathtools}
\usepackage{natbib}
\usepackage{tikz-cd}
\usepackage{pgfplots}
\usepackage{enumitem} 
\usepackage{hyperref}
\usepackage{geometry}
\geometry{left=4cm,right=4cm}
\pgfplotsset{every axis/.append style={
                    axis x line=middle,    % put the x axis in the middle
                    axis y line=middle,    % put the y axis in the middle
                    axis line style={<->}, % arrows on the axis
                    xlabel={$x$},          % default put x on x-axis
                    ylabel={$y$},          % default put y on y-axis
                    ticks=none,
                    }}
%\usepackage[urw-garamond]{mathdesign}
%\usepackage{cmbright}
%\usepackage{concmath}
%\usepackage{sansmathfonts}
%\renewcommand*\familydefault{\sfdefault} %% Only if the base font of the document is to be sans serif

%\usepackage{pdfrender,xcolor,scrpage2}
%\pdfrender{StrokeColor=black,TextRenderingMode=2,LineWidth=1pt}
\tikzset{
  subseteq/.style={
    draw=none,
    edge node={node [sloped, allow upside down, auto=false]{$\subseteq$}}},
  Subseteq/.style={
    draw=none,
    every to/.append style={
      edge node={node [sloped, allow upside down, auto=false]{$\subseteq$}}}
    },
    Subsetneq/.style={
    draw=none,
    every to/.append style={
      edge node={node [sloped, allow upside down, auto=false]{$\subsetneq$}}}
    },
  Supseteq/.style={
    draw=none,
    every to/.append style={
      edge node={node [sloped, allow upside down, auto=false]{$\supseteq$}}}
  }
}

\hypersetup{
    colorlinks,
    citecolor=blue,
    filecolor=blue,
    linkcolor=blue,
    urlcolor=blue
}
\newtheorem{thm}{Theorem}[section]
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{dfn}[thm]{Definition}
\newtheorem{axiom}[thm]{Axiom}
\newtheorem{rmk}[thm]{Remark}
\newtheorem{rmkt}[thm]{Remark by TeXer}
\newtheorem{ex}[thm]{Example}
\newtheorem{nex}[thm]{Non-example}
\newtheorem{exercise}[thm]{Exercise}
\newtheorem{question}[thm]{Question}
\newtheorem{problem}[thm]{Problem}
\newtheorem{dfn/thm}[thm]{Definition/Theorem}
\renewcommand{\baselinestretch}{1.1}
\newcommand{\reals}{\mathbb R}
\newcommand{\cplx}{\mathbb C}
\newcommand{\intg}{\mathbb Z}
\newcommand{\bbf}{\mathbb F}
\newcommand{\ratl}{\mathbb Q}
\newcommand{\torus}{\mathbb T}
\newcommand{\sca}{{\mathfrak a}}
\newcommand{\scb}{{\mathfrak b}}
\newcommand{\scc}{{\mathfrak c}}
\newcommand{\scm}{{\mathfrak m}}
\newcommand{\scn}{{\mathfrak n}}
\newcommand{\scp}{{\mathfrak p}}
\newcommand{\scq}{\mathfrak q}
\newcommand{\frakg}{{\mathfrak g}}
\newcommand{\frakd}{{\mathfrak d}}
\newcommand{\calf}{{\cal F}}
\newcommand{\calg}{{\cal G}}
\newcommand{\cala}{{\cal A}}
\newcommand{\calb}{{\cal B}}
\newcommand{\calc}{{\cal C}}
\newcommand{\cale}{{\cal E}}
\newcommand{\cali}{{\cal I}}
\newcommand{\call}{{\cal L}}
\newcommand{\caln}{{\cal N}}
\newcommand{\calo}{{\cal O}}
\newcommand{\calr}{{\cal R}}
\newcommand{\mathbold}{\bf}
\newcommand{\cinf}{C^{\infty}}
\newcommand{\row}[2]{#1_1,\dots ,#1_{#2}}
\newcommand{\dbyd}[2]{{\partial #1\over\partial #2}}
\newcommand{\Space}{{\bf Space}}
\newcommand{\alg}{{\mathbold Alg}}
\newcommand{\notsubset}{\not \subset}
\newcommand{\notsupset}{\not \supset}
\newcommand{\pois}{{\mathbold Pois}}
\newcommand{\pitilde}{\tilde{\pi}}
\newcommand{\rta}{\rightarrow}
\newcommand{\Lrta}{\Longrightarrow}
\newcommand{\lrta}{\longrightarrow}
\newcommand{\llrta}{\longleftrightarrow}
\newcommand{\Llta}{\Longleftarrow}
\newcommand{\Llrta}{\Longleftrightarrow}
\newcommand{\lgl}{\langle}
\newcommand{\rgl}{\rangle}
\newcommand{\inj}{\hookrightarrow}
\newcommand{\surj}{\twoheadrightarrow}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\newcommand{\downmapsto}{\rotatebox[origin=c]{-90}{$\scriptstyle\mapsto$}\mkern2mu}
\renewcommand{\qedsymbol}{$\square$}
\bibliographystyle{plain}
\title{\bf Lecture Notes for Commutative Algebra}
\author{Lecture delivered by Paul Nelson\\
Notes by Lin-Da Xiao}
\date{2017 ETH} %\thanks{Research partially supported by NSF Grant DMS-96-25122 and the Miller Institute for Basic Research in Science.}
\begin{document}
\maketitle
\tableofcontents
\newpage

\section*{About the Notes:}
Professor Paul Nelson taught a course (401-3132-00L) on commutative algebra at ETH in Fall 2017. The lectures in first and second weeks were given by Paul Steinmann and Professor Kawalski respectively. These are my ``live-\TeX ed'' notes from the course. The {\LaTeX } package tikz and tikzcd were used to generated diagrams. 

Of course, these notes are not a faithful representation of the course, either in the mathematics itself or in the quotes, remarks; in particular the errors are my fault. By the same token, any virtues in the notes are to be credited to the lecturer and not the scribe.

If you find any typos or mistakes please send feedbacks to \href{mailto:xld704@gmail.com}{xld704@gmail.com}
\section*{About the Course}
The course website is \href{https://metaphor.ethz.ch/x/2017/hs/401-3132-00L/}{https://metaphor.ethz.ch/x/2017/hs/401-3132-00L/}. 

The topic includes
\begin{itemize}
\item 
Basics about rings, ideals and modules
\item 
Localization
\item 
Primary decomposition
\item 
Integral dependence and valuations
\item 
Noetherian rings
\item 
Basic dimension theory
\end{itemize}
Prerequisite:

Rings, homomorphism, ideals, quotient rings, zero divisors, prime/maximal ideals, fields.

Convention: 
Ring, we mean a commutative ring with identity. $\text{Spec}(\calr)$ is the prime spectrum of a ring $\calr$ and $Spm(\calr)$ is the maximal spectrum.

In particular for a ring homomorphism $f:R\rightarrow S$. We have $f(1_R)=1_S$.
 
Remark:
we allow 1=0 but then R=0.
Caution, by definition $1\neq 0$ in a field .
\section{Rings, Ideals, Radicals}
\subsection{Lecture 1. Motivation and Basics by Paul Steinmann}
In differential geometry, we have the theorem of level sets:
\begin{thm}
Let $f:\reals^n \rightarrow \reals$.
If $0 \in \reals^n$ is a regular value of $f$ then $f^{-1}(0)$ is a submanifold.
\end{thm} 
 
In algebraic geometry, we look at $f^{-1}(0)$ for polynomial $f$.
More precisely, fix an algebraically closed field $K$ and an integer $n>0$, consider the ring $R:=K[X_1,...,X_n]$.
 
Define: For a subset $S\subset R$ we define the \textbf{affine algebraic variety} by
\begin{equation}
V(S):=\{x\in K^n| \forall f \in S,\ f(x)=0\subset K^n\}
\end{equation}
\begin{rmk}
With the affine algebraic varieties defined above, we have:
\begin{itemize}
\item $V(\emptyset)=K^n$
\item $ V(\{1\})=\emptyset$
\item   For an non empty collection of subsets $(S_i)_{i\in I}$, $S_i\subset R$ we have 
\begin{equation*}
    \cap_{i\in I}V(S_i)=V(\cup_{i\in I} S_i)
\end{equation*}
\item $S$ and $S'$ are subsets in $R$
\begin{equation*}
    V(S)\cup V(S')=V(\{fg| f\in S, g\in S'\})
\end{equation*}
$V(S)\cup V(S')\subseteq V(S\cdot S')$ is trivially true. For the converse inclusion, consider $x\in V(S\cdot S')$, assume $x\notin V(S')$, then $\exists g\in S'$ s.t. $g(x)\neq 0$ but $f(x)g(x)=0,\forall f\in S$: because $K[X_1,..,X_n]$ is an integral domain, we know $f(x)=0\forall f\in S\Lrta x\in V(S)$.
\end{itemize}
as a consequence, 
    $(V(S))_{S\subset R}$ form the closed sets of a topology on $K^n$ called \textbf{Zariski topology}.
\end{rmk}
Every closed set in Zariski topology is a closed set in ordinary topology but Zariski topology is coarser because for example $Y-\exp(X)\notin K[X,Y]$.
\begin{ex}
n=2 , $R=K[X_1,X_2]$

 $V(\{X_1\})$ is the $X_2$ axis in $K^2$

 $V(\{X_2-X_1^2\})$ is the parabola in $K^2$
\end{ex}

\begin{dfn}
Conversely for all subset $X \subset K^n$, consider 
          $$ I(X):=\{f\in R | \forall x\in X: f(x)=0\}\subset R.$$
\end{dfn}
\begin{rmk}
Fact: For $S$ in $R$ and $X$ subset in $K^n$, we have, 
\begin{itemize}
\item
 $S\subset I(V(S))$
\item
 $X \subset V(I(X))$
\item
 For $S\subset S' \subset$ in $R$, we have $V(S)\supset V(S')$
\item
 For $X \subset X'\subset K^n$, we have $ I(X')\supset I(X)$
\item
 $I(X) \subset R$ is  an ideal.
\end{itemize}
\end{rmk}

\begin{dfn}
The \textbf{radical of an ideal}   $\sca\subseteq \cala$ is 
 $\text{rad}(\sca):=\{a\in R| \exists n\geq1\  s.t.\  a^n \in \sca\} \subseteq \cala$.
An ideal $\sca \subseteq \cala$ with $\text{rad}(\sca)=\sca$ is  called \textbf{radical}.
\end{dfn}

\begin{rmk}
Fact, 
for every ideal $\sca \subseteq \cala$ we have  $\sca\subset \text{rad}(\sca)$.

 $\text{rad}(\sca)$ is an ideal, proof trivial.

For $X\subset K^n$ the ideal $I(X)$ is radical. 
$f^n\in I(X)\Lrta K\ni f^n(x)=0\forall x\in X$. Because $K$ is an integral domain, we know $f(x)=0\forall x\in X\Lrta f\in V(X)$, $\text{rad}(I(X))\subseteq I(X)$, then $I(X)$ is radical ideal.
\end{rmk}

\begin{thm}
(The Hilbert's Nullstellensatz)
For any ideal $\sca \subset R $ we have
$$I(V(\sca))=\text{rad}(\sca).$$
\end{thm}

An important consequence of the theorem:

the maps $V$ and $I$ induce the one to one correspondence between
$$
\{\text{radical ideals in the polynomial ring}\}\Longleftrightarrow                   \{\text{affine algebraic varieties}\}
$$
and this correspondence invert the inclusion.

\begin{ex}
For any point $x=(x_1,...,x_n) \in K^n$ the ideal 
$$
I({x})=\scm_x:=(X_1-x_1,...,X_n-x_n)
$$
is maximal.
\begin{proof}

 If not, then there exists an ideal $\sca \subset R$
s.t. 
\begin{equation*}
R\supsetneq \sca \supsetneq \scm_x,
\end{equation*}
but then by the Nullstellensatz,

\begin{equation*}
\emptyset\subsetneq V(\sca) \subsetneq V(\scm_x)=\{x\},
\end{equation*}
which makes the contradiction.
\end{proof}
\end{ex}

Weak Nullstellensatz says the ideals $\scm_x$ is are precisely the maximal ideals of $K[x_1,...,x_n]$, where $K$ needs to be algebraically closed.
\begin{ex}
$K=\reals, n=1$.
$X^2+1$ is irreducible in $\reals[X]$.
And $\reals[X]/(X^2+1) \cong \cplx$ is maximal.
Consequently, we have a bijection
$$
\{\text{maximal ideals of $R:=$ polynomial ring }K[X_1,...,X_n]\}
\Longleftrightarrow\{\text{Points in } K^n\}
$$
\end{ex}

Let $A$ be a ring.
Remember 

    An element $a\in \cala$ is \textbf{nilpotent} if there $\exists n>1\in \intg$ s.t. $a^n=0$.

    An element $a\in \cala$ is a \textbf{zero divisor} if there is an element $b\in \cala, b\neq 0$ s.t. $ab=0$.

Fact: every nilpotent element is a zero-divisor  but not conversely.

\begin{ex}
     take $(0,1)\in \cala\times \cala$ then $(0,1)\cdot(1,0) =(0,0)$
\end{ex}

\begin{dfn}
 The ideal $\text{Nil}(\cala):=\text{rad}((0))$ is called  the \textbf{nil radical} of $\cala$.
\end{dfn}

Then we have:
\begin{enumerate}[label=(\roman*)]
\item $\text{Nil}(\cala)$ is the set of all nilpotent elements  of $\cala$
\item $\cala/\text{Nil}(\cala)$ has no nilpotent elements.
\end{enumerate}
\begin{proof}
$(i)$. From definitions.

$(ii)$. Let $x\in \cala$ s.t. $\bar{x}\in \cala/\text{Nil}(\cala)$ is nilpotent.
 Let $n>0$ s.t. $\bar{x}^n=0$ then $x^n \in \text{Nil}(\cala)$
Thus there exists $k>0$ s.t. $(x^n)^k=0$ hence $x^{nk}=0$
, $x\in \text{Nil}(\cala)$.
\end{proof}

\begin{prop}
The nil radical of $\cala$ is the intersection of all prime ideals of $\cala$.
\end{prop}
\begin{proof}
Denote by $\caln'$ the intersection of all prime ideals of $\cala$.
For any nilpotent element $f\in \cala$ with $n>0$ s.t. $f^n=0$,
We have $f^n\in \scp$ for every prime ideal $\scp$. Hence $f\in \scp\Lrta$ conclude $f\in \caln'$.

Conversely, suppose $f\in \cala$ is not nilpotent 
Define $\Sigma:=\{ \sca \subset A\text{ ideals} | \forall n>0: f^n\notin \sca\}$.
We will apply Zorn's lemma. 
We have 

    1.  $(0)\in \Sigma$, so $\Sigma$ is nonempty,

    2.  $\Sigma$ is partially ordered by inclusion.

    3.  For any chain $(\sca_i)_{i\in I}\subset \Sigma$, the set $\sca :=\cup_{i\in I}\sca_i$ is an ideal and 

    for all $n>0$, 
    we have $f^n \notin \sca$, hence $\sca \in \Sigma$.
By Zorn's lemma we conclude that there is a maximal element $\scp\in \Sigma$.

We show that $\scp$ is a prime ideal.
For any $x,y \notin \scp$, consider the ideals
$\scp+(x), \scp+(y)$. They strictly contain $\scp$ and are thus not in $\Sigma$.
Let $n,m>0$ s.t. $f^n\in \scp+(x), f^m\in \scp+(y)$.
We conclude that $f^{n+m}\in \scp+(xy)$, so $\scp+(xy) \notin \Sigma$.
Hence $xy \notin \scp$, which means, $\scp $ is a prime ideal so $f \notin \caln'$.
\end{proof}

Remember let $f:\cala \rightarrow \calb$ be a ring morphism. And $\scp\subset \calb$ a prime ideal. 
Then $f^{-1}(\scp)$ is  a prime ideal of $\cala$.
Caution: Not true for maximal ideals in general. 
 
\begin{prop}
Let $\sca\subset \cala$ be an ideal, $\pi : \cala\rightarrow \cala/\sca$
There is a one to one correspondence between ideals of $\cala/\sca$ and ideals in $\cala$ which contain
$\sca$ via $\scc=\pi^{-1}(\scb)$
\end{prop}

\begin{cor}
Let $\sca\subset  \cala $ be an ideal, then $\text{rad}(\sca)$ is the intersection of all prime ideals which contain $\sca$.
\end{cor}
\begin{proof}
consider the homomorphism $\pi :\cala\rightarrow \cala/\sca$
Then $\text{rad}(\sca)=\pi^{-1}(\caln_{\cala/\sca})$.
By the above proposition $\caln_{\cala/\sca}$ is the intersection of all prime ideals of $\cala/\sca$.
 By the correspondence we conclude the statement.
\end{proof}
\begin{dfn}
 The \textbf{Jacobson Radical} $\text{Jac}(\cala)$ of $\cala$ is the intersection of all maximal ideals in $\cala$.
\end{dfn}
\begin{prop}\label{prop:criterion_jacobson_radical}
We have 
$x\in \text{Jac}(\cala)\Longleftrightarrow \forall y \in \cala: 1-xy $ is a unit.
\end{prop}
\begin{proof}
``$\Longrightarrow$'' let $x\in \text{Jac}(\cala)$ and $y\in \cala$ s.t. $1-xy$ is not a unit. Then $1-xy\in \scm$ for some maximal ideal 
$\scm \subset \cala$. But $x\in \text{Jac}(\cala)\subset \scm,$ hence $1\in \scm$  contradiction.

``$\Longleftarrow$'' let $x  \notin \text{Jac}(\cala)$ then $x \notin \scm$ for some maximal ideal $\scm\subset \cala$.
Since $\scm$ is maximal we conclude that $(x)+\scm=A$. Hence there exists $y\in A,\   u\in \scm$ s.t. $xy+u=1$.
We conclude that $1-xy \in \scm $, so in particular , $1-xy$ is not a unit.
 \end{proof}
In particular, $x\in\text{Jac}(\cala)\Lrta$ $x$ not  a unit. $\text{Jac}(\cala)\subseteq \{\text{ non-units in $\cala$}\}$. $\cala-\text{Jac}(\cala)\supseteq\cala^{\times}$
\subsection{Lecture 2. Local Rings, Coprime Ideals, Ideal Quotients by Paul Steinmann}
\begin{dfn}
A ring $\cala$ is called a \textbf{local ring} if $\cala$  admits precisely one maximal ideal;
\end{dfn}

\begin{ex}
\ 
\begin{itemize}
\item
Every field is a local ring with maximal ideal $\scm=0$, because every nonzero element is a unit.
\item
$K[[X]]$ is the ring of formal power series over a field $K$, it has a unique maximal ideal $(X)$. One can check that every element with nonzero constant term is invertible. i.e. $(a_0(1-g))^{-1}=a_0^{-1}(1+g+g^2+...)$
\end{itemize}
\end{ex}
 
\begin{prop}\label{prop:local_ring_maximal}\ 
\begin{itemize}
\item 
Let $\cala$ be a ring and $\scm\neq (1)$ is an ideal of $A$ s.t. every $x\in \cala-\scm$  is a unit of $A$, then $\cala$ is a local ring with  maximal ideal $\scm$.
\item
Let $\cala$ be ring and $\scm\subset \cala$ is a maximal ideal s.t. any element of $1+\scm=\{1+a|a\in \scm \}$ is a unit in $\cala$. Then $\cala$ is a local ring with maximal ideal $\scm$.
\end{itemize}
\end{prop}

\begin{proof}
For first part, every proper ideal consists of non-units, hence is contained in $\scm$. In other words, an element is a unit iff it is not contained in any maximal ideal.

For the second part, let $x\in \cala-\scm$. Since $\scm$ is maximal , we have $(x)+\scm=(1)$ , hence , $\exists y\in \cala, t\in \scm$, s.t. $xy+t=1$, which implies $xy=1-t\in 1+\scm.$ Thus $xy$ is a unit which implies that $x$ is a unit. Now use the first part.
\end{proof}

\begin{dfn}
A ring $\cala$ is called \textbf{semilocal} if $\cala$ admits finitely many  maximal ideals.
\end{dfn}

\begin{ex}\ 
\begin{itemize}
\item 
$\intg$ is not semilocal.
\item
Let $m\in \intg$. Then $\intg/(m\intg)$ is a semilocal ring with maximal ideals $ d\intg/m\intg$ for prime number $d|m$.
\item In particular, for $p\in \intg$ prime , $\intg/p \intg$ is local ring.
\end{itemize}
\end{ex}

Reminder: Let $\sca,\scb \subset \cala$ be ideals their sum is 
$$
\sca+\scb:=\{a+b|a\in \sca, b\in \scb\},
$$
which is the smallest ideal containing $\sca\cup\scb$.
Also infinite sums $(\sca_i)_{i\in I}\subset \cala$ ideals,
$$
\sum_{i\in I }\sca_i :=\left.\left\{\sum_{i\in I}x_i \right| x_i\in \sca_i,  x_i =0 \text{ for almost all i}\right\}
$$
And we also have
$$
\sca\cdot \scb\ or\ \sca\scb=\left.\left\{\sum_{i\in I}x_i y_i\right|x_i \in \sca , y_i\in \scb, \text{all but finitely many terms are }0\right\}.
$$
\begin{dfn}
Two ideals $\sca, \scb\subset A$ are called \textbf{coprime}\footnote{In some literature, it is called \textbf{comaximal}} if $\sca+\scb=(1)$ 
\end{dfn}
\begin{rmk}
If $\sca,\scb\subset A$ are coprime ideals then $\sca\cap \scb =\sca\cdot \scb$.\\
For general ideals $\sca,\scb\subset A$ :
$$
(\sca+\scb)\cdot(\sca\cap \scb)\subset \sca\cdot \scb\subset \sca\cap \scb.
$$
However, for coprime ideals, we also have $\sca\scb \supset \sca\cap\scb$, because $1=a+b$ for $a\in\sca, b\in \scb$, then
$\forall x\in \sca\cap\scb$ we have $x=x\cdot 1=x(a+b)=xa+xb\in \sca\cdot \scb$.
\end{rmk}

\begin{prop}\label{thm:Chinese_remainder}(Chinese Remainder Theorem)
Let $\sca_1,...,\sca_n \subset \cala$ be ideals, denote $\varphi: \cala\rightarrow \prod_{i\in I}^n(\cala/\sca_{i})$ for the canonical homomorphism.\\
(i) if $\sca_i,\sca_j$ are coprime for $i\neq j$ , then $\prod_{i=1}^n\sca_i=\cap_{i=1}^n\sca_i$.\\
(ii)$\varphi$ is surjective iff $\sca_i,\sca_j$ are coprime for $i\neq  j$.\\
(iii) $\varphi$ is injective iff $\cap_{i=1}^n\sca_i=(0)$.
\end{prop}

\begin{proof}
(iii) Note that $ker \varphi =\cap^n_{i=1}\sca_i$. Then $$
\prod_{i=1}^n\left(\cala/\sca_i\right)=\cala/(\cap^n_i\sca_i)
$$
(i) by induction on $n$.
For $n=2$ it is checked above. Suppose $n>2$ let $\scb:=\prod_{i=1}^{n-1}\sca_i=\cap^{n-1}_{i=1}\sca_i$
Since $\sca_i+\sca_n=(1)$ for $1\leq i\leq n-1$. We have $x_i+y_i=1$ for some $x_i\in \sca_i, y_i\in \sca_n$
Thus $\prod_{i=1}^{n-1}x_i= \prod_{i=1}^{n-1}(1-y_i) \equiv 1 \mod \sca_n$
We conclude that $\sca_n+\scb=(1)$, s.t. 
$$
\prod^n_{i=1}\sca_i=\scb \sca_n=\scb\cap \sca_n=\cap_{i=1}^n\sca_i
$$
(ii) ``$\Longrightarrow$'', Suppose $\varphi $ is surjective. Let $i\neq j$, There exists an element $x\in A$ s.t. $\varphi(x)=(0,...,0,1,0,...,0)$, nonzero only at the $i$-th entry.
Thus $x\equiv  1 \mod \sca_i$ and $x\equiv 0\mod \sca_j$.
So $1=(1-x)+x\in \sca_i+\sca_j$.\\
``$\Longleftarrow$'' We show that for all $k\in \{1,...,n\}$
 there exists  an element $x\in A$ s.t. $\varphi(x)=(0,..0,1,0..0)$, nonzero at the $k$-th entry.
Let $k\in \{1,...,n\}$. For every $j\in \{1,...,n\}\backslash\{k\}$.
We have $\sca_k+\sca_j=(1)$, and thus there are elements $u_j\in\sca_k,v_j\in \sca_j$
s.t. $u_j+v_j=1$.
Define $x:=\prod_{i\neq k}v_i$. Then $x\equiv 0 \mod \sca_j,\ \forall j\neq k$ and $x=\prod_{i\neq k}(1-u_i)\equiv 1\mod \sca_k$.
Hence, $\varphi(x)=(0,..,0,1,0,...,0)$ nonzero in the $k$-th entry.\\
As a result, if each pair $\sca_i,\sca_j$ is coprime, we have 
$$
\cala/\left(\prod_{i=1}^n\sca_i\right)\cong \prod_{i=1}^n\left(\cala/\sca_i\right).
$$
\end{proof}

 
\begin{prop}\label{prop:charaterization_coprime_ideals}
Let $\sca,\scb\subset  \cala$ be ideals s.t. $\text{rad}(\sca),\text{rad}(\scb)$ are coprime. Then $\sca, \scb$ are coprime.
\end{prop}
\begin{proof}
In fact, we have
$$
 \text{rad}(\sca+\scb)=\text{rad}(\text{rad}(\sca)+\text{rad}(\scb))=\text{rad}((1))=(1)
$$
Details in the exercise sheet.
\end{proof}

\begin{prop}\label{prop:prime_avoidance}(Prime avoidance)
\begin{enumerate}[label=(\roman*)]
\item Let $\scp_1,..., \scp_n\subset \cala$ prime ideals and let $\sca \subset \cala$ be an ideal which is contained in $\cup_{i=1}^n\scp_i$ then $\sca\subset \scp_j$  for some $j$.\\
\item Let $\sca_1,...,\sca_n\subset \cala$ be ideals and $\scp \subset \cala$ a prime ideal s.t. $\scp \supset \cap_{i=1}^n\sca_i$.
The following are equivalent:
\begin{enumerate}[label=(\alph*)]
\item
$\scp\supset \sca_i$ for some $i$,
\item $\scp\supseteq \cap_i\sca_i$,
\item $\scp\supseteq\prod_i\sca_i$,
\end{enumerate}
and if $\scp=\cap_{i=1}^n\sca_i$,  then $\scp =\sca_i $ for some $i$ .
\end{enumerate}
\end{prop} 
\begin{proof}
Induction on $n$. For $n=1$, easily checked. For $n > 1$. Assume that $\sca \notsubset \scp_i$ 
for all $1\leq i\leq n$. We show $\sca\notsubset \cup_{i=1}^n\scp_i$.
By induction hypothesis we know that $\forall k,\sca\notsubset \cup_{i\neq k}^n\scp_i $, so there exists $x_k\in \sca$ s.t. $x_k\notin \scp_i,\ \forall i\neq k$.We choose an $x_k$ for each $\scp_k$ in the above manner.
If $x_k\notin \scp_k$ for some $k$ , then we are done.
If not, then $x_k\in \scp_k$ for all $k$. 
Consider $y:=\sum_{k=1}^n\prod_{j\neq k}x_j$. We have $y\in \sca$ and $y \equiv \prod_{j\neq k}x_j \mod \scp_k,\forall k$.
Since $x_j\notin \scp_k$ for $j\neq k$ and $\scp_k$ is a prime ideal, we conclude that $y\notin \scp_k$ for all $k$ hence $\sca\notsubset \cup_{i=1}^n \scp_i$.\\
(ii) The $(a)\Lrta (b)\Lrta (c)$ is trivial. We only need to prove $(c)\Lrta (a)$.

Suppose for all $i\in \{1,...,n\}$ we have $\scp\notsupset \sca_i$. Then there 
are $x_i\in\sca_i $ with $x_i\notin \scp$ for all $i$. 
And thus $\prod_{i=1}^n x_i\in \prod_{i=1}^n\sca_i$. 
Since $\scp$ is a prime ideal $\prod_{i=1}^n x_i\notin \scp$, hence $\scp\notsupset \prod_{i=1}^n \sca_i$.

If $\scp=\cap_{i=1}^n\sca_i\subset \sca_k$ for all $k$, which produce the last part.
\end{proof}

\begin{dfn}
Let $\sca,\scb\subset A$ be two ideals. Their \textbf{ideal quotient} is 
$$
(\sca:\scb):=\{x\in \cala| x\scb \subset \sca\}.
$$ 
The \textbf{annihilator} of an ideal $\sca\subset A $ is 
$$
\text{Ann}(\sca):=\{(0):\sca\}.
$$
\end{dfn}
Notation: For $x\in A$ we write $(\sca:x):=(\sca:(x))$.\\
Fact: \\
(i)The ideal quotient of two ideals is again an ideal.\\
(ii)The set of zero-divisors  of $A$ is 
$$
D=\cup_{x\neq 0} \text{Ann}(x)=\cup_{x\neq 0}\text{rad}(\text{Ann}(x))
$$
\begin{proof}\ \\
(i) Check by definition.\\
(ii) The first equality is just by definition. The the second equality.
$$
D=\text{rad}(D)=\text{rad}(\cup_{x\neq 0}\text{Ann}(x))=\cup_{x\neq 0}\text{rad}(\text{Ann}(x)),
$$
 where in the second term, we extended $\text{rad}$ to arbitrary subsets.
\end{proof}
\begin{prop}
Properties: Let $\sca, \scb\subset A$ be ideals \\
(i)$\sca\subset (\sca:\scb)$\\
(ii) $(\sca:\scb)\scb\subset \sca$\\
(iii)$((\sca:\scb):\scc)=(\sca:\scb\cdot\scc)=((\sca:\scc):\scb)$\\
(iv) for ideals $(\sca_i)_{i\in I}\subset \cala$, $(\cap_{i\in I}\sca_i:\scb)=\cap_{i\in I}(\sca_i:\scb)$\\
(v) for ideals $(\scb_i)_{i\in I}\subset\cala$ , $(\sca:\sum_{i\in I }\scb_i)=\cap_{i\in I} (\sca:\scb_i)$.\\
\end{prop}
\begin{dfn}\label{def:extention_contraction}
Let $\sca\subset \cala$ be an ideal $f: \cala\rightarrow  \calb$ a ring homomorphism. We define the \textbf{extension} of $\sca$ by $f$ to be the ideal 
$$
\sca^e:=f_{*}(\sca):=\calb f(\sca),
$$
which is just the ideal in $\calb$ generated by $f(\sca)$.\\
For an ideal $\scb\subset \calb$. We define the \textbf{contraction} of $\scb$ via $f$ to be the ideal 
$$
\scb^c:=f^*(\scb):=f^{-1}(\scb).
$$
\end{dfn}
{\color{red} By definition, the extension and contraction always preserves inclusion $\subset$, but it does not necessarily preserve the proper inclusion $\subsetneq$}
\begin{prop}\label{prop:properties_extension_contractino}
Properties: Let $f: \cala\rightarrow \calb$ be a ring homomorphism , $\sca\subset \cala$ $\scb\subset \calb$ ideals. Then :\\
(i) $\sca\subset f^*f_*(\sca)=\sca^{e c}$,$\scb\supset f_{*}f^*(\scb)=\scb^{ce}$.\\
(ii) $f^*(\scb)=f^* f_*f^*(\scb), f_*(\sca)=f_* f^*f_*(\sca)$.\\
(iii) Denote by $C$ the set of contracted ideals in $A$ and by $E$ the set of extended ideals in $B$, then 
$$
C=\{\sca\subset A|f^*f_*(\sca)=\sca\},
$$
 
$$
E=\{\scb\subset B| f_* f^*(\scb)=\scb\}.
$$ 
And $f_*: C\rightarrow E$ is a bijection with inverse $f^*$.
\end{prop}
\begin{proof}\ \\
 (i). $\sca\subset f^{-1}f(\sca)\subset f^{-1}f_{*}(\sca)=f^{*}f_*(\sca)$.\\
$\scb \supset f(f^{-1}(\scb))$ and $\scb$ is an ideal so $\scb \supset f_{*}f^*(\scb)$. 
(ii). By (i) $\sca\subseteq\sca^{ec}\Lrta \sca^{e}\subseteq \sca^{ece}$, and $\sca^{e}\supseteq(\sca^{e})^{ce}$, we know $\sca^{e}=\sca^{ece}$, and another is proved similarly.\\
(iii). trivial application of $(ii)$.
\end{proof}
\begin{prop}\label{prop:properties_contraction_extension}
$$
\begin{aligned}
&(\sca_1+\sca_2)^e=\sca^e_1+\sca_2^e & (\scb_1+\scb_2)^c\supseteq \scb^c_1+\scb_2^c\\
& (\sca_1\cap\sca_2)^e\subseteq\sca_1^e\cap\sca_2^e & (\scb_1\cap\scb_2)^c=\scb_1^c\cap\scb_2^c\\
& (\sca_1\sca_2)^e=\sca_1^e\sca_2^e & (\scb_1\scb_2)^c\supseteq\scb_1^c\scb_2^c\\
&(\sca_1:\sca_2)^e\subseteq(\sca_1^e:\sca_2^e)& (\scb_1:\scb_2)^c\subseteq (\scb_1^c:\scb_2^c)\\
&\text{rad}(\sca)^e\subseteq\text{rad}(\sca^e) & \text{rad}(\scb)^c=\text{rad}(\scb^c)
\end{aligned}
$$
Assume $\scp\subseteq\cala$ and $\scq\subseteq\calb$ are prime ideals, then $\scq^c$ is prime ideal but $\scp^e=\varphi_*(\scp)$ is not necessarily prime, for  trivial case, $\varphi=0\Lrta \varphi_*(\scp)=0$ which is not necessarily prime. 
\end{prop}
\section{Modules}
\subsection{Lecture 3. Modules, Exact Sequences by Professor Kowalski}
Outline of this chapter 
\begin{itemize}
\item Definition, examples, and Nakayama's Lemma
\item Exact sequences , snake lemma
\item Tensor products
\item Algebra over a ring
\end{itemize}
Roughly speaking, module is ``vector spaces for rings''. It is closely related to fibre bundles in geometry. For the convention, we still fix commutative ring $\cala$ with unit.
\begin{dfn}
A \textbf{module} $M$ over $\cala$ is an Abelian group with a linear action of $\cala$ on $M$, i.e.
$$
\begin{aligned}
& \cala\times M\rightarrow M\\
& (a,x)\mapsto ax
\end{aligned}
$$
so that 
$$
\begin{aligned}
&a(x+y)=ax+ay\\
&(a+b)x=ax+bx\\
&a(bx)=ab x\\
& 1 x= x
\end{aligned}
$$
\end{dfn}

\begin{ex}\ 
\begin{enumerate}
\item $\{0\}$ is an $\cala$-module
\item if $\cala$ is a field $\cala$-module is just $\cala$-vector space.
\item $I\subset\cala$ ideal; then $I$is an $\cala$-module (a submodule of $\cala$)
\item $\cala=\intg$, an $\cala$-module is an abelian group.
\end{enumerate}
\end{ex}

\begin{dfn}
$M$ and $N$ are $\cala$-modules $f:M\rightarrow N$ is  \textbf{$\cala$-linear} if $f(ax+by)=af(x)+bf(y)$. The set of such $\rho:M\rightarrow N$ is denoted $Hom_{\cala}(M,N)$. It is an $\cala$-module with
$$
(f+g)(x)=f(x)+g(x),
$$
$$
(af)(x)=af(x).
$$
\end{dfn}
If
$Q\overset{h}{\lrta }M\overset{f}{\lrta} N\overset{g}{\lrta} P$, then $g\circ f\in Hom_\cala(M,P)$ and $g\circ(f\circ h)=(g\circ f)\circ h$. Also, $id_M\in Hom_\cala(M,M)$. In other word, $\cala$-module is a category.

\begin{dfn}
$f:M\rta N$ is an \textbf{isomorphism} iff $\exists g:N\lrta M$ s.t. $g\circ f=id_N$ and $f\circ g=id_M$.
\end{dfn}
\begin{rmk}
$Q\overset{h}{\rta} M\overset{f}{\rta} N\overset{g}{\rta} P$, then for any $P$, we get
 $$
 f^*: Hom_\cala(N,P)\rta Hom_\cala(M,P)
 $$
 $$
g\mapsto g\circ f
 $$
 and 
 $$
 f_*: Hom_\cala(Q,M)\rta Hom_\cala(Q,N)
 $$
 $$
h\mapsto  f\circ h
 $$
They are $\cala$-linear, because for example
$$
\begin{aligned}
(f^*(a h+b g))(x)&=((a h+b g)\circ f) (x)\\
&= (a h+b g) (f(x))\\
&=a h(f(x))+bg(f(x))\\
&= (a f^*(h)+b f^* (g))(x).
\end{aligned}
$$
\end{rmk}

\begin{rmk}
Suppose $M$ is an $\cala$-module and $N\subset M$ as submodule, then $M/N$ has the structure of $\cala$-module such that the canonical projection $\pi: M\rta M/N$ is $\cala$-linear. $a(x+N)=ax+N$ is well defined because $a N\subset N$.
\end{rmk}
\begin{dfn}$f: M\lrta N$ is a morphism of $\cala$-modules.\\
\begin{itemize}
\item 
$
\text{Ker}(f):=f^{-1}(\{0\})\subset M
$ 
is a submodule of $M$.
\item 
$
\text{Im}(f):= f(M)\subset N
$ is a submodule of $N$.
\item 
Coker(f):=N/\text{Im}(f) is an $\cala$-module.
\end{itemize}
\end{dfn}
\begin{rmk}\label{rmk:iso} 
\begin{enumerate}[label=(\roman*)] 
\item $ker(f)={0}\Longleftrightarrow f$ is injective.
\item $coker(f)={0}\Longleftrightarrow f$ is surjective.
\item if $f:M\rta N$ and $M'\subset ker(f)$, then we get an induced linear map $\bar{f}$, s.t the diagram 
\[
\begin{tikzcd}
M \arrow[r,"f"] \arrow[d,"\pi"]  & N  \\
   M/M' \arrow[ur,"\bar{f}"] & 
\end{tikzcd}
\]
commutes. It is properly defined by $\bar{f}(x+M')=f(x)$ since $f(M')=\{0\}$. Then we have
$$
\text{Im}(\bar{f})=\text{Im}(f),
$$
and 
$$
\text{Ker}(\bar{f})=\text{Ker}(f)/M'.
$$
In particular, if $M'= \text{Ker}(f)$, we get an isomorphism 
$$
M/\text{Ker}(f)\overset{\bar{f}}{\cong}\text{Im}(f).
$$
\end{enumerate}
\end{rmk}

If $M$ is an $\cala$-module and $(M_i)_{i\in I} $ a family of submodules then $\cap_{i\in I} M_i$ is a submodule.
If $X\subset M$ be a  subset then the intersection of all submodules  containing $X$ is a submodule containing $X$, called the  submodule generated by $X$, denote it by $\lgl X\rgl$.
One checks that 
$$
\begin{aligned}
\lgl X\rgl&=\left\{\text{linear combination of elements of } X\right\}\\
&=\left.\left\{\sum^K_i a_i x_i\right|0\leq K\in \intg, a_i\in\cala, x_i\in X(\text{equivalently almost all $a_i$ are zero})\right\}
\end{aligned}
$$
We write 
$$
\sum_{i\in I} M_i=\lgl \cup_{i\in I} M_i\rgl
$$
\begin{dfn}
If $M$ satisfies $M=\lgl X\rgl$ with $X$ finite, then $M$ is called \textbf{finitely generated}.
\end{dfn}
Warning: A submodule of a finitely generated module is not necessarily finitely generated.
\begin{ex}
$$
\cala=\cplx[X_1,...,X_n,...].
$$
$\cala$ is finitely generated $\cala$-module by $1$ however, the ideal 
$
I=(X_1,..,X_n,...)$ is not a finitely generated $\cala$-module.
\end{ex}

\begin{lemma}\ 
\begin{enumerate}[label=(\roman*)]
    \item $L\supset M\supset N$ are $\cala$-modules, then there is an isomorphism 
    $$
        (L/N)/(M/N)\cong L/M
    $$

    $$
    (x+N)+M/N\mapsto x+M
    $$
    Rigorously:
    $\pi: L\lrta L/M$ is surjective\\
    $\Lrta \bar{\pi} :L/N\rta L/M$ is surjective\\
    and $\text{Ker}(\bar{\pi})=M/N$ so
     $$
     (L/N)/(M/N)\cong \text{Im}(\bar{\pi}),
     $$
     by Remark~\ref{rmk:iso}.
    \item $(M_1+M_2)/M_2\cong M_1/(M_1\cap M_2)$.\\
    The composite morphism:
    $$ 
    M_1\lrta M_1+M_2\lrta (M_1+M_2)/M_2
    $$ 
    $$
    m_1\longmapsto m_1+0\longmapsto m_1+0+ M_2
    $$
    is surjective, and the kernel is $M_1\cap M_2$.  
\end{enumerate}
\end{lemma}
\begin{dfn}Let 
$I\subset \cala$ be an ideal and $M$ be a module. We define $I M:=\lgl \{ax|a\in I,x\in M\}\rgl\subset M$ as a submodule of $M$.
\end{dfn}
\begin{prop}
$M/IM$ is naturally an $\cala/I$-module.
\end{prop}
\begin{proof} 
An element of $M/IM$ is of the form $m+ IM$ and suppose $a+I =a'+I$ $\Lrta $ $ a(m+ IM)= am+ IM=(a'+ b)(m+IM)=a'(m+ IM)+ bm+ IM=a'm+IM$.
\end{proof}
\begin{dfn}
$(M_i)_{i \in I}$ is a family of $\cala$-modules, $I$ is a possibly infinite index set.
\begin{enumerate}[label=(\roman*)]
\item $\prod_{i\in I} M_i$ is an $\cala$-module with $a(x_i)=(a x_i)$.
\item $\oplus_{i\in I} M_i\subset \prod_{i\in I} M_i$ is the submodule of $(x_i)_{i\in I}$ s.t. $x_i=0$ for all but finitely many $i\in I$. 
\end{enumerate}
\textbf{Cartesian product} and \textbf{direct product} are the same when there only finitely many summand. If $M_i=M,\forall i\in I$,we denote $M^{(I)}:=\oplus_i M_i$. When $I$ is finite, we denote it by $M^I$.
\end{dfn}

\begin{dfn}
An $\cala$-module $M$ is called \textbf{free} if there exists a set $I$ s.t. $M$ is isomorphic to $\cala^{(I)}$.
\end{dfn}
\begin{ex}\ 
\begin{enumerate}
\item if $\cala$ is a field, then every $\cala$-module is free.
\item $\cala=\intg$ : $\intg/2\intg$ is not free.
\item \textbf{Warning!} A submodule of a free module is not necessarily free.(e.g. each proper ideals in $\cala$ can't be a free $\cala$-module)
\item If $\cala\neq \{0\}$, $n,m\geq 0$ are integer and $\cala^n\cong \cala^m$ then $n=m$.
$I\subset \cala$ maximal ideal, $I\cala^n\cong I\cala^m$ as $\cala$-modules. Taking the quotients, then we get an isomorphism of $\cala/I$-vector spaces,
$$
(\cala/I)^n\cong(\cala/I)^m\Lrta n=m.
$$
This is called the \textbf{invariant basis number property}, all nontrivial commutative ring has the property. 
\end{enumerate}
\end{ex}

\begin{prop}\label{lem:Nakayama}
(Nakayama's lemma)\\
$M$ finitely generated $\cala$-module, $I\subset \text{Jac}(\cala) \text{  the Jacobson radical of $\cala$}$, which is the intersection of all maximal ideals in $\cala$.
If $IM=M$, then $M=\{0\}$. e.g. 
$\cala$ being a local ring and $I=\scm$ the only maximal in $\cala$.
\end{prop}

\begin{proof}
Suppose $M\neq \{0\}$, and let $\{x_1,...,x_n\}$ be a generating set with $n\geq1$ minimal.
Since $IM=M$, we have $x_n\in IM$, so
$$
x_n=\sum_{i=1}^k
a_i y_i, y_i\in M, a_i\in I
$$
where $y_i=\sum_j b_{ij }x_j$.
Then we have 
$$
x_n=\sum_{j=1}^n c_j x_j
$$
$$
c_j=\sum_i^k a_i b_{ij}\in I
$$
$$
\Lrta (1-c_n)x_n=\sum_{j=1}^{n-1}c_j x_j
$$ 
and
$(1-c_n)\equiv 1\mod I$ $\Lrta$ $c_n\in$ the Jacobson radical, then  $1-c_n$ is invertible by Proposition~\ref{prop:criterion_jacobson_radical}.
$$
x_n=(1-c_n)^{-1}\sum_{j=1}^{n-1}c_j x_j,
$$ 
which contradict the minimality of the generating set.
\end{proof}

\begin{cor}\label{cor:Nakayama1}
$M$ finitely generated $\cala$-module, $I \subset \text{Jac}(\cala), N\subset M$. If $M=IM +N$, then $M=N$.
\end{cor}
\begin{proof}
$I(M/N)=IM/IN=IM/(IM\cap N)=(IM+N)/N=(M/N)$, then by Nakayama's lemma we know 
$$
M/N={0}.
$$
\end{proof}

\begin{cor}\label{cor:Nakayama}
$\cala$ local ring, $\scm\subset \cala$ the maximal ideal. $M$ finitely generated. Then if $(x_1,...,x_n)\in M$ are such that their classes modulo $\scm$ form a basis of $M/\scm M$ as $\cala/\scm$-vector space, then they generate $M$.
\end{cor}

\begin{proof}
$N=\lgl x_1,...,x_n\rgl$ and apply Nakayama's lemma. Specifically, consider the composite map $N\inj M\lrta M/\scm M$ is surjective, then we have $N+\scm M=M$, then we can apply the Corollary~\ref{cor:Nakayama1}.
\end{proof}
\subsection{Lecture 4. Snake Lemma, Tensor Product by Professor Kowalski}
\section*{Exact sequences}
\begin{dfn}\ \\
(1)$M'\overset{f}{\rta} M\overset{g}{\rta} M''$ is \textbf{exact} if $\text{Im}(f)=ker(g)$\\
(2) $M'\rta M\rta M''\rta...$ is \textbf{exact} if it is exact at each node.
\end{dfn}

\begin{ex}\ 
\begin{enumerate}
\item $0\lrta M\overset{g}{\lrta} M''$ is exact, is equivalent to say that $g$ is injective
\item $M'\overset{f}{\lrta}M\lrta 0$ is exact, it is equivalent to say that $f$ is surjective.
\item ``Short exact sequence'' $0\lrta M'\overset{f}{\lrta}M\overset{g}{\lrta}M'' \lrta0$ For instance, 
$$
\begin{array}{ c c c c c c c c c}
0 & \longrightarrow  & M' & \overset{f}{\longrightarrow } & M'\oplus M'' & \overset{g}{\longrightarrow } & M'' & \longrightarrow  & 0\\
 &  & x &\longmapsto  & (x,0) &  &  &  & \\
 &  &  &  & (x,y) & \longmapsto & y &  &
\end{array}
$$
 the splitting sequence is exact. In fact short exact sequence of free modules always splits.
 \item $\cala=\intg$, for non-free modules, for example
 $$
\begin{array}{ c c c c c c c c c}
0 & \longrightarrow  & \intg/2\intg & \longrightarrow  & \intg/4\intg & \longrightarrow  & \intg/2\intg & \longrightarrow  & 0\\
 &  & x &\longmapsto  & 2x &  &  &  & \\
 &  &  &  & x & \longmapsto & x\  mod\ 2 &  &
\end{array}
$$
the exact sequence does not split.
\end{enumerate}
\end{ex}

\begin{prop}(Snake Lemma)
Suppose we have such a commutative diagram, each row is exact, 
\[
\begin{tikzcd}
0\arrow[r]  & M'  \arrow[r]\arrow[d,"f'"] & M\arrow[r] \arrow[d,"f"] & M''\arrow[r] \arrow[d,"f''"] & 0 \\
0\arrow[r]  & N'  \arrow[r] & N\arrow[r] & N''\arrow[r]  & 0 
\end{tikzcd}
\]
then we have a map $\delta: \text{Ker}(f'')\lrta Coker(f')$ s.t.  
$$
0\lrta \text{Ker}(f')\lrta \text{Ker}(f)\rta \text{Ker}(f'')\overset{\delta}{\lrta}Coker(f')\lrta Coker(f)\lrta Coker(f'')\lrta 0 
$$
is exact.
\end{prop}

\begin{proof}
Consider the kernels and cokernels with the induced map between them. For notational convenience, we write $\text{Ker}(f')$ as $K'$ and $Coker(f')$ as $C'$ and so on. We have the extended commutative diagram:
\[
\begin{tikzcd}
0\arrow[r]  
& K'  \arrow[r,"\hat{u}"]\arrow[d,"k'",hook] 
& K\arrow[r,"\hat{v}"] \arrow[d,"k",hook] \arrow[ddd,phantom,""{coordinate, name=Z}] 
& K'' \arrow[d,"k''",hook]  
& \\
0\arrow[r]  & M'  \arrow[r,"u"]\arrow[d,"f'"] & M\arrow[r,"v"] \arrow[d,"f"] & M''\arrow[r] \arrow[d,"f''"] & 0 \\
0\arrow[r]  & N'  \arrow[r,"u'"] \arrow[d,"q'",two heads]& N\arrow[r,"v'"] \arrow[d,"q",two heads]& N''\arrow[r]\arrow[d,"q''",two heads]  & 0 \\
  & C'  \arrow[r,"\bar{u}"] & C\arrow[r,"\bar{v}"] & C''\arrow[r]  & 0,
\end{tikzcd}
\]
where the maps $k',k,k''$ are inclusion of the kernels as submodules and $q',q,q''$ are canonical projections, hence each column become exact now. $\bar{u}, \bar{v}$ are the morphism induced on quotient modules while $\hat{u}, \hat{v}$ are restrictions of $u,v$ on submodules. One can check the induced maps on Cokernels are well defined, for example, for $\bar{v}$ to be well defined, because $q''\circ v'\circ f=q''\circ f''\circ v =0$, thus $\text{Im}(f)\subset \text{Ker}(q''\circ v')$. One can also check that the above diagram is commutative. For example $x\in K'$, we have $f(\hat{u}(x))=f(u(x))=u'(f'(x))=0\Lrta \hat{u}(x)\in K$, then we have $u\circ k'=k\circ \hat{u}$. 
\begin{enumerate}
\item Exactness at $K'$\\
We already know $\hat{u}=u|_{\text{Ker}(f')}$, $u$ injective implies that $\hat{u}$ is injective.
\item Exactness at $K$\\
We easily check that $\text{Im}(\hat{u})\subset \text{Ker}(\hat{v})$, because $k''\circ \hat{v}\circ \hat{u}=v\circ u\circ k'=0$, by the fact $k''$ is injective, we know $\hat{v}\circ\hat{u}=0$. For the converse inclusion, if $x\in \text{Ker}(\hat{v})=\text{Ker}(v)\cap \text{Ker}(f)$, then $x\in \text{Im}(u)\cap \text{Ker}(f)$. $\exists y\in M'$ s.t. $u(y)=x$ $\Lrta f(u(y))=0 \Lrta u'(f'(y))=0 $. Then because $u'$ is injective, $f'(y)=0\Lrta y\in K'\Lrta x=\hat{u}(y)$. Then we conclude $\text{Ker}(\hat{v})\subset \text{Im}(\hat{u})$, thus $\text{Ker}(\hat{v})= \text{Im}(\hat{u})$.
\item Exactness at $C''$\\
$q''\circ v'=\bar{v}\circ q$, $q'', v', q$ are all surjective, then we conclude that $\bar{v}$ has to be surjective.
\item Exactness at $C$\\
We easily verify that $\bar{v}\circ \bar{u}=0$, i.e. $\bar{v}\circ \bar{u}\circ q'=q''\circ v'\circ u'=0$ and $q'$ is surjective $\Lrta \bar{v}\circ \bar{u}=0$. For the converse inclusion, we choose $x+\text{Im}(f)\in \text{Ker}(\bar{v})$, where $x\in N$. $\bar{v}(x+\text{Im}(f))=0= q''\circ v'(x)$. $v'(x)\in \text{Ker}(q'')=\text{Im}(f'')$. $\exists y\in M'' $ s.t. $f''(y)=v'(x)$, On the other hand, $v$ is surjective ,$\Lrta \exists z\in M$ s.t. $v(z)=y$. Then, we have $f''(v(z))=v'(x)=v'(f(z))$. Then we choose $\tilde{x}=x-f(z)$, $\Lrta x+\text{Im}(f)=\tilde{x}+\text{Im}(f)$ \& $v'(\tilde{x})=0$. Then there exists $w\in N'$ s.t. $u'(w)=\tilde{x}$. Then, we check that $q\circ u'(w)=q(\tilde{x})=\tilde{x}+\text{Im}(f)$, thus $\bar{u}(q(w))=\tilde{x}+\text{Im}(f)\Lrta \bar{u}(w+\text{Im}(f'))=x+\text{Im}(f)$. Then we conclude $\text{Ker}(\bar{v})\subset \text{Im}(\bar{u})$.
\item Construct $\delta$\\
\[
\begin{tikzcd}
0\arrow[r]  
& K'  \arrow[r,"\hat{u}"]\arrow[d,"k'",hook] 
& K\arrow[r,"\hat{v}"] \arrow[d,"k",hook] \arrow[ddd,phantom,""{coordinate, name=Z}] 
& K'' \arrow[d,"k''",hook]
\arrow[phantom]{d}[red, xshift=-1.5 ex]{\substack{x\\[0.5\jot]\downmapsto\\[0.5\jot]x}}
\arrow[dlldd,
"\delta",blue,
rounded corners,
to path=
{ -- ([xshift=12ex]\tikztostart.east)
|- (Z) \tikztonodes
-| ([xshift=-12ex]\tikztotarget.west)
-- (\tikztotarget)}
] 
& 
\\
0\arrow[r]  
& M'  \arrow[r,"u"]\arrow[d,"f'"] 
& M\arrow[r,"v"] \arrow[d,"f"] \arrow[phantom]{r}[red, yshift=-1.5 ex]{\substack{\exists y\ \mapsto\ x}} \arrow[phantom]{d}[red, xshift=-2 ex]{\substack{y\\[0.5\jot]\downmapsto\\[0.5\jot] f(y)}}
& M''\arrow[r] \arrow[d,"f''"] 
& 0 
\\
0\arrow[r]  
& N'  \arrow[r,"u'"] \arrow[d,"q'",two heads] \arrow[phantom]{r}[red, yshift=-1.5 ex]{\substack{\exists z\ \mapsto\ f(y)}} \arrow[phantom]{d}[red, xshift=-2 ex]{\substack{z\\[0.5\jot]\downmapsto\\[0.5\jot] [z]}}
& N\arrow[r,"v'"] \arrow[d,"q",two heads]
& N''\arrow[r]\arrow[d,"q''",two heads]  
& 0 
\\
& C'  \arrow[r,"\bar{u}"] 
& C\arrow[r,"\bar{v}"] 
& C''\arrow[r]  
& 0,
\end{tikzcd}
\]
For an element $x\in K''$, $k''(x)=x\in M''$ and $f''(x)=0$. $\because v$ is surjective, $\therefore \exists y\in M $ s.t. $v(y)=x$. Then $f''(x)=f''(v(y))=v'(f(y))=0$ $\Lrta f(y)\in \text{Ker}(v')=\text{Im}(u')$. Therefore, there exists $z\in N'$ s.t. $u'(z)=f(y)$. The choice of $z$ is unique once we fix $y$, because $u'$ is injective. \textbf{We define $\delta:K''\lrta C', x\mapsto [z]=z+\text{Im}(f')$}. For $\delta$ to be well defined, it can not depend on the choice of $y$ and $z$. Choose another $\tilde{y}\in M$ and corresponding $\tilde{z}\in N'$ s.t. $v(\tilde{y})=x$ and $u'(\tilde{z})=f(\tilde{y})$. We have $v(\tilde{y}-y)=0$, $\exists w\in M'$ s.t. $u(w)=\tilde{y}-y$. Then $f(u(w))=u'(f'(w))=f(\tilde{y}-y)=f(\tilde{y})-f(y)$. Then we have $u'(\tilde{z})-u'(z)=u'(f'(w))$. Since $u'$ is injective, we have $\tilde{z}=z+f'(w)$, thus $\tilde{z}+\text{Im}(f')=z+\text{Im}(f')$.  Then we conclude that $\delta$ is well defined.
\item Exactness at $K''$\\
For $x\in K$, we formally write
$$
\begin{aligned}
\delta(\hat{v}(x))&=u'^{-1}(f(v^{-1}(k''(\hat{v}(x)))))+\text{Im}(f')\\
&=u'^{-1}(f(v^{-1}(v(k(x)))))+\text{Im}(f')\\
&=u'^{-1}(f(k(x)))+\text{Im}(f')\\
&=0 \text{ because } f\circ k=0.\\
&\Lrta \text{Im}(\hat{v})\subset \text{Ker}(\delta)
\end{aligned}
$$
For the converse inclusion. $\forall x\in \text{Ker}(\delta)$, we trace back to the construction of $\delta$, and select the corresponding $y\in M,\ z\in N'$, where $v(y)=x$ and $u'(z)=f(y)$. $\because x\in \text{Ker}(\delta),\therefore z\in \text{Im}(f')$. $\Lrta \exists w\in M'$ s.t. $f'(w)=z$. Then we choose another $\tilde{y}=y-u(w)$, one verifies that $v(\tilde{y})=v(y)-v(u(w))=v(y)=x$. (this is legal, because we know $\delta$ does not depend on the choice of $y$) Also, we know $f(\tilde{y})=f(y)-f(u(w))=f(y)-u'(f'(w))=f(y)-u'(z)=0$. Then we know $\tilde{y}\in \text{Ker}(f)=K$, we conclude that $\hat{v}(\tilde{y})=x$, thus $\text{Ker}(\delta)\subset \text{Im}(\hat{v})$.
\item Exactness at $C'$\\
For $x\in K''$, we formally write
$$
\begin{aligned}
\bar{u}(\delta(x))&=\bar{u}\left(u'^{-1}(f(v^{-1}(k''(x))))+\text{Im}(f')\right)\\
&=(q\circ u')\left(u'^{-1}(f(v^{-1}(k''(x))))\right)\\
&=q(0+f(v^{-1}(k''(x))))\\
&=0\\
&\Lrta \text{Im}(\delta)\subset \text{Ker}(\bar{u})
\end{aligned}
$$
For the converse inclusion, we choose an element $z+\text{Im}(f')\in \text{Ker}(\bar{u})$. Then $\bar{u}(z+\text{Im}(f'))=q\circ u'(z)=0$, then we have $\exists y\in M \text{ s.t. } u'(z)=f(y)$. Also we have $v'(u'(z))=v'(f(y))=0,\Lrta f''(v(y))=0$. $v(y)\in \text{Ker}(f'')=K''$. We can check that $\delta(v(y))=z+\text{Im}(f')$. Hence, we conclude that $\text{Ker}(\bar{u})\subset \text{Im}(\delta)$.
\end{enumerate}
\end{proof}

\begin{ex}
(Application of snake lemma) We have such a commutative diagram, each row is exact. Suppose the middle map is isomorphism. 
\[
\begin{tikzcd}
0\arrow[r]  & M'  \arrow[r]\arrow[d,"f'"] & M\arrow[r] \arrow[d,"f"] & M''\arrow[r] \arrow[d,"f''"] & 0 \\
0\arrow[r]  & N'  \arrow[r] & N\arrow[r] & N''\arrow[r]  & 0 
\end{tikzcd}
\]
then we have a map $\delta: \text{Ker}(f'')\lrta Coker(f')$ s.t.  
$$
0\lrta \text{Ker}(f')\lrta \{0\} \rta \text{Ker}(f'')\overset{\delta}{\lrta}Coker(f')\lrta \{0\}\lrta Coker(f'')\lrta 0 
$$
is exact. Thus we get $\delta:\text{Ker}(f'')\lrta Coker(f')$ is an isomorphism.
\end{ex}
\begin{prop}

\end{prop}
If $0\lrta M'\overset{u}{\lrta}M\overset{v}{\lrta}M'' \lrta0$  is exact, then for any $\cala$-module $N$,
\begin{equation}\label{eq:1}\tag{*}
\begin{array}{ c c c c c c c c c}
0 & \longrightarrow  & Hom_\cala(M'',N) & \overset{v^*}{\longrightarrow } & Hom_\cala(M,N) & \overset{u^*}{\longrightarrow } & Hom_\cala(M',N)  \\
 &  & f &\longmapsto  & f\circ v &  &   \\
 &  &  &  & g & \longmapsto & g\circ u 
\end{array}
\end{equation}
is exact, in general $u^*$ is not surjective. Also,
\begin{equation}\label{eq:2}\tag{**}
\begin{array}{ c c c c c c c c c}
  Hom_\cala(N,M'') & \overset{u_*}{\longrightarrow } & Hom_\cala(N,M) & \overset{v_*}{\longrightarrow } & Hom_\cala(N,M') & \longrightarrow  & 0\\
  f &\longmapsto  & u\circ f  &  &  &  & \\
   &  & g & \longmapsto & v\circ g &  &
\end{array}
\end{equation}
is exact but $u_*$ is in general not always injective.
\\
More precisely, we have \textbf{right exactness of functor $Hom(\underline{\ \ }, N)$}:\\
$$
M'\overset{u}{\lrta}M\overset{v}{\lrta}M'' \lrta0 \text{ is exact} \Longleftrightarrow (\ref{eq:1}) \text{ is exact for all $N$}
$$\\
and 
\textbf{left exactness of functor $Hom(N,\underline{\ \ })$}:\\
$$
0\lrta M'\overset{u}{\lrta}M\overset{v}{\lrta}M'' \text{ is exact }\Longleftrightarrow (\ref{eq:2})\text{ is exact for all $N$}.
$$
\begin{proof}
For ``$\Lrta$'' part of the first statement, we assume $M'\overset{u}{\lrta}M\overset{v}{\lrta}M'' \lrta0$ is exact. 
Let $N$ be $\cala$-module, then we check that:
\begin{enumerate}
\item $u^*\circ v^*=0$\\
Let $f:M''\lrta N$, $(u^*\circ v^*)(f)=f\circ v\circ u=f\circ(v\circ u)=0$ 
\item $v^*$ is injective\\
Let $f:M''\lrta N$ be such that $v^*(f)=f\circ v=0$ $\Lrta f(\text{Im}(v))=0$ $\Lrta$ $f=0$ because $v$ is surjective.
\item $\text{Ker}(u^*)\subset \text{Im}(v^*)$\\
Let $f:M\lrta N$ be such that $u^*(f)=f\circ u=0$. Then $f(\text{Im}(u))=0$ so $f(\text{Ker}(v))=0$, so there is $\bar{f}:M/\text{Ker}(v)\lrta N$ s.t. $\bar{f}\circ p=f$.
\[
\begin{tikzcd}
 M  \arrow[r,"f"] \arrow[d,"p"] & N \\
M/\text{Ker}(v)\arrow[swap, ur,"\bar{f}"] &    
\end{tikzcd}
\]
We know that $v$ induces an isomorphism 
\[
\begin{tikzcd}
 \text{Im}(v)=M''\arrow[dr,swap,bend right,"\bar{v}^{-1}"]&
 M \arrow[swap,l,"v"] \arrow[r,"f"]  \arrow[d,"p"] & N \\
& M/\text{Ker}(v)\arrow[swap, ur,"\bar{f}"] \arrow[ul,"\bar{v}"]& 
\end{tikzcd}
\]
Let $f'=\bar{f}\circ \bar{v}^{-1}\in Hom(M'',N)$, we compute $v^*(f')=f'\circ v=\bar{f}\circ \bar{v}^{-1}\circ v=\bar{f}\circ p=f$ thus $f\in \text{Im}(v^*)$
\end{enumerate} 
We then give an example where the surjectivity of $u^*$ fails\\
Consider $\cala=\intg$,\ 
$0\lrta \intg\overset{\times 2}{\lrta}\intg\overset{\ }{\lrta}\intg/2\intg \lrta0$ is exact.
$$
\begin{aligned}
v^*: & Hom(\intg, N)\rta Hom(\intg,N) \\
 &\ \ \ \ \ \ \ \ \ f \longmapsto  f\circ(\times 2)
\end{aligned}
$$
 is not surjective if $N=\intg$, because $f=Id_\intg$, we want to find a map $g$ such that the following diagram commutes,
 \[
\begin{tikzcd}
0 \ar[r] & \intg\ar[r,"\times 2"]\ar[d,"Id"] & \intg \ar[dl, dashed,"?"description, "g"] \\
& \intg &
\end{tikzcd}
 \]
 but there is no $g$ such that $g\circ(\times 2)=Id_\intg$ because every morphism in $Hom_\intg(\intg,\intg)$ is of the form $\times q$, where $q\in\intg$.

 Conversely, for the ``$\Llta$'' part of the first statement, assume (\ref{eq:1}) is always exact. We want to show that $M'\overset{u}{\lrta}M\overset{v}{\lrta}M'' \lrta0$ is exact, 
 $$
\begin{array}{ c c c c c c c c c}
0 & \longrightarrow  & Hom_\cala(M'',N) & \overset{v^*}{\longrightarrow } & Hom_\cala(M,N) & \overset{u^*}{\longrightarrow } & Hom_\cala(M',N) &  & \\
 &  & f &\longmapsto  & f\circ v &  &  &  & \\
 &  &  &  & g & \longmapsto & g\circ u &  &
\end{array}
 $$
 \begin{enumerate}
\item Let $N=Coker(v)$ and $[p:M''\lrta Coker(v)]\in Hom(M'',N)$, then $v^*(p)=p\circ v=0$. Since $v^*$ is injective, we have $p=0$, in other words $M''=\text{Ker}(p)=\text{Im}(v)$ so $v$ is surjective.
\item Take $N=M''$ and $f=Id_{M''}$, $(u^*\circ v^*)(f)=0$ means $Id_{M''}\circ v\circ u=0$ $\Lrta v\circ u=0$, hence $\text{Im}(u)\subset \text{Ker}(v)$.
\item  Take $N=M/\text{Im}(u)$, and $p:M\lrta N$ projection, we have $u^*(p)=p\circ u=0$. So $p\in \text{Ker}(u^*)$, so there exists $f\in Hom(M'',N) $ s.t. $v^*(f)=f\circ v=p$. 
\[
\begin{tikzcd}
 M'  \arrow[r,"f"] & N=M/\text{Im}(u) \\
M\arrow[ur,"p"] \arrow[u,"v"] &    
\end{tikzcd}
\]
Hence $\text{Ker}(v)\subset \text{Ker}(p)$ and $\text{Ker}(v)\subset \text{Im}(u)$, then we can conclude that $\text{Ker}(v)=\text{Im}(u)$.
\end{enumerate}
The above steps proves the first statement and proof of the second statement is similar.
\end{proof}
\section*{Tensor Product}
\begin{dfn}
$M,N,P$  are $\cala$-modules, A map $f:M\times N\lrta P$ is called $\cala$-\textbf{bilinear} if 
$$
f(ax+by, z)=af(x,z)+bf(y,z)
$$
$$
f(x,ay+bz)=a f(x,y)+bf(x,z)
$$
$$
Bil_{\cala}(M,N,P)=\{\text{ all $\cala$-bilinear maps form $M\times N$ to $P$}\}.
$$
$Bil_{\cala}(M,N,P)$ is an $\cala$-module.
\end{dfn}

\begin{dfn}\label{def:tensor_product}
$M,N$ are $\cala$-modules and the \textbf{tensor product} gives an $\cala$-module $M\otimes_\cala N$ such that $Bil_\cala(M,N;P)=Hom_{\cala}(M\otimes_\cala N,P)$. $Bil_\cala(M,N;P)$ is obviously an $\cala$-module, with sum and scalar multiplication performed valuewise.
\end{dfn}

\begin{thm}
$M,N$ are $\cala$-modules. There exists a pair $(T,\beta)$ where $T$ is an $\cala$-module and $\beta:M\times N\lrta T$ s.t.  any $\cala$-bilinear map $b:M\times N\lrta P$ factors through $(T,\beta)$, i.e. there exists a unique $f:T\lrta P$ s.t. the following  diagram commutes.
\[
\begin{tikzcd}
 M\times N \arrow[d,"\beta"] \ar[r,"b"] & P \\
T\arrow[swap,ur,"\exists !f"] &    
\end{tikzcd}
\]
This is what we call \textbf{universal property}. One can check that if it exists, it is unique.
\end{thm}
\subsection{Lecture 5. Properties of Tensor Product}
The motivation of tensor product is  to ``classify'' bilinear/multilinear maps between modules over some ring $\cala$.
\begin{dfn/thm}
$M$ and $N$ are $\cala$-modules, \textbf{there exists a best possible bilinear map $M\times N\rta M\otimes N$.} That is to say : there exists a module $T$ (denoted $M\otimes N$ or $M\otimes_\cala N$) and a bilinear map $f:M\times N\lrta T$. By ``best possible'', we mean:
For all module $P$ and all bilinear map $b:M\times N\rta P$,
here exists a unique $\tilde{b}:T\lrta P$ s.t. the following  diagram commutes.
\[
\begin{tikzcd}
 M\times N \arrow[d,"f"] \ar[r,"b"] & P \\
T\arrow[swap,ur,"\exists !\tilde{b}"] &    
\end{tikzcd}
\] 
What's more $(T,f)$ is \textbf{strongly unique} which means \textbf{it is unique up to unique isomorphism}
\[
\begin{tikzcd}
 M\times N \arrow[d,"f"] \ar[r,"f'"] & T'\arrow[swap,dl,"\exists !k"] \\
T\arrow[swap,ur,bend right,"\exists !j"] &    
\end{tikzcd}
\] 
\end{dfn/thm}
\begin{proof}
\textbf{Uniqueness}\\
The uniqueness is just the direct result of universal property. By definition, $f$ is bilinear. Apply the universal property with $P=T'$, $b=f'$, then we know $j:=\tilde{b}:T\rta T'$. Similarly, we can construct $k$ by swapping $T,T'$. Consider $k\circ j:T\rta T$, apply the universal property with $P:=T$, $b:=f$
\[
\begin{tikzcd}
 M\times N \arrow[d,"f"] \ar[r,"f"] & T \\
T\arrow[swap,ur,"\exists !\tilde{b}"] &    
\end{tikzcd}
\] 
We know $\exists ! \tilde{b}$ s.t. the diagram commutes. Then we have $\tilde{b}\circ f=f$, but another obvious map having this property is just $id_T$. Then, we get to the conclusion $k\circ j=id_T$ by the uniqueness of $\tilde{b}$. Similarly, we get $j\circ k=id_{T'}$. Altogether, we conclude that $(T,f)$ is unique up to unique isomorphism.\\
\textbf{Existence}\\
Form the free module $C:=\cala^{M\times N}$, where 
$$
\cala^{(M\times N)}=\left.\left\{\sum_{(x,y)\in M\times N} a_{(x,y)}(x,y)\right|a_{(x,y)}\in \cala, \text{almost all $a_{(x,y)}=0$}\right\}.
$$
{\color{red}We'd better mention the universal property of the free module $\cala^{(M\times N)}$, every map $q:M\times N\lrta P$ can be extended to $\tilde{q}:\cala^{(M\times N)}\lrta P$}\\
Let submodule $D\subseteq C$, then there is an induced map $\bar{g}:M\times N\lrta C/D$ for defining map $g:M\times N\lrta C$ of the free module. Then we consider a certain submodule $D$ with the following two equivalent definitions
\begin{itemize}
\item $D$ is the smallest submodule for which all the induced map $\bar{g}:M\times N\lrta C/D$ is bilinear.
\item $D$ it the submodule generated by the following elements
$$
\left\{\left.
\begin{aligned}
&(x+x',y)-(x,y)-(x',y)\\
&(x,y+y')-(x,y)-(x,y')\\
&a(x,y)-(ax,y)\\
&a(x,y)-(x,ay)
\end{aligned}
\right|\forall a\in \cala, \forall x,x'\in M,\forall y,y'\in N
\right\}
$$
\end{itemize}   
The equivalence of two definition can be explained by the definition of ``bilinear maps''. \\
We want to show that $C/D$ is what we are looking for. First, we claim, for all bilinear mop $ b:M\times N\rta P,\ \text{Ker}(\tilde{b})\supseteq D$.\\
The proof is to just check it by hand, e.g.
$$
\begin{aligned}
&\tilde{b}((x+x',y)-(x,y)-(x',y))\\
&=\tilde{b}((x+x',y))-\tilde{b}((x,y))-\tilde{b}((x',y))\\
&=b(x+x',y)-b(x,y)-b(x',y)\\
&=0(\text{by $b$ is bilinear})
\end{aligned}
$$
The characterization of $\tilde{b}$ determines its restriction of $g(M\times N)\subseteq T$. Clear by construction that $g(M\times N)$ generates $T$. We get the conclusion that $\bar{g}:M\times N\rta C/D=T$.
\end{proof}
Also note that, in general
$$
S:=\{m\otimes n|(m,n)\in M\times N\}\neq M\otimes N
$$, e.g. $\intg^n\otimes \intg/2\intg\cong \intg/2\intg$
but $S$ generates $M\otimes N$ as we saw in the proof.
\begin{ex}
Natural isomorphisms, $\exists !\ isomorphisms$
\begin{enumerate}
\item $M\otimes N\cong N\otimes M$
\item $(M\otimes N)\otimes P\cong M\otimes (N\otimes P)$
\item $M\otimes (N_1\oplus N_2)\cong (M\otimes N_1)\oplus (M\otimes N_2)$
\item $\cala\otimes M\cong M$
\end{enumerate}
\end{ex}
\begin{proof}
we prove part 3. Consider a map: 
$$
\begin{aligned}
b:M\times (N_1\oplus N_2)&\rta M\otimes N_1 \oplus M\otimes N_2\\
(m,(n_1,n_2))&\mapsto (m\otimes n_1, m\otimes n_2).
\end{aligned}
$$
We can check that $b$ is bilinear, for example 
$$
\begin{aligned}
&b(m+m',(n_1,n_2))\\
&=((m+m')\otimes n_1,(m+m')\otimes n_2)\\
&= (m\otimes n_1+m'\otimes n_1,m\otimes n_2+m'\otimes n_2)\\
&=(m\otimes n_1,m\otimes n_2)+(m'\otimes n_1,m'\otimes n_2)\\
&=b(m,(n_1,n_2))+b(m',(n_1,n_2)).
\end{aligned}
$$
As a result the bilinear map $b$ must factor through $M\otimes (N_1\oplus N_2)$, and we denote the corresponding map $f:M\otimes (N_1\oplus N_2)\rta M\otimes N_1 \oplus M\otimes N_2$.
$$
f(m\otimes (n_1,n_2))=(m\otimes n_1,m\otimes n_2).
$$
We use the terminology \textbf{pure tensor} to name the tensors like $x\otimes y\in M\otimes N$, obviously, $M\otimes N$ is linearly generated by  pure tensors.
We want to show that $f$ is an isomorphism. Need to find the inverse map $g$ of $f$.

define 
$$
\begin{aligned}
g_1:M\otimes N_1&\lrta M\otimes(N_1\oplus N_2)\\
(m\otimes n_1)&\longmapsto m\otimes (n_1,0)
\end{aligned}
$$
similarly, we can construct 
$$
\begin{aligned}
g_2:M\otimes N_2&\lrta M\otimes(N_1\oplus N_2)\\
(m\otimes n_2)&\longmapsto m\otimes (0,n_2)
\end{aligned}
$$
Then, we define $g=g_1\oplus g_2$. We want to show $f\circ g=id, g\circ f=id$.
$$
\begin{aligned}
&f\circ g(m\otimes n,m'\otimes n_2)\\
&=f(m\otimes (n_1,0)+m'\otimes(0,n_2))\\
&=(m\otimes n_1,0)+(0,m'\otimes n_2)\\
&=(m\otimes n_1,m'\otimes n_2)
\end{aligned}
$$
Then $f\circ g=id $ on pure tensors, hence it is identity on all tensors, because $f\circ g$ is linear, and pure tensor generates the whole tensor product module.
\end{proof}
Consider $\cala^m=\cala\oplus \cala\oplus...\oplus \cala$ (finite free module), by the isomorphism 4 in the above example 
$$
\begin{aligned}
\cala\otimes \cala&\cong \cala\\
x\otimes y&\mapsto xy
\end{aligned}
$$
also by iterating (3) and (4), we get 
$$
\cala^m\otimes \cala^n\cong \cala^{mn},
$$
compared to the known result
$$
\cala^m\oplus \cala^n\cong \cala^{m+n}.
$$
More directly,
if $e_1^{(1)},...,e_m^{(1)}$ standard basis for $\cala^m$, $e_1^{(2)},...,e_n^{(2)}$ standard basis for $\cala^n$,
then
$$
\left.\left\{e_i^{(1)}\otimes e_j^{(2)}\right|,m\geq i\geq1,n\geq j\geq 1\right\}
$$
form a basis of $\cala^m\otimes \cala^n$ and induces $\cong \cala^{mn}$

To see this directly, consider a bilinear map $f:\cala^m\times \cala^n\lrta P$, where $P$ is some module.
$$
\cala^m\ni x=x_1 e_1^{(1)}+...+x_m e^{(1)}_m, \ x_i\in \cala
$$
$$
\cala^n\ni y=y_1 e_1^{(1)}+...+y_m e^{(1)}_m, \ y_i\in \cala
$$
Then 
$$
f(x,y)=\sum_{
\begin{aligned}
&i=1...m\\
&j=1...n
\end{aligned}}
x_i y_j f(e_i^{(1)}\otimes e_j^{(2)}),
$$
where we can define $f(e_i^{(1)}\otimes e_j^{(2)})=:a_{ij}\in P$
Generally, given an $mn$-tuple $(a_{ij})$ in $P$ we may define a bilinear $f:\cala^m\times\cala^n\lrta P$ by the above formula.
\[
\begin{tikzcd}
 \cala^m\times \cala^n \arrow[d,"f"] \ar[r]
 \arrow[phantom]{r}[ yshift=3.5 ex]{\substack{ (e_i^{(1)}, e_j^{(2)})\ \longmapsto\ e_i^{(1)}\otimes e_j^{(2)}}} 
 & \cala^{\oplus\{e_i^{(1)}\otimes e_j^{(2)}\}} \arrow[dl,"\exists !\tilde{f}\ s.t.\ \tilde{f}(e_{ij})=a_{ij}"]
 \\
P &    
\end{tikzcd}
\] 
\begin{rmk}
More generally, we may define the $n$-fold tensor products $M_1\otimes ...\otimes M_n$.
$$
\left\{\text{multilinear maps :}M_1\times...\times M_n\lrta P \right\}\leftrightarrow \left\{\text{linear maps :}M_1\otimes...\otimes M_n\lrta P \right\}
$$
Let $V=\reals^n$, then 
$$
\left\{\text{inner products on }V \right\}\leftrightarrow \left\{\text{linear functions on }V\otimes V\right\}
$$
\end{rmk}
\begin{rmk}
\textbf{Extension of scalars}
Consider a ring morphism $f:\cala\rta\mathcal{B}$ and an $\cala$-module $M$, we can construct a $\calb$-module
$$
M_\calb:=M\otimes_\cala \calb,
$$
where $\calb$ is regarded as an $\cala$-module via $f$, i.e. $a\cdot b=f(a)b$. And the $\calb$ action on $M_\calb$ is like
$b\cdot(m\otimes z):=m\otimes b z $
\end{rmk}
\begin{ex}\ 
\begin{itemize}
\item $M=\cala^m\Lrta M_\calb=\calb^m$
\item $\cala=\reals, \calb=\cplx\Lrta (\reals^n)_\cplx:=(\reals^n)\otimes_\reals \cplx\cong\cplx^n$
\end{itemize}
\end{ex}

\subsection{Lecture 6. Flatness}
The meaning of $x\otimes y$ depends on the modules to which we regard $x$ and $y$ are belonging. In fact, one can have $x\in M'\subseteq M$ and $y\in N'\subset N$ but 
$$
M'\otimes N'\ni x\otimes y\neq x\otimes y\in M\otimes N
$$
\begin{ex}
$\cala=\intg$ , $M'=2\intg\subseteq M=\intg$, $N'=\intg/2 =N$,
 then $2\intg \otimes \intg/2\intg \ni 2\otimes 1\neq 0 $, but $\intg \otimes \intg/w\intg\ni2\otimes 1=0$ 
\end{ex}
In summary, we no $M'\subset M, N'\subset N$ does not indicate that $M'\otimes N'\subset M\otimes N$, which means the simple inclusion is  not an injective  morphism. 

But $\otimes$ is indeed a \textbf{bifunctor}. Given module morphisms
$$
\begin{aligned}
& f: M'\lrta M\\
& g: N'\lrta N\\
\exists ! f\otimes g:&M'\otimes N':\lrta M\otimes N\\
&x\otimes y\longmapsto f(x)\otimes g(y)
\end{aligned}
$$ 
and 
$$
(f\circ f')\otimes(g\circ g')=(f\otimes g)\circ (f'\otimes g')
$$
For example, we alway consider the case $g=1_N$ with $N$ $\cala$-module, then each morphism $f:M'\lrta M$ is mapped to $f\otimes 1_N:M'\otimes N\lrta M\otimes N$.

\begin{dfn}
$N$ is \textbf{flat} if $\forall f: M'\lrta M$  s.t.
$$
f:\text{injective }\Lrta f\otimes 1_N \text{ is injective}
$$
In other words,
 $$
M'\subset M\Lrta \text{``$M'\otimes N\subset M\otimes N$''}
 $$
\end{dfn}

\begin{ex}\ 
\begin{itemize}
    \item 
$\{0\}$ is a flat $\cala$-module
\item 
$\cala$ is a flat $\cala$-module, because $M\otimes_\cala\cala=M$ and $f=f\otimes 1_\cala$ 
\end{itemize}
\end{ex}

\begin{lemma}
Let $(N_i)_{i\in I}$ be a family of modules over $\cala$, then $\oplus_{i\in I} N_i$ is flat iff each $N_i$ is flat.
\begin{proof}
Suppose each $N_i$ is flat. Let $M'\overset{f}{\lrta}M$ be injective. Suppose, 
$$
M'\otimes(\oplus_{i}N_i)\overset{f\otimes 1}{\lrta}M\otimes (\oplus_i N_i) 
$$
is not injective, i.e.  $z\in \text{Ker}(f\otimes 1_N)\neq 0$. 
Let $N$ denote $\oplus_i N_i$ and the $i$-th projection $\pi_i:N\lrta N_i$.
\[
\begin{tikzcd}
0\neq z\arrow[r,phantom,"\in"] & \oplus_i (M'\otimes N_i)\arrow[r,"\rho_i'"] \arrow[d,equal] & M'\otimes N_i\arrow[d,equal] \\
& M'\otimes(\oplus_i N_i)\arrow[r,"1_{M'}\otimes \pi_i"] \arrow[d,"f\otimes 1_N"] & M'\otimes N_i \arrow[d,"f\otimes 1_{N_i}"] \\
& M\otimes (\oplus_i N_i)\arrow[r,"1_M\otimes \pi_i"] & M\otimes  N_i\\
& \oplus_i (M\otimes N_i)\arrow[r,"\rho_i"] \arrow[u,equal] & M\otimes N_i\arrow[u,equal] \\
\end{tikzcd}
\]
$z\neq 0\Lrta \exists i\in I$ s.t. $\rho_i'(z)\neq0$ $\Lrta (f\otimes 1_{N_i})(\rho_i'(z))\neq0\in M\otimes N_i$.
But $(f\otimes 1_{N_i})(\rho_i'(z))=\rho_i(f\otimes 1_{N}(z))$ is the $i$-th component of $(f\otimes1_N)(z)=0$ by assumption, which gives the contradiction.
The converse is simpler.
\end{proof} 
\end{lemma}
\begin{cor}
If $M$ is a free $\cala$-module, then it is a flat module.
\begin{proof}
We already know $\cala$ is flat, then by the previous lemma, we know $\oplus_{i\in I}\cala$ is flat.
\end{proof}
\end{cor}

\begin{ex}
Consider a system of linear equations
$$
S:f_1(x_1,...,x_n)=...=f_m(x_1,...,x_n)=0,
$$
where these $f_i$'s has coefficients in $\reals$. Then $S$ has solution over $\reals$ iff $S$ has solution over $\cplx$ (This claim works for any field extension $L/K$ instead of  $\cplx/\reals$)
A simple proof goes like: ``$\Lrta$'' is trivial, for the converse, we take the real or the imaginary part of a complex solution. 

For a second proof:
$$
M'=\reals^n\overset{f}{\lrta} M=\reals^m,
$$
where $f=(f_1,...,f_m)$.
$\cala=\reals$, $ N=\cplx\cong \reals\oplus \reals i$ is free, then by the above corollary, we know $N$ is flat.
Then $S$ has a solution over $\reals$ iff $\text{Ker}(f)\neq 0$, and $S$ has a solution over $\cplx$ iff $\text{Ker}(f\otimes 1_\cplx)\neq 0$. If $f\otimes 1$ is not injective, by the definition of flat module, we know $f$ is not injective, which conclude the proof. This second proof works for arbitrary field extension, because the field extensions are always free modules over the initial field.
\end{ex}

\begin{prop}(Right exactness of $\otimes N$)\\
Consider an exact sequence of $\cala$-modules
\begin{equation*}
\begin{array}{ c c c c c c c c c}
  M' & \overset{f}{\longrightarrow } & M & \overset{g}{\longrightarrow } & M'' & \longrightarrow  & 0\\
\end{array}
\end{equation*}
Then we have
\begin{equation*}
\begin{array}{ c c c c c c c c c}
  M'\otimes N & \overset{f\otimes 1}{\longrightarrow } & M\otimes N & \overset{g\otimes 1}{\longrightarrow } & M''\otimes N & \longrightarrow  & 0\\
\end{array}
\end{equation*}
 is  exact for arbitrary $\cala$-module $N$.
\end{prop}
\begin{proof}
Obviously $g\otimes 1$ is surjective. We only need to prove the exactness at $M\otimes N$. As for the easier inclusion,
$
\text{Im}(f\otimes 1)\subseteq \text{Ker}(g\otimes 1)
$
because $(g\otimes 1)\circ (f\otimes 1)=(g\circ f)\otimes 1=0$. 
Then it remains to show 
$$
\frac{M\otimes N}{\text{Im}(f\otimes 1)}\overset{\psi}{\lrta}M''\otimes N
$$
is an isomorphism. $\psi $ is induced by $g\otimes 1$,  well defined because $
\text{Im}(f\otimes 1)\subseteq \text{Ker}(g\otimes 1).
$

Now, we construct a two-sided inverse $\varphi$ of $\psi$.
\[
\begin{tikzcd}
 M''\otimes N  \ar[r,dashed,"\exists \varphi"] & \frac{M\otimes N}{\text{Im}(f\otimes 1)} \\
 M''\times N \arrow[u] \arrow[ur,dashed,"\exists \varphi_0"]& \\
M\times N\arrow[swap,uur,"\varphi_1"]\arrow[u,"g\times 1"] &    
\end{tikzcd}
\] 
Consider the map $\varphi_1$, it is the composition of the canonical projection and the defining map of tensor product.
$\varphi_1(x,y)\mapsto x\otimes y+\text{Im}(f\otimes 1)$. Consider $(x'',y)\in M''\times N$, which is the image of $(x,y)$ under $g\times 1$. Then we can define $\varphi_0(x'',y):=\varphi_1(x,y)$. It is well-defined, because if there is another $(x_1,y)$ also map to $(x'',y)$, the difference
$$
x-x_1\in \text{Ker}(g)=\text{Im}(f),
$$
hence $\exists z\in M'$
$x-x_1=f(z)$.
$\Lrta (x-x_1)\otimes y=(f\otimes 1)(z\otimes y)$
Then
$$
\varphi_1(x,y)-\varphi(x_1,y)=(x-x_1)\otimes y+\text{Im}(f\otimes 1)=0.
$$
Then it remains to check $\varphi_0$ is bilinear so that $\varphi_0$ lifts to a $\varphi$ on $M''\otimes N$. Also we  need to check the $\varphi$ is indeed the two-sided inverse of $\psi$.

Consider  $\varphi_0(x'',ay+bv)$ and $\varphi_0(ax''+bw'',y)$. Chose $x$ and $w$ in the preimages $g^{-1}(x'')$ and $g^{-1}(w'')$. By the linearity of $g$, we can safely choose $ax+bw$ in the pre-image of $ax''+bw''$
Knowing that $\varphi_1$ is bilinear (because the defining map of tensor product is bilinear and canonical projection is linear), we have
$$
\begin{aligned}
&\varphi_0(x'',ay+bv)=\varphi_1(x,ay+bv)\\
&=a\varphi_1(x,y)+b\varphi_1(x,v)=a\varphi_0(x'',y)+b\varphi_0(x'',v)
\end{aligned}
$$
and
$$
\begin{aligned}
&\varphi_0(ax''+bw'',y)=\varphi_1(ax+bw,y)\\
&=a\varphi_1(x,y)+b\varphi(w,y)=a\varphi_0(x'',y)+b\varphi_0(w'',y).
\end{aligned}
$$ 
Explicitly, with $x\in g^{-1}(x'')$, 
$$
\varphi(x''\otimes y)=x\otimes y+\text{Im}(f\otimes 1)
$$
and
$$
\psi(x\otimes y+\text{Im}(f\otimes 1))=g(x)\otimes y
$$
$$
\begin{aligned}
&\Lrta\\
&\psi\circ\varphi(x''\otimes y)=g(x)\otimes y=x''\otimes y\\
&\varphi\circ \psi(x\otimes y+\text{Im}(f\otimes 1))=x_1\otimes y+\text{Im}(f\otimes 1)=x\otimes y+\text{Im}(f\otimes 1),
\end{aligned}
$$
where in the last line $x_1$ is another representative in $g^{-1}(x'')$.
\end{proof}

\begin{cor}
$N$ is flat iff $\otimes N$ preserves the exactness of any sequence of modules
\begin{proof}
Any exact sequence can be split up into short exact sequence, and the flatness does indicate it preserve  the exactness of short exact sequence.
\end{proof}
\end{cor}

\begin{ex}\label{ex:iso_quotient_module}
An ideal
$\sca\subset \cala$, and $M$ is an $\cala$-module,
$$
M\otimes_\cala \cala/\sca\cong M/\sca M,
$$
where $\sca M:=\{\sum x_i m_i|x_i\in \sca, m_i\in M\}$. $\sca M$ is a submodule of $M$.
\begin{proof}
$$
0\lrta \sca\lrta \cala\lrta \cala/\sca\lrta 0 
$$
is an exact sequence (of \cala-modules). Tensorring it with $M$, we have
$$
\sca\otimes M\overset{\psi}{\lrta }M\lrta M\otimes \cala/\sca\lrta 0
$$
is exact, where $\psi $ is induced by the inclusion $\sca\inj\cala$, $\psi:x\otimes m\mapsto xm$. $\text{Im}(\psi)=\sca M$
Then by the exactness, we have
$$
M\otimes \cala/\sca\cong M/\text{Im}(\psi)=M/\sca M.
$$
\end{proof}
\end{ex}


\begin{ex}
$$\intg/m\intg\otimes_\intg \intg/n\intg\cong \intg/gcd(m,n)\intg.$$ 
Pf. Take $M=\intg/m\intg$, $\cala=\intg$, $\sca=n\intg$. Then $$
\sca M=n\intg\otimes_\intg\intg/m\intg\overset{(1)}{\cong}n\intg/(n\intg\cap m\intg)=(n\intg+m\intg)/m\intg=gcd(m,n)\intg/m\intg.
$$
The isomorphism $(1)$ can be checked by set: $f: nk\otimes (p+m\intg)=k\otimes (np+m\intg)\longmapsto np+(n\intg\cap m\intg)$, which is obviously surjective and it is injective because $np\in n\intg\cap m\intg\Lrta k\otimes (np+m\intg)=0$.

Then by the result of Example~\ref{ex:iso_quotient_module}, we have
$$
M\otimes \cala/\sca=\frac{\intg}{m\intg}\otimes_\intg \frac{\intg}{n\intg}\cong\frac{\intg/m\intg}{gcd(m,n)\intg)/m\intg}= \frac{\intg}{gcd(m,n)\intg}=M/\sca M.
$$
\end{ex}

\begin{ex}
$\calb$ is an $\cala$-algebra and $M$ is a flat $\cala$-module, then the extension by scalar $M_\calb=M\otimes_\cala\calb$ is flat $\calb$-module. In particular, $N, N'$ are also $\cala$-module.
\begin{proof}
Consider an injective morphism of $\calb$-module: $f: N\lrta N'$.
$$
N\otimes_\cala M=(N\otimes_\calb \calb)\otimes_\cala M=N\otimes_\calb(\calb\otimes_\cala M)=N\otimes_\calb M_\calb
$$
$M$ being flat would lead to $f\otimes 1$ injective on $N\times_\cala M$, and by the above isomorphism, we are done.
\end{proof}
\end{ex}
Let $n\in\intg$. Then $\intg/n\intg$ is flat iff $n=\pm1,0$, i.e. $\intg/n\intg=\{0\} \text{ or } \intg$. This is easy to prove, consider the following short exact sequence for $|n|\geq 2$,
$$
0\lrta n\intg\lrta \intg\lrta \intg/n\intg\lrta 0,
$$
Suppose $\intg/n\intg$ is flat. Tensorring it with the above exact sequence, we get
$$
0\lrta0\lrta \intg\otimes\intg/n\intg\lrta \intg/n\intg\lrta 0,
$$
which gives the contradiction. 

Fact\\
Any finitely generated $\intg$-module is of the form
$$
M=\intg^r\left(\oplus_{i\in I}(\intg/n_i\intg\right))
$$,
 the second part of $M$ is denoted $M_{tors}$, then we get the corollary that a finitely generated $\intg$-module is flat iff $M_{tors}$ vanishes.
\begin{dfn}
$\cala$ a ring, $M$ an $\cala$-module, we call $M$ \textbf{torsion free} if $\forall a\in \cala$ non-zerodivisor. $m\in M$ $am=0\Lrta m=0$
\end{dfn}

\begin{thm}\ 
\begin{enumerate}
\item $M$ if flat $\Lrta$ $M$ is torsion free
\item If $\cala$ is PID, $M$ is torsion free $\Lrta $ $M$ is flat.
\end{enumerate}
\end{thm}
\begin{proof}
Bosch section 4.2
\end{proof}

Some other facts about tensor product
\begin{ex}
For $\cala=\bbf$ being a field, $V, W$ finite dimensional vector space over $\bbf$
$$
\begin{aligned}
V^*\otimes W&\cong Hom_{\bbf}(V,W)\\
l\otimes w &\mapsto [v\mapsto l(v)w]
\end{aligned}
$$
\end{ex}


\section{Localization}

\subsection{Lecture 7. Localization of Rings}
\textbf{Motivation}
For $\cala$ an integral domain, we defined the quotients field $Frac(\cala)$. In general, one may want to invert part of $\cala$. For example, we may consider $\intg[1/2]=\{a/(2^n)|a\in \intg, n\in \mathcal{N}\}$. Each $2^n\in \intg[1/2]$ is invertible. For a subset $0\notin S\subseteq \cala$, we can define $\cala[1/S]$ to be the subring of $Frac(\cala)$ generated by $\cala$ and $\{1/s|s\in S\}$.

\begin{dfn}
A set of $\cala$, $S$ is \textbf{multiplicatively closed} if 
\begin{itemize}
\item $1\in S$
\item $s,t\in S\Lrta st\in S$
\end{itemize}
For a set $S\subset \cala$, we can define its \textbf{multiplicative closure}
$$
\overline{S}:=\left\{s_{I}=\left. \prod_{i_n} s_{i_n}\right| I=(i_1,...,i_n), \forall{n},  s_{i_n}\in S\right\}
$$
A set $S$ is multiplicatively closed iff $S=\overline{S}$. And we see that $\cala[1/S]=\cala[1/\overline{S}]$.
\end{dfn}


\begin{dfn}
Let $\cala$ be a ring $S\subseteq \cala$ a multiplicatively closed set, define a relation $\sim $ on $\cala\times S$:
$$
(a,s)\sim(a',s')\Longleftrightarrow\exists t\in S \ \text{s.t. } as' t= a' st
$$
\end{dfn}

\begin{lemma}
``$\sim$'' is indeed a equivalence relation.
\end{lemma}
\begin{proof}
reflectivity and symmetricity are trivial, for the transtivity
$$
(a,s)\sim(a',s')\sim (a'',s'')
$$
$$
\begin{aligned}
&\Lrta\\
&\exists t\in S: as't=a's t\\
& \exists t'\in S: a's'' t'=a''s't'\\
&as''(tt's')=as'ts''t'=a's''t's t=a''s (t t's')\\
& \Lrta (a,s)\sim(a'',s'')
\end{aligned}
$$
\end{proof}
\begin{dfn}
We define \textbf{localization of $\cala$ with respect to $S$}, 
$S^{-1}\cala:(\cala\times S)/\sim$.  And we denote the equivalence class of $(a,s)$ by $a/s$.
\end{dfn}
\begin{prop}
There are well defined maps:
$$
(+):S^{-1}\cala\times S^{-1}\cala\lrta S^{-1}\cala,\ (a/s,a'/s')\mapsto \frac{as'+a's}{ss'}
$$
$$
(\cdot):S^{-1}\cala\times S^{-1}\cala\lrta S^{-1}\cala,\ \left(\frac{a}{s},\frac{a'}{s'}\right)\mapsto \frac{aa'}{ss'}
$$
$$
0_{S^{-1}\cala}=\frac{0}{1}\text{ and } 1_{S^{-1}\cala}=\frac{1}{1}
$$
Then $(S^{-1}\cala,0_{S^{-1}\cala},1_{S^{-1}\cala},+,\cdot)$ is a ring.
\end{prop}
\begin{proof}
One can check that the above ring operation and $0,1$ are well-defined. e.g.\\
$$
\begin{aligned}
&\frac{a}{b}\cdot\frac{0}{1}\overset{?}{=}\frac{0}{1}\\
\Llrta & \frac{a\cdot 0}{b\cdot 1}\overset{?}{=}\frac{0}{1}\\
\Llrta & \frac{0}{b}\overset{?}{=}\frac{0}{1}\\
\Llrta &\exists t\in S: 0\cdot 1\cdot t=0\cdot b\cdot t\checkmark
\end{aligned}
$$
and if $(a,s)\sim (b,t)$, then
$$
\begin{aligned}
&\frac{a}{s}+\frac{a'}{s'}\overset{?}{=}\frac{b}{r}+\frac{a'}{s'}\\
\Llrta &\frac{as'+a's}{ss'}\overset{?}{=}\frac{bs'+a'r}{rs'}\\
\Llrta & \exists t\in S: tss'(bs'+a'r)=trs'(as'+a's)\\
\Llrta & \exists t\in S: tsbs'^2=tras'^2\checkmark
\end{aligned}
$$

\end{proof}
\begin{rmk}
The above definition does not exclude the possibility that $S$ contains zero. But if $0\in S$ then we trivially have $\frac{a}{s}=\frac{0}{1}$, thus $S^{-1}\cala=\{0\}$.
\end{rmk}

We say $S^{-1}\cala$ is \textbf{localization of $\cala$ with respect to $S$}.
When $\cala$ is an integral domain, $S=\cala-\{0\}$ is multiplicative closed, the $S^{-1}\cala=Frac(\cala)$.
\begin{lemma}\label{lem:localization_inj_surj_iso}
There exists a ring morphism $\iota$ from $\cala$ to $S^{-1}\cala$ s.t each $a\in \cala$ maps to $a/1\in S^{-1}\cala$.
It has the following properties:
\begin{enumerate}[label=(\alph*)]
\item $\iota(S)\subset (S^{-1}\cala)^{\times}$
\item $\text{Ker}(\iota)=\{a\in \cala|sa=0 \text{ for some }s\in S\}$
\item Suppose $\cala\neq\{0\}.$ Then $\iota$ is injective $\Longleftrightarrow$ $S$ contains no zero divisors.
\item $S^{-1}\cala=\{0\}$ $\Longleftrightarrow$ $S\ni 0$
\item $\iota$ is isomorphism  $\Longleftrightarrow $ $S\subseteq \cala^{\times}$
\end{enumerate}
\end{lemma}
\begin{proof}We can easily check that $\iota$ thus defined is indeed a ring morphism.
\begin{enumerate}[label=(\alph*)]
\item  $s\in S$. $\iota(s)=s/1$ and $s/1\cdot 1/s=1$, then $s$ is a unit in $S^{-1}\cala$.
\item $a\in \text{Ker}(\iota)=\{b\in \cala|\frac{b}{1}=\frac{0}{1}\}$ $\Longleftrightarrow$ $\exists t\in S: t(a1-01)=ta=0.$
\item  derived from (a) and (b).
\item $S^{-1}\cala=\{0\}$ $\Longleftrightarrow$ $\frac{0}{1}=\frac{1}{1}$ $\Llrta$  there exists an element $t\in S$ s.t. $t\cdot1=0$, $\Longleftrightarrow t=0\in S$.
\item ``$\Lrta$'' Suppose $\cala\neq \{0\}$, then $\iota $ is isomorphism $\Llrta$  $\iota$ is surjective and injective. The surjectivity is equivalent to $\forall \frac{a}{s}\in S^{-1}\cala: \exists c\in \cala\ s.t.\ \frac{a}{s}=\frac{c}{1}$ while the injectivity is equivalent to $S$ has no zero-divisors  according to (c). Then we know, $\frac{1}{s}=\frac{c}{1}\Lrta\exists t\in S,\ \text{such that }\  t(s\cdot c-1)=0$, and by the fact $S$ has no zero-divisors  $s\cdot c=1$, which means $S\subseteq \cala^{\times}$.\\
``$\Llta$'' Assume $\cala\neq\{0\}$. $S\subseteq\cala^\times$, then $S$ does not contain any zero divisors. $\forall \frac{a}{s}\in S^{-1}\cala.$ Because $S\subseteq\cala^\times$ $ \exists v\in \cala \text{ s.t. } sv=1$. Then $ \frac{a}{s}=\frac{av}{1}\in \text{Im}(\iota)$, because $a s v=a$.

If $\cala=\{0\}$, the claim is trivially true.
\end{enumerate}
\end{proof}

\begin{ex}
$X$ any set, $U\subseteq X$ any subset.
$\cala:=\{\text{functions } f:X\lrta \reals\}$ is a ring of the the multiplication is defined value-wisely, $S:=\{f\in \cala| f(x)\neq 0, \forall x\in U\}$ is multiplicatively closed. Question, what is the localization $S^{-1}\cala$?
\end{ex}
\begin{lemma}$X$ any set, $U\subseteq X$ any subset.
$\cala:=\{\text{functions } f:X\lrta \reals\}$.
Let $\calb:=\{\text{functions }U\lrta \reals\}$.
Then the natural map $j:S^{-1}\cala\lrta \calb$ is an isomorphism $\frac{a}{s}\mapsto [U\ni x\mapsto\frac{a(x)}{s(x)}\in\reals]$ (This gives us some implication why localization is called localization)
\end{lemma}
\begin{proof}
$j$ is well-defined:
Say $\frac{a}{s}=\frac{a'}{s'}$. Thus $\exists t\in S, a s' t=a' s t$. Then $(a(x)s(x)-a'(x)s'(x))t(x)=0$, where $t(x)\neq0\forall x\in U$. Then by the properties of real numbers $\frac{a(x)}{s(x)}=\frac{a'(x)}{s'(x)}$.

Try defining $k:\calb\lrta S^{-1}\cala,\ b\longmapsto \tilde{b}/1$, where
$$
\tilde{b}:X\lrta \reals
$$
$$
\tilde{b}=\left\{
\begin{aligned}
&b(x),\ x\in U\\
&0, \ x\notin U
\end{aligned}
\right.
$$

$j\circ k=\mathds{1}$, $b\in \calb$
$\frac{\tilde{b}(x)}{1(x)}=b(x)\forall x\in U$.

$k\circ j=\mathds{1}$. Say $b=j(\frac{a}{s})$ is an element in $\calb$, $k(b)=\frac{\tilde{b}}{1}$, what we want is $\tilde{b}/1=a/s$, i.e. $\exists t\in S:(a\cdot 1-\tilde{b}\cdot s)t=0$.

Take $t:1_U=[x\mapsto 1 \text{ for }x\in U \text{ and } 0 \text{ for } x\not \in U]$. Done.
\end{proof}

\subsection*{Universal property of localization}
%Recall $Hom(M\otimes N, P)\cong \{bilinear M\times N\lrta P\}$ and $Hom(\oplus_{i}M_i,N)\cong \prod_i Hom(M_i,N)$.

\begin{lemma}
$Hom(S^{-1}\cala,\calb)\cong \{f:\cala\lrta \calb\text{ s.t. } f(S)\subseteq \calb^{\times}\}$. 
For an element $\tilde{f}\in Hom(S^{-1}\cala,\calb)$
$$
\tilde{f}\left(\frac{a}{s}\right):=f(a)f(s)^{-1}
$$
$$
f(a):=\tilde{f}\left(\frac{a}{1}\right).
$$
i.e. For every morphism $f:\cala\lrta\calb$ s.t. $f(S)\subseteq \calb^{\times}$, there exists a unique morphism $\tilde{f}:S^{-1}\cala\lrta \calb$ s.t. $f=\tilde{f}\circ\iota$, where $\iota $ is the canonical morphism $\iota:\cala\lrta S^{-1}\cala:a\mapsto \frac{a}{1}$.
\[
\begin{tikzcd}
S\ar[r,hook] &\cala  \arrow[r,"f"] \arrow[d,"\iota"] & \calb \\
&S^{-1}\cala\arrow[ur,swap,"\exists !\tilde{f}"]  &    
\end{tikzcd}
\]
This universal property of localization can serve as an alternative definition of localization, where $S^{-1}\cala$ is defined to be a pair $(T,\iota)$ so that any morphism $f$, $f:\cala\lrta \calb,f(S)\subseteq\calb^\times$ would factor through $T$ by $f=\tilde{f}\circ\iota$.
\end{lemma}
\begin{proof}
\underline{Want}: $\forall f$ as above $\exists ! \tilde{f}\text{ s.t. } \tilde{f}\circ\iota=f$

Uniqueness:\\
$\tilde{f}(a/s)=\tilde{f}(a/1)\tilde{f}(s/1)^{-1}=f(a)f(s)^{-1}$.

Existence :\\
Take $\tilde{f}(a/s):=f(a)f(s)^{-1}$, check that it is well defined:
$$
\frac{a}{s}=\frac{a'}{s'}\overset{?}{\Lrta} f(a)f(s)^{-1}=f(a')f(s')^{-1}.
$$
This is guaranteed, $\exists t\in S: as' t=a's t$ $\Lrta (f(a)f(s')-f(a')f(s))f(t)=0$ and $f(t)\in \calb^{\times}\Lrta f(a)f(s')-f(a')f(s)=0$.
\end{proof}

\begin{ex}
(Most Important Examples)
\begin{itemize}
    \item 
    $\cala\ni f$, $S_f:=\{f^n|n\geq 0\}$ is multiplicatively closed. $\cala_f:=S^{-1}_f\cala$.
    \item
    $\scp\subset \cala$ is a prime ideal, then $S_\scp:=\cala-\scp$ is multiplicatively closed (In fact, for an ideal $\scp$, $\cala-\scp$ being multiplicatively closed is equivalent to $\scp$ being prime). We can define 
    $\cala_{\scp}:=S_{\scp}^{-1}\cala$.
\end{itemize}
Caution that if $\scp=(f)$, usually $\cala_{(f)}\neq \cala_{f}$.
\end{ex}

Consider $\varphi:\cala\lrta\calb$ and $\sca\subseteq \cala, \scb\subseteq \calb$. We have defined in Definition~\ref{def:extention_contraction} the extension and contraction of ideals as $\scb^{c}=\varphi^{*}(\sca):=\varphi^{-1}(\scb)$ and $\sca^{e}=\varphi_*(\sca):=\calb\varphi(\sca)$. \textbf{Notice that 
$\scq\subseteq \calb$ prime $\Lrta \varphi^{*}(\scq)$ prime,
thus $\varphi^*:\text{Spec}(\calb)\lrta \text{Spec}(\cala)$}.

Back to the special case $\iota :\cala\lrta S^{-1}\cala$.
\begin{lemma}\label{lem:prep_localization_iso}
$S$ is a multiplicative set in a ring $\cala$, then for the canonical morphism $\iota:\cala\lrta S^{-1}\cala$:
\begin{enumerate}[label=(\alph*)]
\item For any ideal $\sca\subseteq \cala$, $\iota_*(\sca)=\{a/s|a\in\sca,s\in S\}$.
\item {\color{red} For a general ideal $ \scq\subseteq S^{-1}\cala,\iota^*(\scq)\overset{bij}{\llrta}\scq\cap \{\frac{a}{1}|a\in\cala\}$}.
\item $\iota_*(\sca)= S^{-1}\cala\Llrta\sca\cap S\neq \emptyset$.
\item For any ideal $\scb\subseteq S^{-1}\cala,$ $\iota_{*}(\iota^*(\scb))=\scb$.
\end{enumerate}
\end{lemma}
\begin{proof}\ 
\begin{enumerate}[label=(\alph*)]
   % \item Choose an ideal $\scq\subseteq S^{-1}\cala$, $\iota^*(\scq)=\iota^{-1}(\scq)$, $\iota(S)\subseteq (S^{-1}\cala)^\times,\Lrta \iota(S)\cap\scq=\emptyset$ otherwise $1\in \scq$ (In fact this part of proof also works for other ideals.) and the remaining part for proof of (a) is postponed until the next lecture.
\item 
 Denote $V:=\iota(\sca)=\{\frac{a}{1}|a\in\sca\}$, and then we check that $\iota_*(\sca):=S^{-1}\cala\cdot V=\{\frac{a}{s}|a\in\sca,s\in S\}$. 
\item 
 Similarly, we choose an ideal $\scq\subseteq S^{-1}\cala$ and check that $\iota^*(\scq):=\iota^{-1}(\scq)\ni a\longmapsto \frac{a}{1}\in\scq$ and for an $\frac{b}{1}\in\scq\cap\{\frac{c}{1}|c\in\cala\}\longmapsto b\in\cala$, which gives the one to one correspondence.
\item
 $\iota_*(\sca)=S^{-1}\cala\Llrta \exists a\in \sca, s\in S$ s.t. $a/s=1/1$
$\Llrta\exists t\in S$ s.t. $\sca\ni ta=ts\in S$, then $\sca\cap S\neq\emptyset$. Conversely, $\sca\cap S\neq \emptyset$, exists an $a\in \sca, a=s\in S$, then $a/s=1/1$. 
\item 
See Proposition~\ref{prop:properties_extension_contractino}, $\iota_*(\iota^*(\scb))\subset \scb$ in general. For the converse inclusion, if $a/s\in \scb$, then $a/s\cdot s/1=a/1\in\scb$, which means $a\in \iota^{*}(\scb)\Lrta a/s\in \iota_{*}(\iota^*(\scb))$. This claims means every ideal in $S^{-1}\cala$ is extension of an ideal in $\cala$. 
\end{enumerate} 
\end{proof}
\begin{rmkt}
  Notice that $\scq\cap\{\frac{a}{1}|a\in\cala\}$ is not necessarily an ideal in $S^{-1}\cala$. Explicit example shows that $\iota_*$ does not in general preserves the proper inclusion ``$\subsetneq$''. Let $\cala:=\intg$, $S:=\{2^n:n\in \intg_{\geq 0}\}$, then $S^{-1}\cala=\intg[1/2]$, $(2)\supsetneq (4)$ in $\cala$ but $\iota_*((2))=\iota_*((4))=S^{-1}(\cala)$. But however, unlike general $\varphi^*$, $\iota^*$ indeed preserves the proper inclusion. $\iota_*(\iota^*(\scb))=\scb\subsetneq \sca=\iota_*(\iota^*(\sca))\Lrta \iota^*(\scb)\subsetneq \iota^*(\sca)$. Or equivalently, $\frac{c}{s}\notin \sca\Lrta \frac{c}{1}\notin\sca\Lrta c\notin\iota^*(\sca)$. The fact that $\iota^*$ preserves proper inclusion is crucial for the claim $\text{dim}(\cala_\scp)=\text{ht}(\scp)$.
\end{rmkt}

\begin{lemma}\label{lem:radical_commutates_localization}
$\cala$ a ring and $S$ is a multiplicative set in $\cala$. Let $\iota:\cala\lrta S^{-1}\cala$, then we have
\begin{enumerate}[label=(\alph*)]
\item $\iota^*\iota_*(\sca)=\cup_{s\in S}(\sca:s)$
\item $\iota_*$ commutes with formation of finite sums, products, intersections and taking radicals.
\end{enumerate}
\begin{proof}\ 
\begin{enumerate}[label=(\alph*)]
\item 
$x\in \iota^*\iota_*(\sca)\Lrta $ $\frac{x}{1}\in\iota_*\sca=\{\frac{y}{s}:y\in\sca,s\in S\}$

``$\subseteq$'': Suppose $\frac{x}{1}=\frac{y}{s}$ for some $y\in\sca,s\in S$. Then $\exists t\in S$ s.t. $t(xs-y)=0$ $\Lrta stx=yt \in \sca\Lrta x\in (\sca:st)$, where $st\in S$.

``$\supseteq$'': Say $x\in (\sca:s)$ for some $s\in S$. Thus $xs=:y \in\sca$. Then $\frac{x}{1}=\frac{y}{s}\in \iota^*\iota_*\sca$. 
\item 
See~\ref{prop:properties_contraction_extension} for the properties of general contraction and extension. For general extension, $\varphi_*$ commutes with taking finite sum and products. we only need to prove the remaining two.

We already know $\varphi_*(\sca\cap\scb)\subset\varphi_*\sca\cap\varphi_*\scb$. For the converse inclusion in the case of $\iota_*$, consider $\frac{x}{u}\in \iota_*\sca\cap\iota_*\scb$, $\frac{x}{u}\sim\frac{a}{s}\sim\frac{b}{s'}$, where $a\in \sca, b\in\scb$ and $s,s',s''\in S$.  Then $\exists t, t',v\in S $ s.t. $x t s= a t u$, $x t's'=bt'u$ and $a s' v=b s v=c\in\sca\cap\scb$ then $x t t' ss'v=(a s' v) t t'u=(b sv) t t' u=c tt'u$ $\Lrta \frac{x}{u}\sim\frac{c}{ss'v}\in\iota_*(\sca\cap\scb)$.

We know form~\ref{prop:properties_contraction_extension} that in general $\text{rad}(\varphi_*\sca)\supseteq\varphi_*(\text{rad}(\sca))$, then in particular, we have $\text{rad}(\iota_*\sca)\supseteq\iota_*(\text{rad}(\sca))$. For the reverse inclusion, we check if $\frac{x}{s}\in \text{rad}(\iota_*\sca)$, then exists $n\in\mathbb{N}$, s.t. $\left(\frac{x}{s}\right)^n\in \iota_*\sca$. $\frac{x^n}{s^n}=\frac{y}{t}\in\iota_*\sca$, $\exists u\in S$ s.t. $u x^n t=u s^n y\in\sca$, then $(uxt)^n\in\sca\Lrta uxt\in\text{rad}(\sca)\Lrta \frac{x}{s}\in \iota_*(\text{rad}(\sca))$.
\end{enumerate}
\end{proof}
\end{lemma}


\subsection{Lecture 8. Properties of Localization of Rings}
Recall
$\iota:\cala\lrta S^{-1}\cala$
\begin{itemize}
\item $\iota_*(\sca)=\{\frac{a}{s}|a\in \sca,s\in S\}$
\item $\iota_*\iota^*(\scb)=\scb,\forall \scb\subseteq S^{-1}\cala$
\item $\iota_*\sca=(1)\Llrta \sca\cap S\neq \emptyset$
\end{itemize}
\begin{prop}\label{prop:iso_spec_localization}
$S$ is a multiplicative set in a ring $\cala$, then for the canonical morphism $\iota:\cala\lrta S^{-1}\cala$:
$$
\iota_*:\left\{\scp\in \text{Spec}(\cala)|\scp\cap S=\emptyset\ (S\subseteq \cala-\scp)\right\}\longleftrightarrow \left\{\text{Spec}(S^{-1}\cala)\right\}
$$
is bijection with the inverse $\iota^*$.
\end{prop}
\begin{proof}
The proof contains the following points
\begin{enumerate}[label=(\alph*)]
\item $\scp$ prime $\Llrta \iota_*\scp$ prime,
\item $\iota^*\iota_*\scp=\scp$, (True for only prime ideal $\scp$ which satisfies $\scp\cap S=\emptyset$. If $\scp\cap S\neq \emptyset$, $\iota^*\iota_*\scp=\cala$)
\item $\iota_*(\sca)= S^{-1}\cala\Llrta\sca\cap S\neq \emptyset$, (True for any ideals)
\item  $\iota_*\iota^*\scq=\scq$ (True for any ideal of $S^{-1}\cala$, not necessarily prime),
\end{enumerate}
of which (c) and (d) have  been proved in Lemma~\ref{lem:prep_localization_iso}.

We prove point $(b)$.
See Proposition~\ref{prop:properties_extension_contractino}, $\iota^*\iota_*\scp\supseteq\scp$ is a general fact.
 For the converse inclusion, $\iota^*\iota_*\scp=\iota^{-1}(\iota_*\scp)\overset{?}{\subseteq}\scp$, choose an $a\in \iota^{-1}(\iota_*\scp)$. $\iota(a)=\frac{a}{1}\in\iota_*\scp\Lrta\exists b\in \scp, s\in S$ s.t. $\frac{a}{1}=\frac{b}{s}\Lrta ast=bt\in \scp$ and $s,t \in S\subseteq \cala-\scp\Lrta a\in \scp$ because $\scp$ is a prime ideal.

As for point $(a)$, $\scp$ \text{ prime} $\overset{?}{\Lrta}\iota_*\scp$ prime. Consider $\frac{a}{s}\cdot \frac{b}{t}\in \iota_*\scp$, then $\frac{ab}{st}=\frac{c}{u},c\in\scp, u\in S$, then $\exists v\in S:abuv=cstv$, where $uv\in S$ $cstv\in\scp$, $uv\not\in \scp\Lrta ab\in\scp\Lrta$ at least one of $a, b\in\scp\Lrta$ at least one of $\frac{a}{s},\frac{b}{t}\in \iota_*\scp$.
\end{proof}
\begin{rmkt}
With the one to one correspondence, we can see that $\iota^*$ and $\iota_*$ preserve the inclusion, whats more, they preserve proper inclusion ``$\subsetneq$'' of \{prime ideals $\scp$, s.t. $\scp\cap S=\emptyset$\} and \{prime ideals in $S^{-1}\cala$\}.
\begin{itemize}
\item $\scq_1\subsetneq \scq_2\Llrta \iota^*\scq_1\subsetneq \iota^*\scq_2$,
\item $\scp_1\subsetneq \scp_2\Llrta\iota_*(\scp_1)\subsetneq\iota_*(\scp_2)$.
\end{itemize}
\end{rmkt}

\begin{cor}
The above correspondence says if $(0)$ is a prime ideal in $\cala$, then so is $S^{-1}(0)$, hence a localization of an integral domain is always an integral domain. But in fact ``being an integral domain'' is not a local property. Consider $\ratl\times\ratl$, whose maximal ideals are $(0,\ratl)$ and $(\ratl,0)$
\end{cor}

\begin{dfn}
$k(\scp):=Frac(\cala/\scp)$ is called the \textbf{residue field at (the point) prime ideal $\scp$}.
Then the above bijection induces isomorphism $k(\iota^*\scq)\cong k(\scq)$.
$$
k(\iota^*\scq)=Frac(\cala/\iota^*\scq)\cong Frac(S^{-1}\cala/\scq)=k(\scq)
$$
{\color{red}
\begin{proof}
Claim: there is an injective homomorphism form the integral domain $\cala/\iota^*\scq$ to $S^{-1}\cala/\scq$.
$$
\begin{aligned}
\overline{\iota}:&\cala/\iota^* \scq\lrta S^{-1}\cala/\scq\\
& a+\iota^*\scq\longmapsto \frac{a}{1}+\scq
\end{aligned}
$$
$\iota_*\iota^*\scq=\scq\Lrta \text{Ker}(\overline{\iota})=0+\iota^*\scq$. And see, for example,  
 \href{https://math.stackexchange.com/questions/2123201/relation-between-integral-domains-with-isomorphic-fraction-fields}{this StackExchange answer}, a injective morphism of integral domains induces a injective morphism of fraction fields. The induced morphism of fraction field is 
 $$
 Frac(\overline{\iota}):\frac{a+\iota^*\scq}{b+\iota^*\scq}\longmapsto \frac{\frac{a}{1}+\scq}{\frac{b}{1}+\scq}
 $$
 Lets check that it is in fact surjective: 
 $$
 \frac{\frac{f_1}{s_1}+\scq}{\frac{f_2}{s_2}+\scq}\sim \frac{\frac{f_1 s_2}{1}+\scq}{\frac{f_2 s_1}{1}+\scq}=Frac(\overline{\iota})\left(\frac{f_1 s_2+\iota^*\scq}{f_2 s_1+\iota^*\scq}\right)
 $$
\end{proof}}
\end{dfn}
\begin{ex}
$\cala=\intg$, and $\scp=(p)$ where $p$ is a prime number. $k(\scp)=Frac(\intg/p)=\intg/p$.

If $\scp=(0)$, $k(\scp)=Frac(\intg)=\ratl$.

If $\scp=\scm$ a  maximal ideal.$\Llrta\cala/\scp$ is a field and $k(\scp)=\cala/\scp$ 
\end{ex}

\begin{ex}
$\scp=(y)\subseteq\cala=\cplx[x,y]$, $\cala/\scp\cong \cplx[x], k(\scp)\cong \cplx(x)$
\end{ex}

\begin{ex}
$S=S_f=\{f^n:n\geq0\}$
$\Lrta S^{-1}\cala=\cala_f=\cala[1/f]$. Let $\scp\cap S\neq \emptyset\Llrta$ some $f^n\in \scp\leftrightarrow f\in \scp$.
Then $\text{Spec}(\cala_f)\cong \{\scp\in \text{Spec}(\cala)|f\notin \scp\}$
\end{ex}

\begin{ex}
$\cala=\intg,f=2$, $\cala_f=\intg[1/2]$

$\{\text{primes in }\intg[1/2]\}\cong \{(0),(3),(5)....\}\subseteq\text{Spec}(\intg)$.
\end{ex}

\begin{ex}
$\cala=\cplx[X,Y]$, there is a bijection between $\{\text{maximal ideals in }\cala\}$ and $\cplx^2$.
The maximal ideal $\{f\in \cplx[X,Y]| f(x_0,y_0)=0\}=(X-x_0, Y-y_0)$ corresponds to the point $(x_0,y_0)\in \cplx^2$.\\
Fix $f\in \cplx[X,Y], f\neq 0, e.g. f=Y-X^2$.
Then 
$$
\begin{aligned}
&\left\{ \text{maximal ideals in  }\cala_f=\cplx[X,f,1/f]\right\}\\
&\overset{bij}{\longleftrightarrow} \left\{\text{maximal ideals }\scm\in \cplx[X,Y] s.t. f\notin \scm\right\}\\
& \overset{bij}{\longleftrightarrow}\left\{(x,y)\in \cplx^2|f(x,y)\neq 0\right\}
\end{aligned}
$$
Then we know that the $\text{Spm}(\cala)\cong \cplx^2$ while $\text{Spm}(\cala_f)$ is bijective to the complement of zero loci of $f$.
\end{ex}

\begin{rmk}
The localization at an element has the functorial property, for $f,g\in\cala$
\[
\begin{tikzcd}
\cala\ar[r]\ar[rr,bend right]&\cala_f\ar[r, "\iota'"]&\cala_{fg}  
\end{tikzcd}
\]
where $\iota'$ means localize $\cala_f$ at the image of $g$ in $\cala_f$.
\end{rmk}

\begin{ex}
$\cala$ an integral domain, $\cala_f\subseteq \cala_{fg}$ ($\frac{a}{(f)^n}=\frac{a g^n}{(fg)^n}$). Then we know $Frac(\cala)=colim_{f\in \cala-\{0\}}\cala_f$. 

For any $\scp\in \text{Spec}(\cala_f)\subseteq\text{Spec}(\cala)$,

{\color{red}$\cala_f\inj k(\scp)$ as subring, $\frac{a}{f^n}\longmapsto \frac{a(\scp)}{f(\scp)^n}$.}

$\{f\in \cala:f\notin \scp\}=\{f\in \cala:f(\scp)\neq 0\}$, where $f(\scp)\in k(\scp)$ is the image of $f$, $f(\scp):=f\mod \scp$.
\end{ex}

\textbf{Aside:} $\cala$ is a local ring  $\Llrta\exists !\scm\in \text{Spec}(\cala)\Llrta \exists \text{ideal }\scm\text{ with }1+\scm\subseteq \cala^\times, \scm$ maximal,
$\Llrta \cala-\scm\subseteq \cala^\times$


\begin{prop}\ 
\begin{enumerate}[label=(\alph*)]
\item $\text{Spec}(\cala_\scp)\cong \{\scq\in \text{Spec}(\cala)|\scq\subseteq\scp\}$
\item For $\iota :\cala\lrta S^{-1}_{\scp}\cala$, $\cala_\scp$ is a local ring with maximal ideal $\scp_\scp:=\iota_*(\scp)=\scp\cala_\scp$,
\end{enumerate}
$\cala_\scp$ is called the \textbf{localization of $\cala$ at $\scp$}. $\iota_*$ is inclusion preserving.
\end{prop}
\begin{proof}
By Proposition~\ref{prop:iso_spec_localization},
$$
\text{Spec}\left(S^{-1}_{\scp}\cala\right)\overset{\iota_*}{\cong}\left\{\scq\in \text{Spec}(\cala)|\scq\cap S_\scp =\emptyset \ (\scq\subseteq \scp)\right\},
$$
which finishes the proof of part $(a)$. On the other hand,
$\iota_*$ is inclusion preserving,
$\Lrta$ every prime ideal in $\cala_\scp$ is contained in $\scp_\scp$. using this and the fact that any ideal is contained in some maximal ideal, we see that $\scp_\scp\subseteq \cala_\scp$ is the maximal ideal.
\end{proof}

\begin{ex}
$\scp=(p)\subseteq\intg=\cala$, then $\cala_\scp=\intg_{(\scp)}$ is local ring with maximal ideal $\scp_\scp$ generated by image of $\scp$. $\text{Spec}(\intg_{(\scp)})\cong \{\scq \in \text{Spec}(\intg)|\scq\subseteq \scp\}=\{(0),(p)\})$

For residue field $\intg_{(p)}/\scp_\scp\cong \intg/(p)$, this isomorphism is by the first part of the first prop of today's lecture. And in general
$$
\cala_\scp/\scp_\scp=k(\scp)
$$
\end{ex}


\begin{dfn}
A \textbf{germ at} $p$ is an equivalence class $[(U,f)]$ of pairs $(U,f)$, where $p\in U\subseteq \Omega$ and $f:U\lrta \cplx$ holomorphic. And $(U_1,f_1)\sim (U_2,f_2)$ iff $f_1=f_2$ on some open neighborhood of $p$ inside $U_1\cap U_2$
\end{dfn}
\begin{lemma}
$\Omega\subseteq \cplx$ open $\cala$ is the set of holomorphic germs $f:\Omega\lrta \cplx$. Fix $p\in\Omega$. and set $\scp=\{f\in \cala|f(p)=0\}$. Then $\cala$ is a local ring with maximal ideal $\scp$
\end{lemma}
\begin{proof}
\underline{Want}: $\cala-\scp\subseteq \cala^\times$\\

This is just a way of saying : if $f(p)\neq 0$, then there is an open neighborhood of $p$ on which $1/f$ is defined and holomorphic.
\end{proof}

\begin{ex}
$\cala=\cplx[X,Y],\scp=(Y)$, $\cala_\scp=\cplx(X)[Y]$\\
$$
\text{Spec}(\cala_\scp)\cong \left\{\scq\in \text{Spec}(\cala)|\scq\subseteq (Y)\right\}
$$
Then, the only choice of $\scq$ is just $(Y),(0)$. 
$\cala_\scp$ is a local ring with two primes, and residue field $\cplx(X)$.

$\cala=\cplx[X,Y],\scp=(X,Y)$\\
$$
\text{Spec}(\cala_\scp)\cong \left\{\scq\in \text{Spec}(\cala)|\scq\subseteq (X,Y)\right\}
$$
Then
$$
\text{Spec}(\cala_\scp)\cong \{(X,Y)\}\cup\{(f):0\neq f\in \cplx[X,Y] \text{ irreducible }, f(0,0)=0\}\cup\{(0)\}.
$$
The second set is just the set of plane curves passing through $0$.
\end{ex}

\subsection*{Localization of Module}
\begin{dfn}
$S\subseteq \cala$ and $M$ is an $\cala$-module. Then we define the \textbf{localization of module}
$$
(m,s)\in M\times S, (m,s)\sim (m',s')\Llrta \exists t\in S: tsm'=ts'm
$$
and we denote the equivalence class of $(m,s)$ by $\frac{m}{s}$, and we see that $S^{-1}M$ is in fact an $S^{-1}\cala$-module:
$$
\frac{a}{s}\cdot \frac{m}{t}=\frac{am}{st}
$$
\end{dfn}

\begin{lemma}
$S^{-1}\cala\otimes_{\cala}M\cong S^{-1}M$, where the map is $\frac{a}{s}\otimes m\mapsto \frac{am}{s}$
\end{lemma}
\begin{proof}
We can define the inverse
$$
\frac{1}{s}\otimes m \mapsfrom\frac{m}{s}
$$
and then check it is well-defined.
$\frac{n}{t}\sim\frac{m}{s}$ $\Lrta \exists u\in S , ut m=us n$. 
$$
\frac{1}{t}\otimes n=\frac{us}{ust}\otimes n=\frac{1}{ust}\otimes usn=\frac{1}{ust}\otimes utm=\frac{1}{s}\otimes m
$$
\end{proof}

Moreover, we can also define the localization of morphisms,
\begin{dfn}
Given $f:M\lrta N$ a morphism of $\cala$-module. $S^{-1}$. We define 
$$
\begin{aligned}
S^{-1}f:&S^{-1}M\lrta S^{-1}N\\
& \frac{m}{s}\longmapsto\frac{f(m)}{s}.
\end{aligned}
$$
It is a well-defined morphism of $S^{-1}\cala$-modules and it has the functorial property
$$
S^{-1}(f\circ g)=S^{-1}f\circ S^{-1}g
$$
e.g. 
$\scp\in \text{Spec}(\cala)$, then we have the localization $\cala_\scp$ and the localization of module: $M_\scp:=S^{-1}_\scp M\cong \cala_{\scp}\otimes_\cala M$.
\end{dfn}

Next time: we will focus other local properties i.e.properties of $M$ that depends only on  $M_\scp, \forall \scp\in \text{Spec}(\cala)$



\subsection{Lecture 9-1. Localization of Modules and Local Properties}
Recall that given a multiplicative closed set 
$S\subseteq \cala$, we can define  $S^{-1}\cala$.
Also we can define \textbf{localization of modules:} $S^{-1}M\cong S^{-1}\cala\otimes_\cala M$. The localization of module defines a functor $S^{-1}$:
$f:M\lrta N$, induces a morphism of $S^{-1}\cala$-modules $S^{-1}f:S^{-1}M\lrta S^{-1}N$ and $S^{-1}(f\circ g)=S^{-1}f\circ S^{-1}g$. Moreover,
\begin{lemma} $S^{-1}$ is an exact functor:
$$
M'\overset{f}{\lrta}M\overset{g}{\lrta}M''
$$
is exact, then so is 
$$
S^{-1}M\overset{S^{-1}f}{\lrta }S^{-1}M\overset{S^{-1}g}{\lrta } S^{-1}M''.
$$
\end{lemma}
\begin{proof}
$g\circ f=0\Lrta S^{-1}g\circ S^{-1}f=0$, then we have $\text{Ker}(S^{-1}g)\supseteq \text{Im}(S^{-1}f)$. For the converse inclusion, consider an element $\frac{x}{s}\in \text{Ker}(S^{-1}g), x\in M, s\in S$, $\Lrta S^{-1}g(\frac{x}{s})=\frac{g(x)}{s}=\frac{0}{1}$, $\Lrta \exists t\in S\ s.t. \ g(tx)=tg(x)=0$. $\text{Im}(f)=\text{Ker}(g)\Lrta\exists y: f(y)=tx$. Then we check that $\frac{x}{s}=(S^{-1}f)(\frac{y}{st})=\frac{f(y)}{st}=\frac{tx}{ts}=\frac{x}{s}$, which concludes the proof.
\end{proof}

\begin{cor}
$S^{-1}\cala$ is flat $\cala$-module.
\end{cor}
\begin{proof}
Let $0\lrta M'\lrta M$ be injective(exact). What we want is 
$$
0\lrta S^{-1}\cala\otimes_\cala M'\lrta S^{-1
}\cala\otimes _\cala M
$$
is exact because it is just 
$$
0\lrta S^{-1}M\lrta S^{-1}M
$$
\end{proof}

\begin{cor}\ 
\begin{enumerate}[label=(\roman*)]
    \item
Recall an exercise that $M\otimes_\cala N$ is flat if both $M$ and $N$ are flat $\cala$-module.
\item
$M$ is a flat $\cala$-module, $\calb$ is an $\cala$-algebra, then $M\otimes_\cala\calb$ is a flat $\calb$-module. Consider injective morphism of $\calb$-modules: $j: N_1\inj N_2$
$$
N_i\otimes_\calb (M\otimes_\cala\calb)=(N_i\otimes\calb)\otimes_\cala M\cong N_i\otimes_\cala M,
$$
$j$ is still injective when we consider it as an $\cala$-linear morphism then we conclude by $M$ is flat $\cala$-module.
\item
$M$ is a flat $\calb$-module and $\calb$ is a \textbf{flat} $\cala$-algebra, then $M$ is also a flat $\cala$-module. 
\item
 $S^{-1}\cala\otimes_\cala M=S^{-1}M$ is flat as an $\cala$-module if $M$ is flat $\cala$-module by (i). It is also flat as an $S^{-1}\cala$-module by (ii)
\end{enumerate}
\end{cor}

\begin{lemma}
$S^{-1} $ commutes with:
\begin{itemize}
\item finite sums 
\item finite intersections
\item Kernel ($\text{Ker}(S^{-1}M\lrta S^{-1}N)\cong S^{-1}(\text{Ker}(M\lrta N))$)
\item quotients 
\item tensor products ($S^{-1}(M\otimes_\cala N)\cong S^{-1} M\otimes_{S^{-1}\cala}S^{-1}N$)
\end{itemize} 
\begin{proof}
We just prove the last one of it by constructing the isomorphism explicitly,
$$
\begin{aligned}
&\frac{x\otimes_\cala y}{s}\longmapsto \frac{x}{s}\otimes_{S^{-1}\cala}\frac{y}{1}\sim \frac{x}{1}\otimes_{S^{-1}\cala}\frac{y}{s}\\
&\frac{x}{s}\otimes_{S^{-1}\cala}\frac{y}{t}\longmapsto \frac{x\otimes_\cala y}{s t} 
\end{aligned}
$$
\end{proof}
\end{lemma}




\subsection*{Local Properties}
$M$ is an $\cala$-module
\begin{lemma}\label{lem:zerpo_local}
\textbf{Being zero is a local property} i.e. the followings are equivalent:
\begin{enumerate}[label=(\alph*)]
\item $M=0$
\item $M_\scp=0,\forall \scp \text{ primes }$
\item $M_\scm=0,\forall \scm \text{ maximals}$
\end{enumerate}
\end{lemma}
\noindent\textbf{Claim 1:}
Let $x\in M$, then $x\neq 0\Longleftrightarrow \text{Ann}(x):=\{a\in\cala|ax=0\}\neq (1)$
\begin{proof}
$x\neq 0\Llrta 1\cdot x\neq 0$ $\Llrta 1\notin \text{Ann}(x)\Llrta \text{Ann}(x)\neq (1)$.
\end{proof}

\noindent\textbf{Calim 2:}
$\scm$ maximal $x\in M$.
Then $x\not\in \text{Ker}(M\lrta M_\scm)\Llrta \text{Ann}(x)\subseteq \scm$. 
\begin{proof}
$x\in \text{Ker}(M\lrta M_\scm)\Llrta \exists s\in \cala-\scm\text{ s.t. } \frac{x}{1}=\frac{0}{s}\Lrta\exists t\in \cala-\scm: tsx=0$ $\Llrta \text{Ann}(x)\not \subseteq \scm$.\\
\end{proof}
\begin{proof}
(of Lemma~\ref{lem:zerpo_local}).
It suffices to prove that (c)$\Lrta$(a), which amounts to show that $M\neq 0\Lrta \exists \scm\subset \cala $ s.t. $M_\scm\neq 0$\\
Let $0\neq x\in M,$ by Claim 1,\\
 $\Lrta \text{Ann}(x)\neq (1)\Lrta \exists maxmal\ ideal\ \scm\supseteq \text{Ann}(x)$. Then by Claim 2,\\
$x\notin \text{Ker}(M\lrta M_\scm)\Lrta M_\scm\neq 0$
\end{proof}
\begin{prop}\label{prop:local_inj_surj}
\textbf{(Injectivity/Surjectivity are local)}\\
$M$ is an $\cala$-module, then the following are equivalent.
\begin{enumerate}[label=(\alph*)]
\item $M\overset{\phi}{\lrta}N$ is injective/surjective
\item $M_\scp\overset{\phi_\scp}{\lrta}N_\scp$ is injective/surjective for all $\scp$ primes
\item $M_\scm\overset{\phi_\scm}{\lrta}N_\scm$ is injective/surjective for all $\scm$ maximals.
\end{enumerate}
\end{prop}
\begin{proof}
We prove the statements about surjectivity.\\
$M\lrta N\lrta K:=N/\phi(M)\lrta 0$ is exact.\\
$\Lrta M_\scp\lrta N_\scp\lrta K_\scp\lrta 0$ is exact $\forall \scp$.\\
$\phi$ is surjective $\llrta K=0$\\
$\Llrta K_\scp=0,\forall\scp$ by Lemma~\ref{lem:zerpo_local}\\
$\Llrta K_\scp=0\forall\scp$\\
$\Llrta \phi_\scp$ surjective $\forall\scp$ prime. We can replace the prime ideal by maximal ideal and prove it similarly.

For the statement of injectivity, we can analogously prove it by starting from the exact sequence
$0\lrta \text{Ker}(\phi)\lrta M\overset{\phi}{\lrta}N$.
\end{proof}
\begin{rmkt}
Applying the above local property to the defining isomorphism of free module $\cala^{(I)}\cong M$, we can prove that being free is a local property and being projective is also a local property. What's more, an $\cala$-module $M$ is projective iff $M_\scm$ is free $\cala_\scm$-module for all maximal ideals.
\end{rmkt}
\begin{prop}
\textbf{(Flatness is local)}\\
$M$ is an $\cala$-module, then the followings are equivalent.
\begin{enumerate}[label=(\alph*)]
\item $\cala$-module $M$ is flat
\item $\cala_\scp$-module $M_\scp$ is flat $\forall \scp$ prime
\item $\cala_\scm$-module $M_\scm$ is flat $\forall \scm$ maximal ideals.
\end{enumerate}
\end{prop}
\begin{proof}We prove e.g. 
(a)$\Llrta$(c): Suppose $N\inj P$.

\underline{Want:} $[N\otimes M\inj P\otimes M]\Llrta [(N\otimes M)_\scm=(N_\scm\otimes_{\cala_\scm}M_\scm)\inj P_\scm\otimes_{\cala_\scm} M_\scm= (P\otimes M)_\scm\forall \scm$ ]\\
$\Longleftarrow N_\scm\inj P_\scm\forall \scm$\\
$\Llrta N\inj P$ by Proposition~\ref{prop:local_inj_surj}.
\end{proof}
\section{Noetherian Rings and Nullstellensatz}
\subsection{Lecture 9-2. Chain Conditions and Noetherian Rings}
\begin{dfn}
\textbf{(Lemma)} The following characterizations are equivalent:
\begin{enumerate}[label=(\alph*)]
\item $\cala$ satisfies the \textbf{ascending chain condition on ideals (ACC)} (All the sequence $\sca_1\subseteq \sca_2\subseteq ...$ stabilizes, i.e. $\exists n_0$ s.t. $\sca_n=\sca_{n_0} \forall n\geq 0$)
\item Every ideal of $\cala$ is finitely generated.
\item $\{\text{ideals in $\cala$}\}$ satisfies the \textbf{maximal property}: i.e. Every subset contains a maximal element. That is : For any nonempty collection $S$ of ideals in $\cala$, $\exists \sca\in S$ s.t. $\forall \scb\in S\Lrta \scb\not \supset \sca$
\end{enumerate}
Then, $\cala$ is called \textbf{Noetherian}. Notices that we don't restrict to proper ideals in the above definition.
\end{dfn}
\begin{proof}\ \\
(a)$\Lrta$(b). Let $\sca$ be an ideal. we may assume that $\sca$ is \textbf{NOT} finitely generated. Inductively construct $x_1, x_2,x_3...\in \sca$ such that $(x_1)\neq 0$ and $\sca\supsetneqq(x_1,x_2)\supsetneqq(x_1)$ an also $\sca\supsetneqq(x_1,x_2,x_3)\supsetneqq(x_1,x_2)$, but then this sequence contradict the \textbf{ACC}.

(a)$\Lrta$(c). Let $\emptyset \neq S\subseteq \{\text{ideals in }\cala\}$. If $S$ violates the maximal property, then start from arbitrary ideal $\sca_1$, we can find $\sca_1\subsetneq \sca_2\in S$. Similarly, we can find $\sca_{j+1}\supsetneq \sca_j,\forall j\in\intg_{\geq 0}$ by the countable choice axiom. Then the ACC fails.

(c)$\Lrta $(a). If ACC fails, $\exists \sca_1\subsetneq \sca_2\subsetneq ...$ Take $S:=\{\sca_1,\sca_2,\sca_3...\}$. Then $S$ violates maximal property.

(b)$\Lrta$(a). Let $\sca_1\subseteq\sca_2\subseteq ...$ \underline{Want:}show that $\exists n_0,\sca_n=\sca_{n_0}\forall n\geq n_0$.
Define $\sca:=\cup_n \sca_n$. We know that every ideal of $\cala$ is finitely generated. Then $\sca$ is also finitely generated by assumption (b). Then Assume it to be finitely generated by $r$ elements $\{x_1,...,x_r\}$, with $x_j\in\sca_{n_j}$. Choose $n_0=\text{max}\{n_1,...,n_r\}$, then we have $x_1,...,x_r\in \sca_{n_0}\Lrta \sca=\sca_{n_0}$. $\Lrta \sca_n=\sca_{n_0},\forall n\geq n_0$.
\end{proof}

\begin{dfn}\textbf{(Lemma)}\\
$M$ is an $\cala$-module. The following characterizations are equivalent:
\begin{enumerate}[label=(\alph*)]
\item $M$ has \textbf{ACC} on submodules
\item Every submodule of $M$ is finitely generated (In particular, $M$ is finitely generated)
\item $M$ has the \textbf{maximal property} on submodules
\end{enumerate}
Then, we call $M$ a \textbf{Noetherian $\cala$-module}.
\end{dfn}
\begin{proof}
The proof is just identical.
\end{proof}

Note that $\cala$ Noetherian ring $\Llrta $ $\cala$ is a Noetherian $\cala$-module.

\begin{lemma}\label{lem:SES_Noetherian}
Let $0\lrta M'\lrta M\lrta M''\lrta 0$ be a short exact sequence of $\cala$-modules. Then $M$ is Noetherian $\Llrta $ both $M', M''$ Noetherian.
\end{lemma}
\begin{proof}
``$\Llta$''. Use ACC. Let $N_1\subseteq N_2\subseteq ...$ be submodules of $M$. \underline{Want:}  show that $\exists n_0 :(n\geq n_0)\Lrta N_n=N_{n_0}$.
Consider $N''_j:=$ Image of $N_j$ in $M''$. $ N_1''\subseteq N_2''\subseteq ...$ By ACC of $M''$, $N''_{n_0}=N''_{n}\forall n\geq n_0$. Do the same for $N'_j:=M'\cap N_j$ ($M'\inj M$)\\
Need: if $N_i\subseteq N_j\subseteq M$ and $N_i''=N''_j, N'_i=N'_j$, then $N_i=N_j$. (Five Lemma)
\[
\begin{tikzcd}
0\ar[r] & N_i'\ar[r]\ar[d,equal] & N_i\ar[r]\ar[d] & N_i''\ar[r]\ar[d,equal] & 0\\
0\ar[r] & N_j'\ar[r] & N_j\ar[r] & N_j''\ar[r] & 0
\end{tikzcd}
\]

For the ``$\Lrta$'' direction, we can use the definition of Noetherian module to prove directly that \textbf{Any submodule of a Noetherian module is Noetherian} and \textbf{Any quotient module of Noetherian module is Noetherian}.
\end{proof}

\begin{cor}\label{cor:finitely_generated_module_over_Noetherian_ring}
In particular, any finitely generated module $M$ over a Noetherian ring $\cala$ is Noetherian $\cala$-module.
\begin{proof}Suppose $M$ is generated by $\{x_1,...,x_n\}$
We always have a SES
$$
0\lrta Ker(\varphi)\lrta \cala^n\overset{\varphi}{\lrta} M\lrta 0,
$$
then apply the above lemma.
\end{proof}
\end{cor}

\subsection{Lecture 10. Hilbert Basis Theorem}
In general, any finitely generated module over an Noetherian ring is Noetherian.

\begin{thm}\label{thm:Hilbert_Basis}(Hilbert basis theorem)
$\cala$ Noetherian $\Lrta $ the polynomial ring $\cala[X]$ is Noetherian.
\end{thm}

\begin{proof}
Let $\sca\subseteq \cala[X]$. \underline{Want:} show $\sca$ finitely generated. 
$$
\begin{aligned}
\sca' &=\{\text{Leading coefficients of $\sca$}\}\\
&= \cup_{n\geq 0}\{a\in\cala: \exists a X^n+...\in \sca\}
\end{aligned}
$$
Because $\cala$ is  Noetherian, $\sca'$ is finitely generated. $\Lrta\sca'=(a_1,...,a_r),a_i\in \sca'$ $\Lrta\exists f_1,...,f_r\in \sca: f_j=a_j X^{n_j}+...$.


Set $N:=max(n_1,..,n_r)$ and we construct $\cala$-module $M:=\oplus^N_{j=0}\cala X^j\subseteq \cala[X]$. $M\cap \sca$ is finitely generated because $M\cong \cala^N$ as $\cala$-module, and $\cala$ is a Noetherian $\cala$-module $\Lrta$ $\cala^n$ is Noetherian $\cala$-module:
$$
0\lrta \cala\lrta \cala^n\lrta \cala^{n-1}\lrta 0
$$
Using the above exact sequence, we can apply Lemma~\ref{lem:SES_Noetherian} and induct on $n$.

And finally, we claim that
$$
\sca=(f_1,...,f_r)+M\cap\sca
$$
The $\supseteq$ part is obvious.

Let $f\in \sca$ with $f=aX^n+...$, where $n\geq (n_1,...,n_r)$. Then $a\in\sca'$ by definition
$$
\begin{aligned}
\sca' &=(a_1,...,a_r)\\
&\Lrta a=c_1 a_1+...+c_r a_r\text{ with } c_1,...,c_r\in \cala\\
&\Lrta \exists f_1=a_1 X^{n_1}+,..., f_r=a_r X^{n_r}\in\sca\\
&\text{know } f-(c_1 X^{n-n_1}f_1+...+c_r x^{n-n_r}f_r)=(a-\sum c_j a_j)x^n+...\\
&=0+ \text{some terms in $\sca$ of degree less than $n-1$}
\end{aligned}
$$
Then we can induct from $n,n-1,...$ to $N$, we get that $f\in (f_1,...,f_r)+M\cap\sca$
$$
\begin{aligned}
&\sca\subseteq (f_1,...,f_r)+M\cap\sca\subseteq \sca\\
&\Lrta\sca=(f_1,...,f_r)+M\cap \sca
\end{aligned},
$$
hence we know $\sca$ is finitely generated.
\end{proof}
\begin{rmkt}
The converse of Hilbert basis theorem is also true: $\cala$ Noetherian $\Llrta\cala[X]$ is Noetherian. The converse can be easily proved by Lemma~\ref{lem:homomorphic_image_Noetherian}.
\end{rmkt}

\begin{rmkt}
With some modification, we can prove that the formal prower series $\cala[[X]]$ is Noetherian if $\cala$ is Noetherian. The basic idea is to replace the leading term coefficients with coefficients of least degree term, see for example: \href{https://faculty.math.illinois.edu/~r-ash/Algebra/Chapter8.pdf}{this online text}.
\end{rmkt}

\textbf{Applications}:
\begin{itemize}
    \item By induction on $n$, we can prove that $\cala[X_1,...,X_n]$ is also Noetherian.
    \item 
    Any finitely generated $\cala$-algebra $\cala[x_1,...,x_r]=\cala[X_1,...,X_r]/\sca$ Noetherian if $\cala $ is Noetherian. 
    \item 
    Recall that  a variety $V\subseteq \cplx^d$ is a subset defined by polynomial equations, i.e.
    $V=V(S)$ for some $S\subseteq \cplx[X_1,...,X_d]=:\cala$. $V(S)=\{x\in \cplx^d:f(x)=0\forall f\in S\}$.
    Note $V(S)=V(\lgl S\rgl)$, where $\lgl S\rgl$ is the ideal generated by $S$. Hilbert basis theorem $\Lrta$ $\forall \text{varieties } V\exists \text{ finite } S\subseteq \cplx[x_1,...,x_d]$ such that $V=V(S)$. \textbf{Any set of polynomial equations is the same as some finite system.}
    \begin{proof}
    Given $S$, we have $\sca=\lgl S\rgl\subseteq\cplx[X_1,...,X_d]$. By Hilbert basis theorem~\ref{thm:Hilbert_Basis}, $\cplx[X_1,...,X_d] $ Noetherian $\Lrta\sca$ finitely generated $\Llrta\sca=(f_1,...,f_r)$
    \end{proof}
\end{itemize}
\begin{ex}
Any field is Noetherian in that it have only two ideals $(0) $ and itself. A field  is finitely generated as an ideal in it self with the generating set $\{1\}$.

Any principal ideal domain is Noetherian, because all the ideals are finitely generated by definition.
\end{ex}
\begin{nex}
$\cala=\cplx[x_1,x_2,....]$ is not Noetherian: $\scm:=(x_1,x_2,...)$ is Not finitely generated. If $S\subseteq \scm$ is finite, we may find some $x_n$ not occurring in any element of $S$: $\Lrta x_n\notin \lgl S\rgl, x_n\in \scm$.

The ring of algebraic integers in not Noetherian, for example, it contains an infinite ascending chain of principal ideals: $(2)\subsetneq (2^{1/2})\subsetneq (2^{1/3})\subsetneq (2^{1/4})...$
\end{nex}
\begin{lemma}\label{lem:homomorphic_image_Noetherian}
$\cala$ Noetherian
$\Lrta$ any homomorphic image of $\cala$ is Noetherian:
\end{lemma}
\begin{proof}
The image if of the form $\cala/\sca$ for some $\sca\subseteq \cala$.
$0\lrta \sca\lrta \cala\lrta \cala/\sca\lrta 0$. Because there is a one to one inclusion preserving  correspondence between the \{ideals in $\cala$ that contains $\sca$\} and \{ ideals in $\cala/\sca$\}. The maximal condition also holds in $\cala/\sca$.
\end{proof}
\begin{lemma}
Localization of  Noetherian ring are Noetherian. $S\subseteq \cala$ is multiplicative set $S^{-1}\cala$, e.g. $\cala_\scp,\cala_f$ are Noetherian if $\cala$ is Noetherian.
\end{lemma}
\begin{proof}
Remember that $S^{-1}\cala$ is not a homomorphic image of $\cala$. By Proposition~\ref{prop:iso_spec_localization}, there is a one to one inclusion preserving correspondence between \{ideals in $\cala$ which does not intersect $S$\} and \{ideals in $S^{-1}\cala$\}. Then the maximal property is also inherited to $S^{-1}\cala$.
\end{proof}
\begin{rmkt}
See this \href{https://math.stackexchange.com/questions/110735/why-is-the-localization-of-a-commutative-noetherian-ring-still-noetherian}{StackExchange Answer} for a discussion of the relation between the submodule of $M$ and submodule of $S^{-1}M$. We know that $M$ is Noetherian $\Lrta S^{-1}M$ is Noetherian but not the reverse. 
In other words, being Noetherian module is not local properties. 
Also in the special case of Noetherian ring. Notices that ``the localizations of $\cala$ is Noetherian at every primes does not imply ``that $\cala$ it self is Noetherian  ''. See for example this \href{https://math.stackexchange.com/questions/73421/a-non-noetherian-ring-with-all-localizations-noetherian}{StackExchange answer}. In other words, being Noetherian ring is not a local property.
\end{rmkt}

\begin{dfn}
An \textbf{$\cala$-algebra} is a ring $\calb$ together with a homomorphism $f:\cala\lrta \calb$.
\end{dfn}

\begin{ex}
$\cala[X_1,...,X_n]$ and $\cala[x_1,...,x_n]$ are an $\cala$-algebra, with the obvious choice of $f$.
\end{ex}
\begin{ex}

\end{ex}Any ring is a $\intg$-algebra:
$$
\begin{aligned}
&\intg \lrta \calb\\
&n\longmapsto n \cdot 1_\calb
\end{aligned}
$$
\begin{ex}
If $\cala$ is a field $\bbf$, any ring homomorphism between $\bbf$ and a nonzero ring $\calb$ is injective, $\bbf\inj \calb$. Thus an $\bbf$-algebra $\calb$ is ``the same as'' a ring $\calb$ that contains $\bbf$ as a subfield.
\end{ex}

\begin{ex}
Let $\calb$ be any field of characteristic $p$, if $p=0$, then $\calb$ is a $\ratl$-algebra, if $p>0$, $\calb$ is an $\bbf_p$-algebra.
\end{ex}

\begin{dfn}
We say that an $\cala$-algebra $\calb$ if a \textbf{finitely generated $\cala$-algebra} if there exists $x_1,...,x_n\in \calb$ s.t. $\calb$ is $\cala[x_1,..,x_n]$. 

Given two $\cala$-algebra $\cala\overset{f}{\lrta}\calb$ and $\cala\overset{g}{\lrta}\calc$. A \textbf{morphism of $\cala$-algebra} is defined to be a ring homomorphism that commutes with $f,g$

\[
\begin{tikzcd}
\calb\ar[r, "t"]&\calc\\
\cala \ar[u, "f"]\ar[ur,swap, "g"] 
\end{tikzcd}
\] 
\end{dfn}

\begin{prop}
By the Hilbert basis theorem~\ref{thm:Hilbert_Basis}, we know if $\cala$ is Noetherian, the finitely generated $\cala$-algebra $\calb$ is Noetherian.
\begin{proof}
$\calb$ is a finitely generated $\cala$-algebra\\
$$
\begin{aligned}
\Llrta &\exists n\geq 0
& \exists h:\cala[X_1,...,X_n]\lrta \calb, h\text{ surjective}
\end{aligned}
$$
then we have the derivation: $\cala$ Noetherian $\Lrta \cala[X_1,...,X_n]$ Noetherian, it surjectively maps to $\calb$, $\calb$ is a homomorphism image of a Noetherian ring. By Lemma~\ref{lem:homomorphic_image_Noetherian} we have $\calb$ is Noetherian.
\end{proof}
\end{prop}

\begin{dfn} Let $\calb$ be an $\cala$-algebra.
We say that $\calb$ is a\textbf{ finite $\cala$-algebra} if it is finitely generated as $\cala$-module. 
 \end{dfn}

\begin{rmk}
Equivalently, we say $\calb$ is finite $\cala$-algebra iff there exists a surjective $\cala$-module homomorphism from $\cala^n$ to $\calb$. In general, $\calb$ is finite $\cala$-algebra implies $\calb$ is a finitely generated $\cala$-algebra.

In general, we say $\calb$ is \textbf{finite over} $\cala$ iff there exists $x_1,...,x_n\in\calb$ s.t., $\calb=\{\cala\text{-linear combinations of $x_1,..,x_n$}\}$. 

Also, we say $\calb$ is \textbf{finitely generated over} $\cala$ iff there exists $x_1,...,x_n\in\calb$ s.t., $\calb=\{\text{polynomials in $x_1,...,x_n$ with coefficients in $\cala$}\}$.
\end{rmk}

\begin{ex} Assume
$\cala:=\intg$: 
\begin{equation*}
\begin{array}{ |c |c| c| }
\hline
\mathcal{B}  & finite & fintely\ generated\\
\hline
\mathbb{Z}  & \checkmark & \checkmark    \\
\hline
\mathbb{Z}\left[\frac{1}{2}\right] & \text{\xmark} & \checkmark\\
\hline
\mathbb{Q}  & \text{\xmark} & \text{\xmark}\\
\hline
\frac{1}{2}\mathbb{Z}  & \checkmark & N/A\\
\hline
\end{array}
\end{equation*}
The last row is somehow not a good example because $\frac{1}{2}\intg$ is not a ring.
\end{ex}

\begin{thm}\label{thm:finite_field_extension}(Zariski's Lemma)
Assume $K$a field, $K\subseteq  L$, where $ L$ is also a field. Assume $ L$ is a finitely generated $K$-algebra,  then $ L$ is a finite $K$-algebra which is equivalent to $ L/K$ being a finite algebraic field extension.
\end{thm}

\begin{cor}(Hilbert Nullstellensatz weak form)
The maximal ideal of $\cala=\cplx[X_1,...,X_d]$ are all of the form $\scm_x=(X_1-x_1,...,X_d-x_d)$ for some $x\in\cplx^d$.
\end{cor}
\begin{proof}
Theorem~\ref{thm:finite_field_extension} $\Lrta$ Cor, Let $\scm\subseteq \cala$ be any maximal ideal, then $ L=\cala/\scm$ is a field.
 \[
\begin{tikzcd}
\cplx\ar[r]\ar[rr,bend right,"j"]&\cplx[X_1,...,X_d]=\cala\ar[r,two heads,"q"]& L=\cala/\scm  
\end{tikzcd}
\] 
Note: $ L$ is a finitely generated $\cplx$-algebra, generated by $q(X_1),...,q(X_d)$
$$
\begin{aligned}
\text{Theorem~\ref{thm:finite_field_extension}}&\Lrta  L/j(\cplx)\text{ is finite field extension}\\
 & \Lrta
 L\cong \cplx \text{($\cplx$ algebraically closed)}
\end{aligned}
$$
Set $x:=(j^{-1}(q(X_1)),...,j^{-1}(q(X_d)))\in \cplx^d$. Check $\scm=\scm_x$.
We know $j$ is surjective because $q$ is, and $j$ is always injective because $\cplx$ is a field. Suppose $P\in \scm\Lrta q(P)=0\Lrta j^{-1}(P(q(X)))=0\Lrta P(j^{-1}(q(X)))=P(x)=0$, hence $\scm_x\in \scm$, but we already know $\scm_x$ is maximal, then $\scm=\scm_x$. The above proof also works for all algebraically closed fields.
\end{proof}

\begin{cor}\label{cor:rational_functions_not_fin.gen.alg}
Let $d\geq 1$. Then $\cplx(X_1,...,X_d)$ is \textbf{NOT} a finitely generated $\cplx$-algebra.
\end{cor}
\begin{proof}
$K=\cplx,  L=\cplx(X_1,..,X_d)$. Obviously $\cplx(X_1,...,X_d)$ can not be a finite $\cplx$-algebra, for example $\{X_1^n\}$ are $\cplx$-linear independent. Then $ L/K$ not finite field extension $\Lrta  L$ is NOT finitely generated $\cplx$-algebra (by Theorem~\ref{thm:finite_field_extension}).

This proof also works when $\cplx$ replaced with any field $K$.

Alternatively, we can also prove this directly. Suppose $K(X_1,...,X_d)$ is finitely generated by $f_1,..,f_n\in K(X_1,..,X_d)$, each $f_i=\frac{g_i}{h_i}\in K[X_1,...,X_d]$. Set $u:=1+X_1 h_1\cdot\cdot\cdot h_n$
$\Lrta 1/u\notin K[f_1,..,f_n]$ because denominator is coprime to the denominators of the $f_j$. We get the contradiction.
\end{proof}

Then we come back to the proof of the Theorem~\ref{thm:finite_field_extension}
\begin{proof}
Any $ L$ generated by $x_1,...,x_n$. Any $ L/K$ NOT finite. Then the  transcendence degree $d$ is larger than $1$
$\Llrta$ after reordering $x_1,...,x_n,$ $x_1,...,x_d$ algebraically independent over $K$ and $x_{d+1},...,x_n$ is algebraic over $K(x_1,...,x_d)$. $x_{d+1},...,x_n$ is algebraic over $K(x_1,..,x_d)$ which means $ L$ is algebraic field extension over $K(x_1,...,x_d)$. Also, $x_1,...,x_d$ are transcendental over $K$ $\Lrta$ $K[x_1,...,x_d]\cong K[X_1,...,X_d]$ where the capital $X_i$ means indeterminates, hence $K(x_1,...,x_d)\cong K(X_1,...,X_d)$. But by the alternative proof (not dependent on this Theorem) of Corollary~\ref{cor:rational_functions_not_fin.gen.alg}, we know  $K(x_1,...,x_d)\cong K(X_1,...,X_d)$ is not finitely generated $K$-algebra. The rest part of the proof is postponed until the next lecture.
\end{proof}

\subsection{Lecture 11. Nullstellensatz}

Recall, $F$ a field. $V$ a vector space over $F$. $S\subseteq F$ is linear independent. $\forall $ distinct $\{s_1,...,s_n\}\subseteq S$, $\forall c_1,...,c_n\in F$, $c_1 s_1+...+c_n s_n=0\Lrta c_i=0$

\begin{thm}
$S\subseteq V,$ vector space over $F$. 
\begin{enumerate}[label=(\alph*)]
\item Suppose $S$ is linear independent. Then $S$ is \textbf{maximal}$\Llrta$ $S$ spans $V$.
\item Suppose $\{v_1,...,v_n\}\subseteq V$ is maximal linear independent $=:$ ``basis'', Suppose $\{w_1,...,w_m\}\subseteq V$ linearly independent. Then $m\leq n$
\item  Any two bases have the same cardinality(= the dimension of $V$).
\item Every vector spaces has a basis.
\item Every linearly independent subset $S\subseteq V$ extends to a basis.
\item If $S\subseteq V$ spans $V$, then $\exists $ basis $T\subseteq S$
\end{enumerate}
\end{thm}

Then what will happen when we replace ``linearly independent '' by ``algebraic independent''?
Now let $E/F$ be a field extension call $S\subseteq E$ \textbf{algebraically independent over $F$}, if $\forall $ distinct $\{s_1,...,s_n\}\subseteq S$, $\forall p\in F[X_1,...,X_n]$ $p(s_1,...,s_n)=0\Lrta p=0$.

\begin{thm}\label{thm:field_extension}
$E/F$ field extension. 
\begin{enumerate}[label=(\alph*)]
\item Suppose $S\subseteq E$ is algebraic independent. Then $S$ is maximal $\Llrta E/F(S)$ is an algebraic field extension (Union of finite field extension).
\item If $\{v_1,..,v_n\}\subseteq E$(algebraic independent maximal)$=:$``\textbf{transcendence basis}'' and $\{w_1,...,w_m\}\subseteq E$ algebraic independent then $m\leq n$
\item Any two transcendence bases have the same cardinality(Then we can define the transcendence degree of $E/F$, denote it by $\text{tr.deg}(E/F)$)
\item Every $E/F$ has a transcendence basis.
\item Any algebraic independent $S\subseteq E$ extends to a transcendence basis.
\item If $S\subseteq E$ and $E/F(S)$ is algebraic, then exists transcendence basis $T$ of $E/F$ and $T\subseteq S$
\end{enumerate}
\end{thm}
\begin{proof}
\begin{enumerate}[label=(\alph*)]
\item $``\Lrta$'' Assume $S$ maximal algebraic independent. \underline{Want}: $E/F(S)$ is algebraic. Let $\alpha\in E$, want: $F(\alpha,S)/F(S)$ is finite. If $\alpha\in S$, then done. If not, $S\cup \{\alpha\}$ is not algebraic independent. So we can find $s_1,...,s_n\in S$ and a nontrivial polynomial relation between $\alpha,s_1,...,s_n$. This relation must involve $\alpha$. Then $\exists m\geq 1$, $p_0,...,p_m\in F[X_1,...,X_n]$ s.t $\alpha^m p_m(s_1,...,s_n)+...+\alpha p_1(s_1,...,s_n)+p_0(s_1,...,s_n)=0$ with $p_m\neq 0$ $\Lrta [F(\alpha, s_1,...,s_n):F(s_1,...,s_n)]\leq m\Lrta \alpha$ is algebraic over $F(S)$.
 
 ``$\Llta$'', If $E/F(S)$ is algebraic, \underline{Want:} $S$ maximal. Indeed, suppose otherwise $\exists \alpha\in E, \alpha\notin S$ s.t. $S\cup \{\alpha\}$ is algebraic independent. Then $\alpha$ is algebraic over $F(S)$, by assumption. $\exists m\geq 1$
 $$
\alpha^m+\frac{p_{m-1}(s_1,...,s_n)}{q_{m-1}(s_1,..,s_n)}\alpha^{m-1}+...=0
 $$
 for some $s_1,...,s_n\in S, p_i,q_i\in F[X_1,...,X_n]$ Multiply the denominators in the above equation, we get a nontrivial polynomial relation involving $s_1,...,s_m,\alpha$. Contrary to the assumed algebraic independence of $S\cup\{\alpha\}$
\end{enumerate}
\end{proof}

\begin{ex}\ \\
$\text{tr.deg}(\overline{\ratl}/{\ratl})=0$\\
$\text{tr.deg}(\cplx/\ratl)=\infty$\\
$\text{tr.deg}(F(t_1,...,t_n)/F)=n$\\
If $E/F(t_1,...,t_n)$ is algebraic, then $\text{tr.deg}(E/F)$ is $n$

$\text{tr.deg}(F/F)=0\Llrta (E/F)$ is algebraic.
\end{ex}

And then we resume our proof of Zariski's Lemma (Theorem~\ref{thm:finite_field_extension}) in last lecture. Give a field extension $L/K$ such that $L$ is finitely generated as $K$-algebra, then $L/K$ is finite.
\begin{proof}(of Theorem~\ref{thm:finite_field_extension})
Write $L=K[ x_1,...,x_n]$ and denote
$r:=\text{tr.deg}(L/K). $ The  conclusion that $L$ is a finite algebraic field extension is equivalent to $ r=0$. Suppose not. Then $r\geq 1$. By part $(f)$ of the Theorem~\ref{thm:field_extension} that after relabeling,
$\{x_1,...,x_r\}$ is a transcendence basis of $L/K$. Each $x_{r+1},...,x_n$ is algebraic over $K(x_1,..,x_r)=:A$ $\Lrta L/A$ is finite field extension, i.e., $L$ is a finite dimensional $A$-vector space. Now we know
\[\underbrace{
      \mathrlap{\overbrace{\phantom{K\inj A:=K(x_1,}}^{\text{(?)}}}
      K\inj A:=K(x_1,..
      \mathrlap{\overbrace{\phantom{...,x_r)\inj  }}^{\text{f.g. $A$-vec.sp}}}
      .,x_r) \inj L
      }_{\text{f.g. $K$-algebra}}.
\]
\underline{Want}: $A$ is a finitely generated $K$-algebra.

Then we incorporate the following lemma by Artin-Tate.
\begin{lemma}\label{lem:Artin_Tate}
Let $\cala\subseteq\calb\subseteq\calc$ be rings s.t. Assume $\cala$ is Noetherian. $\calc$ is finitely generated as $\cala$-algebra and $\calc$ is also finitely generated $\calb$-module. Then $\calb$ is a finitely generated $\cala$-algebra. In other word, we have
\[\underbrace{
      \mathrlap{\overbrace{\phantom{\cala \lrta b }}^{\text{(*)}}}
      \cala\lrta 
      \mathrlap{\overbrace{\phantom{\calb\lrta   }}^{\text{f.g. $\calb$-module}}}
       \calb\lrta \calc
      }_{\text{f.g. $\cala$-algebra}},
\]
and $(*)$ is indeed a finitely generated $\cala$-algebra.


\end{lemma}
\begin{proof}
(Of Lemma~\ref{lem:Artin_Tate}) $\calc=\lgl y_1,...,y_m\rgl_{\calb-mod}$ and $\calc=\lgl x_1,...,x_n\rgl_{\cala-alg}$ write $x_i=\sum_j b_{ij} y_j$ for some $b_{ij}\in \calb$. $y_i\cdot y_j=\sum_k b_{ijk}y_k$. Define $\calb_0:=\cala[\{b_{ij}\}\cup \{b_{ijk}\}]\subseteq \calb$. We know $\calb_0$ is a finitely generated $\cala$-algebra, by Hilbert basis theorem~\ref{thm:Hilbert_Basis}, $\calb_0$ is Noetherian. On the other hand, we know
$$
\calc=\{\text{polynomials in } \{x_{j}\}\text{ with coefficients in }\cala\}
$$ 
and by the above substitution,
$$
\calc=\{\text{linear combinations of}\text{ $y_i$ with coefficients in $\calb_0$}\}$$
 $\Lrta \calc$ is a finitely generated $\calb_0$-module.\\
$\Lrta \calc$ is a Noetherian $\calb_0$-module.\\
$\Lrta$ the $\calb_0$-submodule $\calb\subseteq \calc$ is finitely generated.\\
$\Lrta\calb$ is finitely generated $\cala$-algebra (Still by the substitution).
\end{proof}
But by the alternative proof (not dependent on Theorem~\ref{thm:finite_field_extension}) of Corollary~\ref{cor:rational_functions_not_fin.gen.alg}, we know  $K(x_1,...,x_d)\cong K(X_1,...,X_d)$ is not finitely generated $K$-algebra, which contradicts the above lemma.
\end{proof}

We can derive the  Nullstellensatz form Zariski's Lemma. 
\begin{cor}\label{cor:Nullstellensatz}(Hilbert's Nullstellensatz)
$$
\text{rad}(\sca)=I(V(\sca)),
$$ 
where $K=\overline{K}$ is an algebraically closed field. $\sca\subseteq K[X_1,...,X_d]=\cala$. $V(\sca):\{x\in K^d, f(x)=0\forall f\in \sca\}$. $I(S)=\{f\in \cala:f(x)=0\forall x\in S\}$ and $\text{rad}(\sca:=\{f\in \cala:f^n\in \sca \text{ for some } n\}$
\end{cor}
\begin{proof}
$\text{rad}(\sca)\subseteq I(V(\sca))$, $f\in \text{rad}(\sca)\Lrta f^n\in \sca\Lrta f^n|_{V(\sca)=0}$, and $K$ is an integral domain $\Lrta f|_{V(\sca)}=0$$\Lrta f\in I(V(\sca))$. 

For the converse inclusion recall that $\text{rad}(\sca)=\cap_{\scp\supseteq \sca, prime}\scp$. suppose $f\notin  \text{rad}(\sca) $. \underline{Want}:$f\notin I(V(\sca))$. Choose $\scp\supseteq \sca,\scp \not \ni f$. Then $0\neq \overline{f}\in \cala/\scp$. $\Lrta (\cala/\scp)_{\overline{f}}=(\cala/\scp)[1/\overline{f}]\neq 0$. Choose a maximal ideal $\scm\subseteq (\cala/\scp)_{\overline{f}}=:\calb$. Set $L:=\calb/\scm$ a field, $L$ is finitely generated $K$-algebra. $\Lrta L/K $ is finite $\Lrta L=K$ because $\overline{K}=K$. Set $x:=(x_1,...,x_d)$, $x_j:=$ image of $X_j$ in $L$.

 Check that $f(x)\neq 0\text{ and } x\in V(\sca)\Lrta f\notin I(V(\sca))$. 

 \[
\begin{tikzcd}
K[X_1,...,X_d]=\cala\ar[r,"\pi"]\ar[rrr,bend right,"j"]&\cala/\scp\ar[r,"\iota"]&\calb=(\cala/\scp)[1/\overline{f}]\ar[r,"\pi'"] & L=\calb/\scm=K  
\end{tikzcd}
\]

We denote $j:\cala\lrta L$.
Indeed, $x\in V(\sca)$ because $\forall g\in \sca$ $g(x)=g(j(X))=j(g(X))=\pi'\circ\iota\circ\pi(g)=0$. And $f(x)=j(f)=\pi'\circ\iota\circ\pi(f)=\pi'\circ\iota (\overline{f})\neq 0$ because $\iota(\overline{f})$ is a unit in $\calb$ thus $\iota(\overline{f})\notin\scm$.
\end{proof}

\section{Primary Decomposition}
Consider $\alpha\in \cala$ a PID. We may write uniquely $\alpha=\epsilon (p_1)^{n_1}\cdot \cdot\cdot (p_k)^{n_k}$ where $\epsilon$ unit and $p_j$ distinct  primes and $(\alpha)=(p_1^{n_1})\cap...\cap(p_k^{n_k})$ We call this the primary decomposition of $(\alpha)$. What happens to a general ring?


\begin{dfn}$\cala$ is a general ring. 
An ideal $\scq\subseteq\cala$ is \textbf{primary} iff every zero-divisor  in $\cala/\scq$ is nilpotent.
\end{dfn}
\underline{Recall} $\scp\subseteq\cala$ is prime iff the only zero-divisor  in $\cala/\scp$ is $0$. We know
$$
\text{prime}\Lrta\text{ primary}
$$
Equivalently, we can define: an ideal $\scq$ is primary if, whenever $xy\in\scq$, we have either $x\in\scq$ or $y\in \text{rad}(\scq)$. This two definitions are equivalent
\begin{proof}
``$\Lrta$'': $xy\in\scq\Lrta \overline{xy}=\overline{x}\ \overline{y}=0\in \cala/\scq $. Then both $\overline{x}$ and $\overline{y}$ are zero-divisors  in $\cala/\scq$, hence $\exists n\in\intg$ s.t. ${\overline{y}}^n=0\in \cala/\scq\Lrta y^n\in\scq$.

``$\Llta$'' $u=x+\scq$ is a zero-divisor  in $\cala/\scq$ $\Lrta uv=(x+\scq)(y+\scq)=0\Llrta xy\in\scq$, $\Lrta (y+\scq)^n=0\in\cala/\scq\leadsto y^n\in\scq$
\end{proof}
\begin{rmkt}\label{rmkt:primary}
A tautology of the first definition says: $\scq\in\cala$ is primary iff $\overline{(0)}\in\cala/\scq$ is primary.
\end{rmkt}
\begin{dfn}
An ideal $\sca\subseteq \cala$ is \textbf{decomposable} if we may write $\sca=\scq_1\cap...\cap \scq_n$, where each $\scq_i$ is primary. We call this a \textbf{primary decomposition.}
\end{dfn}
\begin{prop}
$\cala$ is Noetherian, $\Lrta$ every $\sca\subseteq \cala$ is decomposable. 
\end{prop}
As part of the proof, we discuss the \textbf{Noetherian induction} first.

recall the idea of induction in general.
\textbf{Induction:} $S\subseteq \mathbb{N}$\\
(I) $S$ has a minimal element.\\
(II) $1\in S$ and ``$n\in S\Lrta n+1\in S)$''\\
 $\Lrta S=\mathbb{N}$

Similarly, we can consider 
\textbf{Noetherian Induction}. For $\cala$ a Noetherian ring\\
(I)Every $S\subseteq\{\text{ideals in $\cala$}\}$  has maximal element.
\\
(II) Let $S\subseteq\{\text{ideals in $\cala$}\}$ s.t.
\begin{enumerate}[label=(\alph*)]
\item $(1)\in S$
\item $\sca$ is an ideal in $\cala$,  $[\forall \scb\supsetneq\sca, \scb\in S]$ $\Lrta [\sca\in S]$\\
\end{enumerate}
Then $S=\{\text{ideals in $\cala$}\}$.

 This indeed works, because if we can find an ideal $\sca\notin S$ then there $\exists \scb\supsetneq \sca$ s.t. $\sca\notin S$. Repeating this, we can construct an infinite strictly increasing chain of ideals in $\cala$, which contradicts the fact that $\cala$ is Noetherian. 
\subsection{Lecture 12. Associated Ideals and First Uniqueness Theorem}
\begin{dfn}
An ideal $\sca$ is \textbf{irreducible} if whenever $\sca=\sca'\cap \sca''$, we have either $\sca=\sca'$ or $\sca=\sca''$.
\end{dfn}
\begin{lemma}
$\cala$ is Noetherian, $\sca\subseteq \cala$ is an ideal. $\Lrta\sca$ \textbf{decomposable}:
$\exists $ primary ideals $\scq_1,...,\scq_n\subseteq \cala$ s.t. $\sca=\scq_1\cap...\cap\scq_n$
, where $\scq$ primary $\Llrta x y\in \scq\Lrta x\in \scq\ or\ y^n\in \scq\ for\ some \ n$.
\end{lemma}
Notice $(6)=(2)\cap(3)$ is not irreducible.
\begin{proof}\ \\
\textbf{Claim1}: $\cala$ Noetherian. Then irreducible $\Lrta$ primary.

Proof of Claim1\\
Let $\sca$ be irreducible. Let $x,y\in \cala$ with $xy \in \sca$. Assume $x\notin \sca$. \underline{Want}: $\exists n,y^n\in\sca$. For notational simplicity, we may replace $\cala$ by $\cala/\sca$ and reduce to the case $\sca=(0)$. (We want to construct a ascending sequence of ideals.) Consider the ideals $\text{Ann}(y^n)$. Theses ideals goes up  as $n$ increases $\Lrta$, $\text{Ann}(y^n)=\text{Ann}(y^{n+1})$ for some $n$ because $\cala$ is Noetherian. Then we know, $xy=0$, $x\in \text{Ann}(y)$, $(x)\subseteq \text{Ann}(y)$.\\
\textbf{Subclaim}: $\text{Ann}(y)\cap(y^n)=0$.

 Assuming the subclaim,(since $(0)$ is irreducible) deduce that either $\text{Ann}(y)=(0)\Lrta x\in (0)$ or $(y^n)=(0)\Lrta y^n=0$.

 Now we turn to prove the subclaim: Let $z\in \text{Ann}(y)\cap(y^n)$. Then $z=y^n t, t\in \cala $ and $zy=0\Lrta t y^{n+1}=0\Lrta t\in \text{Ann}(y^{n+1})=\text{Ann}(y^n)\Lrta z= t y^n=0$. This finishes the proof of subclaim thus also the proof of Claim1.\\
 \textbf{Calim2}: $\cala$ Noetherian, every ideals in $\cala$ is finite intersection of irreducible ideals.

 Proof of Claim2: Define:
$$
  S:=\{\text{ideals in $\cala$ that are finite intersections of irreducible ideals}\}.
$$ 
Consider the complement 
$$
S^c:=\{\text{ideals in $\cala$ that are not finite intersections of irreducible ideals}\}.
$$
 \underline{Want}:$S^c=\emptyset$. If not, then it contains a maximal element $\sca$. Claim $\sca\neq (1)$, because $\sca$ not irreducible. 

 $\Lrta\sca=\scb\cap \scc,\scb\supsetneq\sca, \text{ and }\scc\supsetneq \sca$

 $\sca$ maximal in $S^c$, $\scb, \scc\notin S^c$. $\Lrta \scb,\scc\in S$. So $\scb$ and $\scc$ are finite intersections of irreducible ideals $\Lrta\sca=\scb\cap\scc$ is a finite intersection of irreducible ideals. contradiction.

Alternatively, by Noetherian induction, it suffice to show if $\sca$ has the property that`` \textbf{all strictly larger ideals $\scb\supsetneq \sca$ belongs to $S$}''  $\leadsto$ ``$\sca\in S$''. If $\sca$ irreducible, then we are done. If not, there exists $\scb\cap\scc$ s.t. $\sca=\scb\cap\scc.$ and $ \scc,\scb\supsetneq \sca$. $[\scb,\scc\in S]$ indeed implies $[\sca\in S]$. 
\end{proof}
\subsection*{Basics on primary ideals:}
\begin{lemma}
Let $\scq$ primary. Then $\scp:=\text{rad}(\scq)$ is prime. It is the smallest prime containing $\scq.$
\end{lemma}
\begin{proof}
It suffices to show $\scp$ is prime. ($\scp$= intersection of all prime ideals containing $\scq$, hence contained in any such prime, hence is the minimal of such primes.) Let $x,y\in\cala$, $xy\in\scp,x\notin \scp$. Want $y\in\scp$.\\
 $(xy)^n\in\scq$ for some $n$. $x^n\notin\scq\Lrta (y^n)^m\in\scq $ for some $m$$\Lrta  y\in\scp$.
\end{proof}

The converse statement is not true.
\begin{dfn}
If $\scq$ is primary with radical $\scp$, we say $\scq$ is  \textbf{$\scp$-primary}.
\end{dfn}
\begin{ex}
All the primary ideals in $\intg$ are of the form $(0)$ and $(p^n)$ , where $p$ is a prime number and $n$ a positive integer. We can check immediately that $(p^n)$ is $(p)$-primary
\end{ex}
\begin{lemma}
If $\scq_1,..,,\scq_n$ are all $\scp$-primary, then $\scq=\scq_1\cap...\cap \scq_n$ is also $\scp$-primary.
\end{lemma}
\begin{proof}
 $\text{rad}(\scq)=\text{rad}(\scq_1\cap...\cap\scq_n)=\text{rad}(\scq_1)\cap...\cap \text{rad}(\scq_n)=\scp\cap...\cap \scp=\scp$. Then it left to show $\scq_1\cap...\cap\scq_n$ is primary. 

Suppose $xy\in\scq, x\notin \scp$. \underline{Want}: $y\in \scq$. We have $xy\in \scq_i,x\notin\scp\Lrta y\in \scq_i\forall i\Lrta y\in\scq$.
\end{proof}
\begin{rmk}
Let $\scp$ prime. In general, a $\scp$-primary ideal $\scq$ need not be a power of $\scp$, and a power of $\scp$ need not be primary.
\end{rmk}
\begin{prop}\label{lem:rad_maximal_primary}
If $\cala\supseteq\scm$ is a  maximal ideal, $\scq$ any ideal, and $\scm=\text{rad}(\scq)$, then $\scq$ is $\scm$-primary.
\end{prop}
\begin{proof}
Then $\scm/\scq=\text{rad}(\scq)/\scq=\text{Nil}(  \cala/\scq)$ is both a maximal ideal and the intersection of all prime ideals $\Lrta\cala/\scq$ has exactly one prime ideal, $\scm/\scq$. $(\cala/\scq,\scm/\scq)$ is a local ring. To show that $\scq$ is primary, we must show any zero-divisors  in $\cala/\scq$ is nilpotent (belongs to $\text{Nil}(  \cala/\scq)=\scm/\scq$). In other words, want if $x\in\cala/\scq,x\notin\scm/\scq$, then $x$ not a zero divisor. Because $x\in\cala/\scq $ and $ x\notin \scm/\scq\Lrta \cala/\scq $ is local ring with unique prime $\scm/\scq\Lrta x$ is a unit.
\end{proof}

\begin{cor}In particular, 
$\scm$ maximal, $\Lrta\scm^n$ is $\scm$-primary $\forall n$.
\end{cor}
\begin{ex}
$\scm=(X,Y)\subseteq K[X,Y]\Lrta \scm^n$ is primary.
\end{ex}
\begin{ex}
$\scq=(X^2,Y)\subseteq K[X,Y]$ is $\scm$-primary. $\scm$-primary ideals are not necessarily powers of maximal ideals.
\end{ex}
\begin{ex}
$\sca=\prod^J_{j=1}(X-z_j)^{n_j}\subseteq \cplx[X]$ for some distinct $z_1,...,z_J\in\cplx$. Then $\sca=\scq_1\cap...\cap\scq_J$, $\scq_j=((X-z_j)^{n_j})$, $\scp_j=\text{rad}(\scq_j)=(X-z_j)$ 
\end{ex}
\begin{ex}
$\scq_1=(X,Y)^2=(X^2,XY,Y^2)\subseteq K[X,Y],\scp_1=(X,Y)$. $\scq_2=(Y)\Lrta \scp_2=(Y)$

$\sca=\scq_1\cap\scq_2=(XY,Y^2)$
\end{ex}

How do we talk about the uniqueness of primary decomposition?
Sometimes you shrink a primary decomposition $\scq=\scq_1\cap...\cap\scq_n$. $\scp_j=\text{rad}(\scq_j)$ 
\begin{enumerate}[label=(\alph*)]
\item If $\scp_i=\scp_j$ for some $i\neq j$, then we can replace $\scq_i$ with $\scq_i\cap\scq_j$ and delete $\scq_j$.
\item $\scq_j\supseteq \cap_{i\neq j}\scq_i$, then we can delete $\scq_j$.
\end{enumerate}
\begin{dfn}
If we can't do (a) or (b), we call the resulting decomposition \textbf{minimal}. Let $\sca$ ideal, we define $\text{Ass}(  \sca):=$\{prime ideals of the form $\text{rad}(\sca:x)$ for some $x\in\cala$\} to be \textbf{the set of associated prime ideals of $\sca$}.(recall $y\in(\sca:x)\Llrta y$ maps $x$ into $\sca\Llrta yx\in\sca$ )
\end{dfn}

\begin{thm}(First Uniqueness Theorem of minimal primary decomposition)\label{thm:primary_decomposition_First_uniqueness}
Let $\sca=\scq_1\cap...\cap\scq_n$ be a minimal primary decomposition. Then $\{\scp_1,...,\scp_n\}=\text{Ass}(  \sca)$. In particular, the set $\{\scp_1,...,\scp_n\}$ is independent of the choice of minimal primary decomposition.
\end{thm}

\begin{lemma}\label{lem:p-primary_ideal}
Let $\scq$ be $\scp$-primary, $x\in\cala$.
\begin{enumerate}[label=(\alph*)]
 \item
 $x\in\scq\Lrta(\scq:x)=(1)$
\item 
 $x\notin\scq\Lrta (\scq:x)$ is $\scp$-primary and therefore $\text{rad}(\scq:x)=\scp$.
\item 
 $x\notin\scp\Lrta (\scq:x)=\scq$
\end{enumerate}
\end{lemma}

We first show that the Lemma~\ref{lem:p-primary_ideal} leads to the Theorem~\ref{thm:primary_decomposition_First_uniqueness}.
\begin{proof}
$\{\scp_j\}\supseteq \text{Ass}(  \sca)$:\\
 Let $x\in\cala$ s.t. $\text{rad}(\sca:x)=\scp$ is prime. \underline{Want}: $\scp$ equals some $\scp_j$. $\text{rad}(\sca:x)=\cap_j \text{rad}(\scq_j:x)=\cap_{x\notin\scq_j}\scp_j$. Then by prime avoidance~\ref{prop:prime_avoidance}, we know $\scp=$some $\scq_j$.

For the converse inclusion, \underline{Want}: $\scp_j$ is of the form $\text{rad}(\sca:x)$ for some $x$. By Lemma~\ref{lem:p-primary_ideal}, we can choose $x_j\notin \scq_j$ and $x_j\in\cap_{i\neq j}\scq_i$. This $x_j$ always exists because $\scp_1\cap...\cap \scp_n$ is a minimal primary decomposition and such choice of $x$ would make $\text{rad}(\sca:x)=\cap_i \text{rad}(\scq_i:x_j)=\cap_{x_j\notin\scq_i}\scp_i=\scp_j$.
\end{proof}

And now we come back to the proof of the Lemma~\ref{lem:p-primary_ideal}
\begin{proof}\ 
\begin{enumerate}[label=(\alph*)]
\item follows directly from the definition of quotient of ideals and we want to prove a general fact that \textbf{ if $\scq$ is primary, then so is $(\scq:x),\forall x$}. Altogether, this means $(\scq:x)$ is $\scp$-primary.
Let $y z\in(\scq:x),y\notin (\scq:x)$. 

\underline{Want}: some $z^n\in(\scq:x)$

Know: $xyz\in\scq,xy\notin\scq$ because $\scq$ is primary $\Lrta$ some $z^n\in\scq$.\\
$\Lrta(\scq:x)$ is primary.
\item  
$x\notin\scq\overset{?}{\Lrta}\text{rad}(\scq:x)=\scp$

Obviously, we have $\scp=\text{rad}(\scq)\subseteq\text{rad}{\scq:x}$. It suffice to prove the converse inclusion.

Suppose $y^n\in(\scq:x)$

\underline{Want}: $y\in\scp.$\\
Know $xy^n\in\scq$, $x\notin\scq\Lrta y\in \text{rad}(\scq)=\scp$
\item 
$x\notin \scp\Lrta (\scq:x)=\scq$, the $\supseteq$ part is obvious. For the ``$\subseteq$'' suppose $y\in(\scq:x)$, i.e. $xy\in\scq$. Know $x\notin\scp$ because $\scq$ is primary, $\Lrta y\in\scq$
\end{enumerate}
\end{proof}
\subsection{Lecture 13. Second Uniqueness Theorem}
Recall the 
First uniqueness theorem for Minimal Primary Decomposition(MPD).

Let $\sca=\scq_1\cap...\cap\scq_n$ be a minimal primary decomposition. Then $\{\scp_1,...,\scp_n\}=\text{Ass}(  \sca)$. In particular, the set $\{\scp_1,...,\scp_n\}$ is independent of the choice of minimal primary decomposition.

$\sca$ decomposable with $\scq_1\cap...\cap \scq_n$ being any of the MPD. take $\scp_i=\text{rad}(\scq_i)$
$\text{Ass}(  \sca)=\{\scp_1,...,\scp_n\}$

\begin{ex}
MPD's need not be unique:
$$
\begin{aligned}
\sca&=(xy,x^2)\\
&=(x)\cap (x,y)^2\\
& =(x)\cap (x^2,y)
\end{aligned}
$$
but $\scp_1=(x)$ and $p_2=(x,y)$.
\end{ex}

\begin{prop}\label{prop:Noetherian_primary_quotint}
If $\cala$ is Noetherian and $\scq$ is a $\scp$-primary ideal, then $\exists x\in\cala$ s.t. $(\scq:x)=\scp$ (necessarily $x\notin \scq$)
\begin{proof}
$\scp$ finitely generated ideal $\forall x_i\in\scp\Lrta$ some $x_i^m\in\scq\Lrta $ some $\scp^n\subseteq \scq$ Any $n\geq \sum_i (m_i-1)+1$ would work.  \\
Choose $n\geq 1$ minimal with this property. Then $\scp^{n-1}\not\subseteq\scq\Lrta \exists x\in\scp^{n-1},x\notin\scq$.

Claim: $(\scq:x)=\scp$.

``$\subseteq$'': True, because we have seen that $(\scq:x)$ is $\scp$-primary.

``$\supseteq$'': If $y\in\scp$, then $xy\in\scp^n\subseteq \scq\Lrta y\in(\scq:x)$
\end{proof}
\end{prop}

\begin{ex}
$k$ is field, and $\cala=k[t]$, $\scq=(t^N),N\geq 1$, $\scp=(t)$.

$x\in\cala\Lrta x=c t^n+c' t^{n+1}+...,$ where $c\neq 0, n\geq 0, n=:ord_t(x)$
for example: $x=t^4+4t^2$, $ord_t(x)=2$.
$\frac{x}{1}\in\cala_\scp$, $\left(\frac{x}{1}\right)=\left(\frac{t^n}{1}\right)$.

Then $(\scq:x)=(t^m)$, where $m=\text{max}(N-n,0)$

$x\in\scq\Llrta n\geq N\Llrta m=0$.

$x\notin\scq\Llrta m\geq 1\Lrta (\scq:x)$ is $\scp$-primary.

$x\in(t^{N-1}),$ but $x\notin(t^N)\Lrta(\scq:x)=\scp$.

$x\notin\scp\Llrta n=0\Llrta m=N\Lrta (\scq:x)=\scq$.
\end{ex}

Now we come to the proof of Theorem~\ref{thm:primary_decomposition_First_uniqueness}
\begin{proof}
Given a MPD $\sca=\scq_1\cap...\cap\scq_n$, $x\in\cala$, we can compute $(\sca:x)=\cap_{j}(\scq_j:x)$
$$
\text{rad}(\sca:x)=\underset{j:\scq_j\not\ni x}{\cap}\scp_j
$$

Since this decomposition is minimal, we may find for each $i$ an element $x\in\cap_{j\neq i}\scq_j$, $x\notin\scq_i$\\
$\Lrta \text{rad}(\sca:x)=\scp_i$\\
$\Lrta \scp_i\in \text{Ass}(  \sca)$.\\ ($\scq_i\not \subseteq \cap_{j\neq i}\scq_j$) 

Conversely, if $\scp$ is a prime of the form $\scp=\text{rad}(\sca:x)$ for some $x$, then $\scp=\cap_{j:\scq_j\not\ni x}\scp_j\Lrta \scp=\scp_j$ for some $j$. $\Lrta \text{Ass}(  \sca)\subseteq \{\scp_1,...,\scp_n\}$
\end{proof}

This completes the proof the Theorem~\ref{thm:primary_decomposition_First_uniqueness}. Moreover, if $\cala$ is Noetherian, we may find for each $i$ an element $x_i$ with $(\sca:x_i)=\scp_i$, by applying the final part of Proposition~\ref{prop:Noetherian_primary_quotint}.


\begin{prop}\label{prop:zero-divisors_modulo_a}
(Definition) $\text{rad}(\sca)=\cap\scp_j$, if $\sca=\cap\scq_j$ is a  MPD. We want to define 
\textbf{Zero-divisors modulo $\sca$}: 
$$
\begin{aligned}
Z(\sca)&:=\{x\in\cala|\exists y\in\cala-\sca\ s.t.\ xy\in\sca\}\\
&=\{x\in\cala|(\sca:x)\nsubseteq\sca\}\\
&=\cup_{y\in\cala-\sca}(\sca:y)\\
&\overset{(*)}{=}\cup_{y\in\cala-\sca}\text{rad}(\sca:y)
\end{aligned}
$$
\end{prop}
\begin{proof} of the $(*)$. It suffices to prove that $=\cup_{y\in\cala-\sca}(\sca:y)\supseteq\cup_{y\in\cala-\sca}\text{rad}(\sca:y)$. \underline{Want}:  if some prower $x^n$ of $x$ satisfies $x^n\in(\sca:y)$ then $\exists y'$ s.t. $x\in (\sca:y')$.  $x^n\in(\sca:y)\Llrta x^n y\in\sca,$ then we may choose $n\geq 1$ minimal with this property. Then $x\cdot x^{n-1}y\in \sca$ but $x^{n-1}y \notin \sca$. As $x\in(\sca:x^{n-1}y)$. Choose $y'=x^{n-1}y$, we are done.
\end{proof}

\begin{prop}\label{prop:zero-divisors}
$\sca=\cap\scq_j$ MPD,
$\Lrta Z(\sca)=\cup\scp_j$.
\begin{proof}
$Z(\sca)\subseteq \cup\scp_j$: Let $x\in Z(\sca)$. 

\underline{Want}:  to show that $x$ is contained in some $\scp_j$. 

\underline{Know}: $x\in Z(\sca)\Lrta(\sca:x)\not \subseteq \sca$. On the other hand, we know $(\sca:x)=\cap_j(\scq_j:x)$ and we know $(\scq_j:x)$ is $\scp_j$-primary ideal if $x\notin\scq_j$, or $(\scq_j:x)=\scq_j$ if $x\notin\scp_j$.

If $x\notin\scp_j\forall j$, then $(\scq_j:x)=\scq_j\Lrta (\sca:x)=\cap {\scq_j}=\sca$, contrary to the hypothesis that $x\in Z(\sca)$.

{\color{red} In fact, this can be seen directly from $$Z(\sca)=\cup_{y\in\cala-\sca}\text{rad}(\sca:y)=\cup_{y\in\cala-\sca}\cap_{j:\scq_j\notin y}\scp_j\subseteq\cup \scp_j$$ }

For the reverse inclusion, we might try to show  $\cup\scp_j\subseteq Z(\sca)$.

Recall:$\text{rad}(\sca:y)=\cap_{j:\scq_j\not \ni y}\scp_j$. Give $j$, we can find $y$ s.t. $\text{rad}(\sca:y)=\scp_j$. See the proof of Theorem~\ref{thm:primary_decomposition_First_uniqueness},  each $i$ an element $x\in\cap_{i\neq j}\scq_i$, $x\notin\scq_j$. Necessarily, $y\notin\sca$. So if $x\in \scp_j$, then $x\in  \text{rad}(\sca:y)\subseteq Z(\sca)$ because $Z(\sca)=\cup_{y\in\cala-\sca}\text{rad}(\sca:y)$.
\end{proof}
\end{prop}

\begin{ex}
A good example for intuition, $\{z_1,...,z_n\}\subseteq k$ where $k$ is a field. $\sca=\cap \scq_j, \scq_j=(t-z_j)^{N_j}$ and $\cala=k[t]$.
$0\neq x\in\cala\Lrta n_j:=ord_{t-z_j}(x):=$largest $n_j\geq 0$ such that $(t-z_j)^{n_j}$ divides $x$.\\
Then $x\in Z(\sca)\Llrta \exists j:n_j\geq 1$.\\
$x\in \text{rad}(\sca)\Llrta \forall j, n_j\geq1$.\\
\textbf{N.b.} $n_j=$ order of vanishing of $x $ at $z_j$, $n_j> c\Llrta $ first $c$ Taylor coefficients of $x$ all vanish at $z_j$.
\end{ex}
\begin{dfn}
$\text{Ass}(  \sca)\ni \scp$ is either \textbf{minimal/isolated} if $\scp$ is a minimal element of $\text{Ass}(  \sca)$ (under the partial order of inclusion) or\\
\textbf{embedded} if the $\scp$ strictly contains some other ideals in $\text{Ass}(\sca)$. Geometrically, $\scp_1\subsetneq \scp_2\Lrta V(\scp_1)\supseteq V(\scp_2)$ embedded in $V(\scp_1)$. 

We usually denote the set of isolated primes in $\text{Ass}(  \sca)$ by $\text{Ass}'(\sca)$
\end{dfn}
\begin{ex}
$\scp_1=(x), \scp_2=(x,y)$\\
$\sca=\scp_1\cap\scp_2^2=(xy,x^2)$, $\scp_1$ is isolated/minimal while $\scp_2$ is embedded.
\end{ex}

Then we state the second unique decomposition theorem:
\begin{thm}\label{thm:secon_unique_decomposition}(Second Uniqueness Theorem)
In any MPD $\sca=\cap \scq_j$, $\{\scq_j:\scp_j\text{ is minimal}\}$ depends only upon $\sca$, independent of the choice of MPD. More precisely, for $\scp_j$ minimal, we have $\scq_j=\iota^*(\iota_*(\sca))$, where $\iota:\cala\lrta \cala_{\scp_j}$.
\end{thm}
Recall that for a multiplicative set $S\subseteq \cala$, $\iota:\cala\lrta S^{-1}\cala$:

$\scp$ prime ,

$\scp\cap S\neq\emptyset\Lrta \iota_*(\scp)=(1)$

$\scp\cap S=\emptyset\Lrta \iota^*(\scp)$ prime and $\iota^*\iota_*(\scp)=\scp$.

\begin{lemma}
$\iota^*\iota_*(\sca)=\cup_{s\in S}(\sca:s)$
\begin{proof}
$x\in \iota^*\iota_*(\sca)\Lrta $ $\frac{x}{1}\in\iota_*\sca=\{\frac{y}{s}:y\in\sca,s\in S\}$

``$\subseteq$'': Suppose $\frac{x}{1}=\frac{y}{s}$ for some $y\in\sca,s\in S$. Then $\exists t\in S$ s.t. $t(xs-y)=0$ $\Lrta stx=yt \in \sca\Lrta x\in (\sca:st)$, where $st\in S$.

``$\supseteq$'': Say $x\in (\sca:s)$ for some $s\in S$. Thus $xs=:y \in\sca$. Then $\frac{x}{1}=\frac{y}{s}\in \iota^*\iota_*\sca$ 
\end{proof}
\end{lemma}

\begin{lemma}\label{lem:second_uniqueness_decomposition}
$S\subseteq \cala$ is multiplicative set, $\scq\subseteq \cala$ primary and $\scp=\text{rad}(\scq)$. Then:
\begin{enumerate}[label=(\alph*)]
\item $\scp\cup S\neq \emptyset \Lrta \iota_*\scq=(1)$
\item $\scp\cap S=\emptyset$ $\Lrta \iota_*\scq$ is $\iota_* \scp$-primary and $\iota^*\iota_* \scq=\scq$.
\item $S\cap \scq =\emptyset \Llrta S\cap \scp=\emptyset$ 
\end{enumerate}
\begin{proof}
\begin{enumerate}[label=(\alph*)]
\item 
Suppose $\scp\cap S\neq \emptyset$, say $s_0\in \scp\cap S.\Lrta \exists n\geq 1: s_0^n\in \scq\cap S$
$$
\iota_*\scq=\left\{\frac{x}{s}:x\in \scq, s\in S\right\}
$$
$\frac{1}{1}=\frac{s_0^n}{s_0^n}\in \iota_*\scq$ $\Lrta\iota_*\scq=(1)$.
\item Suppose $\scp \cap S=\emptyset$. Recall that localization commutates with taking radicals~\ref{lem:radical_commutates_localization}, $\text{rad}(\iota_*(\scq))=\iota_*(\text{rad}(\scq))=\iota_*\scp$. Then if suffices to show that $\iota_*\scq$ is primary. 

Let $\frac{x}{s},\frac{y}{t}\in S^{-1}\cala$, Suppose $(\frac{x}{s})\frac{y}{t}\in \iota_* \scq ,\frac{y}{t}\notin \iota_*\scq$, \underline{Want}: some $(\frac{x}{s})^n\in \iota_*\scq$.

Note : we may assume $\scq=(0)$, because localization is exact, hence commutes with taking quotients
$$
S^{-1}(\cala/\scq)\cong S^{-1}\cala/\iota_*\scq.
$$

Then the original statement translates to:
\begin{enumerate}[label=(\roman*)]
\item $\iota$ is injective  (i.e. $\iota^*(0)_{S^{-1}\cala}=\iota^*\iota_*(0)\overset{?}{=}(0)$)
\item $\iota_*(0)=(0)_{S^{-1}\cala}$ is primary.
\end{enumerate}
These implies the remaining assertions $(\text{for }\scq=(0))$. In this case $\scp$ is the set of nilpotents in $\cala$.
Thus take $\scq=(0)$ and require $(0)$ to be primary in $\cala$. Assume $S\cap \scp=\emptyset$, i.e.  $S$ contains no nilpotents.\\

Proof of (i):\\
Recall Lemma~\ref{lem:localization_inj_surj_iso} that $\iota$ injective: $(i)$ $\Llrta S$ contains no nonzero zero-divisors. Note that $(0)\subseteq \cala$ is primary $\overset{def}{\Llrta}$ \{ zero-divisors in $\cala$\} $\cong$\{nilpotents in $\cala$\}.   \\
$(i)\Llrta$  $S$ contains no nilpotents.\\
$\Llrta S\cap \scp =\emptyset$.

Thus $(i)$ holds.

Proof of $(ii)$:
$$
\begin{aligned}
\left\{
\begin{aligned}
& \text{zero-divisors }\\
&\text{ in } S^{-1}\cala
\end{aligned}
\right\}
&
=\left\{
\begin{aligned}
& \frac{x}{s}:x\in\cala, s\in S\\
& \text{such that } \exists\frac{y}{t}\in S^{-1}\cala \text{ nonzero }\\
& \text{so that } \frac{x}{s}\frac{y}{t}=\frac{0}{1} 
\end{aligned}
\right\}\\
& =\left\{
\begin{aligned}
&\frac{x}{s}:\exists y\in\cala\text{ with } y\cdot t\neq 0,\forall t\in S\\
& \text{s.t. } \exists u\in S \text{ with } xuy =0\\
&\text{where } uy \neq 0
\end{aligned}
\right\}\\
\end{aligned}
$$

$$
\begin{aligned}
&=\left\{
\begin{aligned}
& \frac{x}{s}: s\in S\\
& x\in \cala \text{ is  zerodivisor}
\end{aligned}
\right\}\\
\end{aligned}
$$

$$
\begin{aligned}
&=\left\{ \frac{x}{s}: s\in S, x\in \cala\text{ is nilpotent}\right\}((0)\subseteq \cala\text{ is primary})\\
&=S^{-1}(\text{Nil}(\cala))\\
&=\text{Nil}(  S^{-1}\cala),\\
&(\text{ by the fact that radical commutes with localizations})
\end{aligned}
$$
Thus \{zero-divisors in $S^{-1}\cala$\}=$\text{Nil}(  S^{-1}\cala)$, so $(0)_{S^{-1}\cala}$ is primary.

\item The ``$\Llta$'' direction of (c) is trivial. For the ``$\Lrta$'' direction of (c), suppose $\exists s\in S\cap\scp$. Since $\scp=\text{rad}(\scq)$, $\exists n\geq 1 $ s.t. $s^n\in \scq$. $S$ multiplicative closed $\Lrta s^n\in S$. Thus $s^n\in S\cap \scq$. So $S\cap \scp\neq \emptyset \Lrta S\cap\scq\neq \emptyset$.
\end{enumerate}
\end{proof}
\end{lemma}

\begin{dfn}
In that case call $\scq_j$ the $\scp_j$-primary component of  $\sca$.
\end{dfn}

\begin{lemma}\label{lem:Ass'_mimial_primes}
Let $\sca$ be decomposable. Then $\text{Ass}'(\sca)=$\{minimal primes $\scp$ containing $\sca$\}, here minimal means that there is no intermediate primes between $\scp$
 and $\sca$.
\end{lemma}
\begin{proof}
It suffices to show that if any prime $\scp\supseteq \sca$, then there exists $\scp_j\in \text{Ass'}(\sca)$ s.t. $\scp_j\subseteq \scp$. Indeed, $\scp\supseteq\sca$ $\Lrta\scp\supseteq\text{rad}(\sca)=\text{rad}(\cap \scq_j)=\cap_j\text{rad}(\scq_j)=\cap_j\scp_j$. Then $\scp\supseteq\scp_j$ for some $j$, because of prime avoidance~\ref{prop:prime_avoidance}.
\end{proof}

\begin{thm}
$\cala\supseteq \sca=\cap_{j=1}^n\scq_j$ MPD. If $\scp_j \in \text{Ass}'(\sca),$ then 
$$
\scq_j=\iota^*\iota_*\sca,\iota:\cala\lrta \cala_{\scp_{j}}
$$
As a Corollary, the isolated primary component of $\sca$ does not depend on MPD.
\end{thm}
\begin{proof}
$$
\begin{aligned}
\iota^*\iota_*\sca&=\iota^*(\iota_*(\cap\scq_i))=\iota^*(\cap\iota_*\scq_i)=\cap\iota^*\iota_*\scq_i\\
\iota^*\iota_*\scq_i&
=\left\{
\begin{aligned}
&\scq_i: i= j(\text{By Lemma~\ref{lem:second_uniqueness_decomposition}})\\
& (1) :i\neq j
\end{aligned}
\right.
\end{aligned}
$$
For the second identity, we must check that $\forall i\neq j$, $S\cap \scq_i\neq \emptyset\Llrta \scq_i\not\subseteq \scp_j$

If $\scp_i\not\subseteq \scp_j$ $x\in\scp_i,x\notin\scp_j$ then some $x^n\in\scq_i,$ $\scp_i=\text{rad}(\scq_i)$, $x^n\notin \scp_j$ because $\scp_j$ is prime $\Lrta \scq_i\not\subseteq \scp_j$.
\end{proof}














\section{Dimension Theory}

\subsection{Lecture 14. Artinian   Rings}
\begin{dfn}
An $\cala$-module $M$ is called \textbf{Artin} or \textbf{Artinian} is it satisfies either of the following equivalent conditions:
\begin{enumerate}[label=(\roman*)]
\item \textbf{DCC} descending chain condition: if $M\supseteq M_1\supseteq M_2\supseteq ....$, then $\exists n_0$ s.t. $M_n=M_{n_0}\forall n\neq n_0$
\item \textbf{MIN} minimal condition: Every collection of submodules has minimal element.
\end{enumerate}
The proof of $(i)\Llrta (ii)$ same as the proof in definition of Noetherian ring.
\end{dfn}

\begin{dfn}
$\cala$ is an \textbf{Artinian ring } if it satisfies the following equivalent conditions
\begin{enumerate}[label=(\roman*)]
\item $\cala$ is an Artinian   $\cala$-module
\item $\cala$ DCC on ideals
\item $\cala$ MIN on ideals
\end{enumerate}
\end{dfn}

\begin{lemma}\label{lem:SES_Artin}
If $0\lrta M'\lrta M\lrta M''\lrta 0$ is a short exact sequence of modules, then $M$ Artinian   $\Llrta$ $M', M''$ Artinian. 
\end{lemma}
\begin{cor}
Any finitely generated modules over an Artinian   ring is Artinian. 
\end{cor}
\begin{cor}
$\cala$ Artinian   $\Llrta $ $\cala/\sca:$ Artinian   $\forall \sca$ ideals.
\end{cor}

\begin{ex}\ 
\begin{itemize}
\item A field is trivially Artinian   because it has only two ideals.
\item $\intg $ is NOT Artinian,
$(2)\supsetneq (2^2)\supsetneq (2^3)....$
\item Any finite ring is Artinian   + Noetherian e.g. $\intg/n\intg,n\neq 0$
\item Any finite product of Artinian  rings is Artinian. 
\item $k$ is field, $\scm:=(X_1,...,X_n)\subset k[X_1,...,X_n]=\cala$. Then $\cala/\scm^l$ is Artinian   $\forall l\geq 1$ where $\cala/\scm^l$ is finite dimensional vector space over $k$.
\item $k[X]/(X^l)$ is Artinian   $\forall l\geq 1$
\item $k[X^2,X^3]/(X^{10})$ is Artin
\item $k[X]$ is NOT Artinian, for example $(X)\supsetneq (X^2)\supsetneq (X^3)\supsetneq ...$
\end{itemize}
\end{ex}

\begin{lemma}\label{lem:primes_are_maximal_in_Artin}
Let $\cala$ Artinian.  Then every prime in $\cala$ is maximal and $\cala$ has only finitely many primes, hence the Jacobson radical $\text{Jac}(\cala)=\text{Nil}(  \cala)$
\end{lemma}
\begin{proof}
Let $\scp\subseteq \cala$ be prime. Set $\calb:\cala/\scp$. Then $\calb$ Artinian, integral domain.
\\
Want $\calb$ is a field.\\
Let $0\neq x\in \calb$, Want $x\in \calb^\times$\\
Consider $(x)\supseteq (x^2)\supseteq (x^3)\supseteq...$. $\calb$ Artinian   $\Lrta \exists n\geq 0: (x^n)=(x^{n+1})$, $\exists u\in \calb:x^n=u x^{n+1}\Lrta 1=ux$ because $\calb$ is an integral domain. Then $x\in\calb^{\times}$ as required.\\
Consider distinct maximal ideals $\scm_1,\scm_2,...\in\cala$. Consider $\scm_1\supseteq \scm_1\cap \scm_2\supseteq \scm_1\cap\scm_2\cap \scm_3\supseteq ...$ Choose $n_0: \scm_1\cap...\cap \scm_{n_0}=\scm_1\cap..\cap\scm_n \forall n\geq n_0$ $\Lrta \scm_1\cap...\cap\scm_{n_0}\subseteq \scm_n\Lrta \scm_n=\scm_j$ for some $j\leq n_0$.
\end{proof}

\begin{prop}\label{prop:Artin_nilpotent_nilradical}
$\cala$ is Artinian   $\Lrta \mathcal{N}:=\text{Nil}(  \cala)$ is nilpotent: $\exists n\geq 0,\mathcal{N}^n=(0)$
\end{prop}
\begin{rmk}
$$
\cala=\oplus^n_{i=1}k[X_i]/(X^i_i)
$$
hence $\mathcal{N}=\oplus^n_{i=1}(X_i)$, where $(X_i)\subseteq k[X_i]/(X^i_i)$ $\mathcal{N}^n=(0), \mathcal{N}^{n-1}\neq (0)$, If $n<\infty, \cala$ is Artinian   . If $n=\infty, \cala$ is NOT Artinian, because $\mathcal{N}$ not Nilpotent.
\end{rmk}

\begin{proof}
Let $\mathcal{J}:= \text{Nil}(  \cala)=\text{Jac}(\cala)$ by the Lemma~\ref{lem:primes_are_maximal_in_Artin}. Consider $\mathcal{J}\supseteq \mathcal{J}^2\supseteq \mathcal{J}^3\supseteq ...$ $\cala$ is Artinian   $\Lrta \mathcal{J}^n=\mathcal{J}^{n+1}$ for some $n$.

 \underline{Want}: $\mathcal{J}^n=(0)$.

Denote $\mathcal{I}:=\mathcal{J}^n$. Note that $\mathcal{J}\mathcal{I}=\mathcal{I}$, if we knew that $\mathcal{I}$ is finitely generated. Then Nakayama Lemma $\Lrta \mathcal{I}=(0)$. (But currently we don't know it. Because our definition of Artinian ring is not based on dimension 0 Noetherian ring)

Then we have to argue in some other way. Suppose $\mathcal{I}\neq (0)$. Consider the set 
$$
\Sigma:=\{\text{ideals } \scb\subseteq \cala: \cali \scb\neq(0)\}.
$$
Then $\Sigma$ is not empty because $\cali\subseteq \Sigma$. Then because $\cala$ is Artinian, there is a minimal element in $\Sigma$.

Let $\scb$ be a minimal element of $\{\text{ideals $\scb\subseteq \mathcal{I}:\mathcal{J}^n\scb\neq (0)$}\}$. Then $\exists 0\neq x\in \scb$ with $\mathcal{J}^n(x)\neq (0)$. Then $(x\subseteq \scb\subseteq \mathcal{I}), \mathcal{J}^n (x)\neq (0)$, so by minimality, $\scb=(x)$.
$\mathcal{J}^n(x)=\mathcal{J}^{n+1}(x)=\mathcal{J}^n\mathcal{J}(x)$.

Case 1: $\mathcal{J}(x)=(x)$, then it is zero by Nakayama lemma, however $(0)\notin \Sigma$, contradiction.

Case 2: $\mathcal{J}(x)\subsetneq (x)$ and $\cali \cdot \mathcal{J}\neq (0)$, which contradicts the minimality of $(x)$. 

Then $\Sigma$ has to be empty, $\cali=(0)$.
\end{proof}
\subsection{Lecture 15. Krull Dimension, Artinian v.s. Noetherian}
\begin{dfn}
The \textbf{Krull dimension} of a nonzero ring $\cala$, denoted $\text{dim}(\cala)$, is the supremum of all integers $r\geq 0$ s.t. $\exists$ chain of primes in $\cala$ of length $r$: 
$\scp_0\subsetneq \scp_1\subsetneq...\subsetneq \scp_r$.
\end{dfn}

\begin{ex}\ 
\begin{itemize}
\item $k$ a field, $\Lrta (0)$ is the only prime $\Lrta \text{dim}(k)=0$
\item $\text{dim}(\intg)=1$
\item (NOT OBVIOUS) $\text{dim}(k[x_1,...,x_n])=n$
 and $\text{dim}(\calr[x_1,..,x_n])=\text{dim}(\calr)+n$.
\item $\text{dim}(\cala)=0\Llrta $ every prime is maximal.  
\end{itemize}
\end{ex}

\begin{thm}\label{thm:Artin_equiv_Noetherin+dim=0}
$\cala$ an Artinian   ring $\Llrta\cala$ Noetherian and $\text{dim}(\cala)=0$.  
\end{thm}
Recall last lecture, by the Proposition~\ref{lem:primes_are_maximal_in_Artin} says all primes in Artinian   ring is maximal $\Lrta$ $\text{dim}(\cala)=0$.

\begin{lemma}\label{lem:ideal_radical_Noetherian}
$\cala$ Noetherian, $\sca\subseteq \cala$ ideal $\Lrta \exists n\geq 0: \text{rad}(\sca)^n\subseteq \sca$
\begin{proof}
$\text{rad}(\sca)$ is finitely generated, suppose it is generated by a finite set $\{x_i|i=1,...,r\}$. Choose $N\geq 0$ large enough that $x_j^N\in\sca,\forall j=1,...,r$. Any $x\in \text{rad}(\sca)$ may be written $x=\sum a_j x_j$ $\Lrta x^n=(\sum a_j x_j)^n=\cala$-linear combination of $x_1^{n_1}...x_r^{n_r} $ where $n_1+...n_r=n$. We can take $n$ large enough $(n\geq N\times r+1)$, then at least one of $n_j$ is larger than $N$ for each term $\Lrta x^n\in\sca$.
\end{proof}
\end{lemma}

\begin{cor}
$\cala$ Noetherian, $\scq$  is $\scp$-primary, $\exists n\geq 0:\scq\supseteq \scp^n$. (By definition)
\end{cor}

\begin{lemma}\label{lem:Artin_Noetherin_product_of_maximals}
Suppose $(0)\subseteq \cala$ is a finite product of maximal ideals. Then under this assumption, 
$$
\cala\text{ is Artin}\Llrta \cala\text{ is Noetherian}
$$
\begin{proof}
Say $(0)=\scm_1\cdot \cdot \cdot \scm_r$. Each $k_j:=\cala/\scm_j$ is a field. Define $M_0:=\cala$, $M_1:=\scm_1$, $M_2:=\scm_1\scm_2$,...,$M_r=(0)$.

Then $M_j/M_{j+1} (j=0,1,...,r-1)$ is a $k_{j+1}$-vector space. Moreover: 
$$
\text{
\{$\cala$-submodule of $M_j/M_{j+1}$\}}
\overset{bij}{\llrta}
\text{\{$k_{j+1}$-vector subspace of $M_j/M_{j+1}$\}}
$$

In general, if $V$ is a vector space over a field $k$, then $V$ is Artinian   $\Llrta dim_k(V)<\infty$ $\Llrta V$ is Noetherian. Thus $M_j/M_{j+1}$ is Artinian   $\Llrta$ $M_j/M_{j+1}$ is Noetherian.

To conclude, we apply the following Lemma:
\begin{lemma}
If $M=M_0\supseteq M_1\supseteq ...\supseteq M_r=\{0\}$ is a chain of modules over a ring, then $M$ is Noetherian iff each $M_j/M_{j+1}$ is Noetherian and $M$ is Artinian   iff $M_j/M_{j+1}$ is Artinian. 
\begin{proof}
Induction on $r$, check it for $r=0$.
For $r\geq 1$, 
$$
0\lrta M_1\lrta M_0\lrta M_0/M_1\lrta 0
$$ Recall Lemma~\ref{lem:SES_Noetherian} and Lemma~\ref{lem:SES_Artin}, we know $M_0$ Noetherian (Artin) $\Llrta$ each $M_j/M_{j+1}$ is Noetherian (Artin)
\end{proof}
\end{lemma}
\end{proof}
\end{lemma}

Now we come back to the proof of Theorem~\ref{thm:Artin_equiv_Noetherin+dim=0}
\begin{proof}\ \\
\underline{Want}: Artinian   $\Llrta $ Noetherian + $dim=0$\\
\underline{Know}: Artinian   $\Lrta dim=0$\\
By Lemma~\ref{lem:Artin_Noetherin_product_of_maximals}, it reduces to showing 
\begin{enumerate}[label=(\roman*)]
\item Artinian   $\Lrta $ $(0)=$ finite product of maximal ideals.
\item Noetherian + $dim=0$ $\Lrta $ $(0)=$ finite product of maximal ideals .
\end{enumerate}

For the part $(i)$. Recall $\cala$ Artinian   $\Lrta $ $\{\text{primes ideals in } \cala\}=\{\scm_1,...,\scm_r\}$ finite set of maximal ideals.
$$
(\scm_1\cdot \cdot \cdot \scm_r)^N\subseteq (\scm_1\cap ...\cap \scm_r)^N=\text{Jac}(\cala)^N=(0)
$$
for some $N$ by Proposition~\ref{prop:Artin_nilpotent_nilradical}.

For part $(ii)$, $\cala$ Noetherian $\Lrta (0)=\cap_j\scq_j$ :MPD with $\scp_j=\text{rad}(\scq_j)$.
$$
\begin{aligned}
(dim=0)& \Lrta\text{Each $\scp_j$ is maximal}\\
& \Lrta \text{Every $\scp_j$ is isolated/minimal}\\
& \Lrta \text{\{primes in $\cala$\}}=\{\scp_1,...,\scp_r\} \text{ are all maximal.}
\end{aligned}
$$
Consider $(\scp_1,...,\scp_r)^N\subseteq (\scp_1\cap...\cap\scp_r)^N\subseteq (0)$, where $(\scp_1\cap...\cap \scp_r)=\text{Nil}(  \cala)=\text{rad}(0)$ and we can conclude the last inclusion by Lemma~\ref{lem:ideal_radical_Noetherian}.
\end{proof}
\begin{dfn}
A ring $\cala$ is called \textbf{primary} iff $(0)$ is primary. Alternatively, $\cala$
\end{dfn}

\begin{prop}\label{prop:artin_local=artin_primary}
$\cala$ is Artinian.  Then $\cala$ local $\Llrta $ primary.
\begin{proof}
``$\Lrta$ '':\\
$(\cala:\scm)$ is local $\Llrta \scm $ is the unique prime ideal.\\
$\Lrta$ $\scm=\text{Jac}(\cala)=\text{Nil}(  \cala)$\\
$\Lrta\scm^N=0$ for some $N\geq 0$\\
$\cala-\scm=\cala^\times$
Here $\scm=\{\text{non-units}\}$, and by the argument above, $\scm=\{\text{nilpotents}\}$. (In a general ring, we have $\{\text{non-units}\}\supseteq\{\text{zero-divisors}\}\supseteq\{\text{nilpotents}\}$). In this case $\scm=\{\text{non-units}\}=\{\text{zero-divisors}\}=\{\text{nilpotents}\}$, $\Lrta(0)$ is primary.

Or equivalently, we can argue that $\text{rad}((0))=\scm$, then by Proposition~\ref{lem:rad_maximal_primary}, $(0)$ is primary.

``$\Llta$'':\\
 $(0)$ primary $\Lrta \scp=\text{rad}(0)$ is the smallest prime $\Lrta$ maximal.\\
$\Lrta\scp$ the unique prime in $\cala$\\
$\Lrta\scp$: the unique maximal in $\cala$\\
$\Lrta(\cala,\scm:=\scp)$ is local.

\end{proof}
\end{prop}

\begin{rmkt}
In an Artinian local ring, every primary ideal is of the form $\scm^n$. Consider a primary ideal $\sca\in\cala$, then $(\cala/\sca,\overline{\scm})$ is also Artinian local $\overline{\scm}^n=(0)$. By the isomorphism theorem of quotient ring, $\sca\sim\scm^n$
\end{rmkt}

Question: What are the Artinian   integral domains?\\
Answer: The fields. $(0)$ prime $\Lrta (0)$ maximal $\Lrta \cala$ is a field. 

\begin{prop}\label{prop:Noetherian_local_Artinian_nilpotent}
Let $(\cala,\scm)$ Noetherian local ring. Then either 
\begin{enumerate}[label=(\roman*)]
\item $\scm^n\neq \scm^{n+1}\forall n\geq 0$
\item Some $\scm^n=0$, $\cala$ Artinian. 
\end{enumerate}
\end{prop}
\begin{proof}
Need to show the negation of $(i)$ leads to $(ii)$.\\
That $(i)$ is false is equivalent to $\exists n:\scm^n=\scm^{n+1}$ $\llrta \scm\sca=\sca,\sca:\scm^n$, because $\cala$ is Noetherian we know $\sca$ is finitely generated. Then by Nakayama lemma we know $\sca=(0)$.

Let $\scp\subseteq \cala$ be a prime. Then $$\scm^n\subseteq \scp\subseteq \scm.$$ 
Take radical to get
$$
\scm=\text{rad}(\scm^n)\subseteq\text{rad}(\scp)=\scp\subseteq \text{rad}(\scm)=\scm.
$$
$\scp$ is arbitrary, $\cala$ is Artinian   local.
\end{proof}

\begin{ex}\ 
\begin{itemize}
\item $\intg/(p^n)$: Artinian   local
\item $k[[x]]$: Noetherian $\scm=(x)$ not Artinian   local
\item $k[[x]]/(x^n)$: Artinian   local
\item $k[x^2,x^3]/(x^{10})$: Artinian   local $\scm=(x^2,x^3)$
\end{itemize}
In the first three examples, the maximal ideal is principal while 
\end{ex}

In fact we can describe every Artinian   ring in terms of Artinian   local ring.
\begin{thm}(Structure Theorem of Artinian   Rings.)\label{thm:Artin_product_of_Artin_local}
Every Artinian   ring is a finite direct product of Artinian   local rings, unique up to reordering/isomorphism.
\end{thm}
\begin{proof}
$\cala$ Artinian   $\Lrta $ $\cala$ Noetherian with $dim 0$ $\Lrta\exists (0)=\cap\scq_j:$ MPD with $\scp_j=\text{rad}(\scq_j)$ being maximal.\\
$\exists n\geq 0$  s.t. $\scq_j\supseteq \scp_j^n\forall j$, $\scp_j$ maximal.\\
The $\scp_j$ are pairwise coprime\\
$\Lrta$ $\scp_j^n$ are pairwise coprime by Proposition~\ref{prop:charaterization_coprime_ideals}\\
$\Lrta$ $\scq_j$ are pairwise coprime.\\ Then we know from Chinese Remainder Theorem~\ref{thm:Chinese_remainder}:
the map
$$
\cala/\cap_j\scq_j\lrta \prod_j \cala/\scq_j
$$
 is an isomorphism, where $\cala/\scq_j$ are primary by Remark~\ref{rmkt:primary}, hence are local by Proposition~\ref{prop:artin_local=artin_primary}.
 This means 
 $$
\cala\cong\prod_j \cala/\scq_j
 $$
is a finite product of Artinian   local rings.

Uniqueness: Suppose $\phi:\cala\overset{\cong}{\lrta}\prod_j\cala_j$ finite product of Artinian   local ring. Let $\phi_i:\cala\lrta \cala_i$, $\phi_j=pr_j\circ\phi$. Define $\scq_i':=\text{Ker}(\phi_i)$. Then $\cala/\scq'_i\cong \cala_i$. By Proposition~\ref{prop:artin_local=artin_primary}, we know Artinian   local indicate primary. Then we know $\cala/\scq_i'$ primary $\Lrta\scq_i'$ is primary.

$\cap\scq_i'=(0)$ is a MPD.
But $\cala$ is Artinian, so every associated primes of $(0)$ is minimal or isolated. ($\text{Ass'}(0)=\text{Ass}(0)$).  Then by the Second Uniqueness Theorem of Primary Decomposition~\ref{thm:secon_unique_decomposition}. Each primary component is uniquely determined by $(0)$.
\end{proof}
\begin{rmkt}
Is it true that every primary ideal in Artinian   ring is the form $\scm_j^n$?

Yes, consider an Artinian ring $\cala\cong_i \cala_i$, where $\cala_i$ is Artinian local. Then the maximal ideals $\scm_j=\prod_{i\neq j}\cala_i\times \scn_j$, where $\scn_j$ is the maximal ideal in $\cala_j$
\end{rmkt}
\subsection{Lecture 16. Krull's Intersection Theorem}

\begin{thm}\label{thm:Krull_intersection}(Krull Intersection Theorem)
$\cala$ Noetherian, $\sca\subseteq \text{Jac}(\cala)$, $M$ finitely generated $\cala$-module.
Then
$$
\cap_{i\geq 0}\sca^i M=\{0\}
$$
\end{thm}
\begin{cor}
In the above setting, 
$$
\cap_{i\geq 0}\sca^i=(0)
$$
\end{cor}
\begin{nex}
$k$ is a field, $\cala:\cup_{n\geq 1}k[[X^{1/n}]]$ ``formal power series with positive rational exponents''. $\cala$ is a local ring with maximal ideal $\scm:\{\sca=\sum_{i\in\ratl_{\geq 0}}c_i X^i|c_0=0\}.$ $\cala/\scm=k$.\\
In particular, $\scm=\text{Jac}(\cala)$, hence it satisfies the requirement for ideals in the above theorem. But $\cap_{i\geq 0}\scm^i=\scm$. Indeed, $\scm$ is spanned over $k$  by $X^\alpha,\alpha\in\ratl_{>0}$. But $X^\alpha=(X^{\alpha/i})^i\in\scm^i\forall i\in\intg_{\geq 1}$. Thus $\scm\subseteq \scm^i\subseteq \scm\forall i\geq 1$. $\cala$ forms a Non-example of Non-Noetherian ring, $\scm$ is not finitely generated. 
\end{nex}

\begin{proof}(of Theorem~\ref{thm:Krull_intersection})
$\sca\subseteq \text{Jac}(\cala)$, which suggests us to  try Nakayama's Lemma~\ref{lem:Nakayama}.
$M':=\cap_{i\geq 0}\sca^i M.$ $M$ finitely generated Noetherian module $\Lrta M'$ is Noetherian and $M'$ is finitely generated. Want to show $M'=0$. By Nakayama lemma, it reduce to showing that $\sca M'=M'$.\\
Unfortunately, \textbf{ideal multiplication and intersection of modules do not in general commute}, so this is not so clear, we can at most claim $\sca M'\subseteq M'$.\\ 
To proceed, we need the following lemma:
\begin{lemma}\label{lem:Artin-Rees}
(Artin-Rees Lemma) Let $\cala$ be Noetherian, $\sca$ be any ideal in $\cala$. $M$ finitely generated module and $M'\subseteq M$ as a submodule. Then $\exists k\geq 0 $ so that $\forall i\geq k$
$$
\sca^i M\cap M'=\sca^{i-k}(\sca^k M\cap M')
$$
%\begin{proof}
%``$\subseteq$''. Let $x\in \sca^i M\cap M'$. Thus 
%?????????????
%``$\supseteq$'':$\sca^k M\cap M'\subseteq M'\Lrta \sca^{i-k}(\sca^k M\cap M')\subseteq M'$. $\sca^{i-k}(\sca^k M\cap M')\subseteq \sca^{i-k}\sca^k M=\sca^i M$
%$\Lrta\sca^{i-k}(\sca^k M\cap M')\subseteq \sca^i M\cap M'$
%\end{proof}

Then consider the $M':=\cap_i\sca^i M$, by Artin-Rees Lemma~\ref{lem:Artin-Rees}, $\sca^i M\cap M'=\sca^{i-k}(\sca^k M\cap M')$. But $\sca^i M\cap M'=M'=\sca^k M\cap M'$. Take $i=k+1: M'=\sca M'$. Then use the Nakayama Lemma~\ref{lem:Nakayama}, $\Lrta M'=0$   done.
\end{lemma}
\end{proof}

The ``$\supseteq$'' part of Artin-Rees Lemma~\ref{lem:Artin-Rees} is clear, because $\sca^{i-k}(\sca^k M\cap M')\subseteq \sca^i M\cap\sca^{i-k}M'\subseteq\sca^i\cap M'$.

Our aim next is to prove ``$\subseteq $'' part of Artin-Rees Lemma. We have to introduce a lot of machinery for this trickier inclusion.
\begin{dfn}
Let $\cali$ be a \textbf{monoid} (Set with associative binary operation and with identity). An \textbf{$\cali$-graded ring} is a ring together with a decomposition $\cala=\oplus_{i\in \cali}\cala_i$ such that $\cala_i\cala_j\subseteq \cala_{i+j}$. Thus $1\in \cala_0$.
\end{dfn}

\begin{ex}
$\cala=k[X_1,...,X_n]$, $\cali=\intg_{\geq 0}$, and $\cala_i:=$\{homogeneous elements if degree $i$\}. Then $\cala=\oplus_{i\geq 0}\cala_i$ is a $\intg_{\geq 0}$ graded ring.

Another example is still the same $\cala$ but with $\cali=(\intg_{\geq 0})^n$ and $\cala_I=k X_1^{i_1}...X_n^{i_n}$, where $I=(i_1,...,i_n)$
\end{ex}

\begin{dfn}
A \textbf{graded module} $M$ over a graded ring $\cala=\oplus_{i\in \cali}\cala_i$ is a module equipped with a decomposition $M=\oplus_{i\in \cali } M_i$
 s.t. $\cala_i\cdot M_j\subseteq M_{i+j}$. A \textbf{graded submodule } $M'\subseteq M$ is then a submodule for which $M'=\oplus_{i\in \cali}(M'\cap M_i)$. A \text{ graded ideal} $\sca$ is  graded submodule of $\cala$ s.t. $\sca=\oplus_i(\sca\cap \cala_i)$.
We call elements of $\cala_i\subseteq \cala$ or $ M_i\subseteq M$ \textbf{homogeneous}. Elements of $\cala_i$ or $M_i$ are homogeneous of degree $i$. A graded submodule of $\cala$ itself is called \textbf{graded ideal}.
\end{dfn}

\begin{ex}
$\cala=k[x,y]$ with its $\intg_{\geq 0}$-grading. Then $\sca=(x^2+y)$ is NOT a graded ideal. Indeed, $\sca\neq \sum_{i\geq 0}(\sca\cap \cala_i)\not\ni x^2+y$.

One way to see this is to use the $\intg^2_{\geq 0}$-grading and visualize. 

$\sca\cap\cala_1=\sca\cap\cala_{(1,0)}\oplus\sca\cap\cala_{(0,1)}=0$, and in fact $\sca\cap \cala_{(i,j)}=0$.
\end{ex}

\begin{lemma}
Let $M$ be graded module over a graded ring $\cala$. 
\begin{enumerate}[label=(\roman*)]
\item A submodule $M'\subseteq M$ is a graded submodule $\Llrta$ M' is generated by homogeneous elements. 
\item Moreover, if $M'$ is a graded submodule and finitely generated as module, then it is generated by finitely many homogeneous elements.
\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}[label=(\roman*)]
\item $M'\subseteq M$ is graded $\Llrta M'=\sum_i(M'\cap M_i)\Lrta M'$ generated by some homogeneous elements $(x_\alpha)_\alpha$, where $x_\alpha\in M_{i(\alpha)}$\\
Suppose $M'$ generated by homogeneous elements $\{x_\alpha\}$. Then
$$
\begin{aligned}
&\sum_i(M_i\cap M')\subseteq M'\subseteq \sum_\alpha\cala x_\alpha\\
&=\sum_{j,\alpha}\cala_j x_\alpha\\
&\subseteq\sum_{j,\alpha} M_{i(\alpha)+j}\cap M'(\text{By def of graded-module})\\
&\subseteq \sum_i (M_i\cap M').
\end{aligned}
$$
\item $M'\subseteq M$ graded, finitely generated.\\
Similar proof. But now we start with a possibly infinite generating set of homogeneous elements $H$ of M and a possibly non-homogeneous finite generating set $F$ of $M'$. And notice that each element in $F$ can be expressed as a finite linear expansion by elements in $H$. Then altogether, we can select a finite homogeneous generating set of $M'$ in $H$. 
\end{enumerate}
\end{proof}

Recall the setup for Artin-Rees Lemma~\ref{lem:Artin-Rees}. $\cala$ Noetherian ring, $\sca$ is an ideal and $M$ finitely generated $\cala$-module. Consider a $\intg_{\geq 0}$-graded ring. We denote by
$$
\tilde{\cala}:=\boxplus_{i\geq 0}\sca^i:=\{(x_i)_{i\geq 0}:x_i\in \sca^i, \text{with }x_i=0 \text{ for almost all }i\}
$$
$$\tilde{\cala}_j=\{(x_i)_{i\geq 0}\in \tilde{\cala}: x_j\in\sca^j, x_i=0, \forall i\neq j\}.$$
Multiplication on $\tilde{\cala}$ linearly extends the maps:
$$
\sca^i\times \sca^j\lrta \sca^{i+j}
$$

\begin{dfn}
There is a natural source of graded $\tilde{\cala}$-modules. $\tilde{M}=\boxplus_{i\geq 0} M_i$ form an  \textbf{$\sca$-filtration $(M_i)$:}
\begin{itemize}
\item $M_i$ is a submodule of some  $\cala$-module $M$.
\item $\sca M_i\subseteq M_{i+1}\Lrta\sca^j M_i\subseteq M_{i+j}$
\item $M_{i+1}\subseteq M_i$. Thus $\sca^i\times M_j\lrta M_{i+j}$ is defined. 
\end{itemize}
$\tilde{M}$ is a graded $\tilde{\cala}$-module.
\end{dfn}
\begin{dfn}
We call a $\sca$-filtration \textbf{stable} if $\exists k\geq 0:\forall i\geq k,\sca M_i=M_{i+1}\Lrta(\sca^j M_i=M_{i+j})$.
\end{dfn}
Because $\cala$ is Noetherian, we know $\sca$ is finitely generated by elements $x_1,...,x_n$. Then we know $\tilde{\cala}$ is finitely generated as an $\cala$-algebra by $\tilde{\cala}=\cala[x_1,...,x_n]$, then by Hilbert Basis Theorem~\ref{thm:Hilbert_Basis}, we know $\tilde{\cala}$ is Noetherian.
\begin{lemma}\label{lem:stable_filtration}
Suppose $(M_i):$ $\sca$-filtration and $\tilde{M}$ is graded $\tilde{\cala}$-module. Then $\tilde{M}$ is finitely generated $\tilde{\cala}$-module iff the $\sca$-filtration $(M_i)$ is stable.
\end{lemma}
\begin{proof}
``$\Llta$'': By definition, $(M_i)$ stable ( $\exists k\geq 0, \forall i\geq k,\sca M_i=M_{i+1}$) $\Lrta$ $\tilde{M}=\tilde{\cala}\boxplus_{i\leq k}M_k$, where we claim that each $M_k$ is finitely generated $\cala$-module. This is true because $M$ is finitely generated module over a Noetherian ring $\cala$, thus it is Noetherian by~\ref{cor:finitely_generated_module_over_Noetherian_ring}. And submodule of a Noetherian module is Noetherian. Then $\tilde{M}$ is finitely generated $\tilde{\cala}$-module.

``$\Lrta$''. Assume $\tilde{M}$ is finitely generated $\tilde{\cala}$-module, then we can choose $k$ large enough such that 
$$
\tilde{M}=\tilde{\cala}\boxplus_{i\leq k} M_k.
$$
If we pick $j$-th component for $j\geq k$, we have 
$$
\begin{aligned}
M_j&=\tilde{\cala}_j\cdot M_0+\tilde{\cala}_{j-1}M_1+...+\tilde{\cala}_{j-k}M_k\\
& = \sca^j M_0+...+\sca^{j-k}M_k\\
&\subseteq \sca^{j-k}M_k
\end{aligned}
$$
Then together with the definition of $\sca$-filtration, we know $\sca^{j-k}M_k=M_j$, thus the filtration is stable.
\end{proof}
Now we come back to the proof of Artin-Ress Lemma~\ref{lem:Artin-Rees} thus the Krull-intersection theorem~\ref{thm:Krull_intersection}.
$\tilde{\cala}:\text{ Noetherian }\Llta \cala \text{ Noetherian}$\\
$\sca: \text{finitely generated as an $\cala$ module }$. Suppose $\sca$ is generated as $(x_1,...,x_r)$. By the Hilbert basis theorem, $\tilde{\cala}:\text{ Noetherian }$ can be derived form $\tilde{\cala}$ being finitely generated as an $\cala$-module by $x_1,..,x_r\in\sca^1= (\tilde{\cala})_1$.

\begin{proof} of Artin-Rees Lemma~\ref{lem:Artin-Rees}.\\
Assume its hypothesis, choose $\forall i\geq 0, M_i:=\sca^i M:$ then it is a stable $\sca$-filtration (i.e. $\sca M_i=\sca\cdot \sca^i M=\sca^{i+1}M=M_{i+1}$):\\
 Because $M$ is finitely generated over $\cala$, we know $\tilde{M}$ is finitely generated over $\tilde{\cala}$. Then we conclude by Lemma~\ref{lem:stable_filtration} that $(M_i)$ is stable filtration.

Consider $M_i'=\sca^i M\cap M'$: an $\sca$-filtration. $\tilde{M}':=\boxplus_{i\geq 0}M_i'$. $\tilde{M}'$ is naturally a $\tilde{\cala}$-submodule of $\tilde{M}$. \underline{Want}: $M_i'$ is a stable $\sca$-filtration.

\underline{Know}:
$\tilde{M} $ is finitely generated $\tilde{\cala}$-module, and $\tilde{\cala}$ is Noetherian\\
$\Lrta \tilde{M}$ is Noetherian.\\
$\Lrta \tilde{M}'$ is finitely generated $\tilde{\cala}$-module hence also Noetherian.\\
$\Lrta (M'_i)$ is stable $\sca$-filtration by Lemma~\ref{lem:stable_filtration}. 


 Choose $n$ large enough that the module $\tilde{M}'$ is generated by $\boxplus_{0\leq i\leq n} M'_i$
 $$
 \tilde{M}'=\tilde{\cala}\boxplus_{0\leq i\leq n} M'_i
 $$
 $$
 \begin{aligned}
 \Lrta & \sca^{n+1}M\cap \tilde{M}'= M'_{n+1}=\sum_{0\leq i\leq n} \tilde{\cala}_{n+1-i}M'_i=\sum_{0\leq i\leq n}\sca^{n+1-i}(\sca^i M\cap M')\\
 &\subseteq\sum_{0\leq i\leq n}\sca(\sca^n M\cap \sca^{n-i}M')\subseteq \sca(\sca^n M\cap M'),
 \end{aligned}
 $$
which gives the trickier inclusion of Artin-Rees.
\end{proof}
We have proved the Artin-Rees Lemma and thus Krull's intersection theorem.
\underline{Recall}
The theorem of Krull intersection says that if $\cala$ is Noetherian, $\sca\subseteq \text{Jac}(\cala)$, $M$ is a finitely generated $\cala$-module, then $\cap_i\sca^i M=0$. Then we have the following corollaries

\begin{cor} Suppose $\cala$ Noetherian, 
$\sca\subseteq \text{Jac}(\cala)$, then
$$\cap_i\sca^i=0$$
\end{cor}
\begin{cor}\label{cor:cor3}
Suppose $(\cala,\scm)$ Noetherian, local, $\scm=\text{Jac}(\cala)$, then
$$
\cap_i\scm^i=0
$$
\end{cor}
\begin{exercise}
Deduce Krull intersection theorem form Corollary~\ref{cor:cor3}.
{\color{red}
\begin{proof}
\underline{Claim}: $(\calb,\scn)$ is Noetherian local, $N$ is a finite $\calb$-module: $\cap_i\scn^i=0\Lrta\cap_i\scn^i N=0$. Suppose $N$ is finitely generated by $\{x_\alpha\}$. 
$$
N'=\cap_i\scn^i N\subseteq \cap_i(\scn^i(\oplus_\alpha \calb x_\alpha))=\oplus_\alpha(\cap_i\scn^i)x_\alpha=0,
$$
the last equality from Corollary~\ref{cor:cor3}.


Then we start from the hypothesis of Krull's intersection theorem: $\cala$ Noetherian, $\sca\subseteq\text{Jac}(\cala)$, $M$ is a finitely generated $\cala$-module $M'=\cap\sca^i M$.

Pick an arbitrary maximal $\scm$ in $\cala$. $\sca\subseteq\scm$. Then localize $\cala$ and $M$ at $\scm$. We get $\cala_\scm$ and $M'_\scm=\cap (\sca_\scm)^i M_\scm\subseteq\cap(\scm_\scm)^i M_\scm=0$, where $(\cala_\scm,\scm_\scm)$ is Noetherian local. The last equality by the claim above.

Then we know $M'_\scm$ vanish at every $\scm$, and we conclude by ``being zero is a local property''~\ref{lem:zerpo_local}.  

\end{proof}
}

\subsection*{}
\underline{Question}: Let $\scp\in \text{Spec}(\cala)$. What is $\text{Ker}(\cala\lrta \cala_\scp)$?
\begin{dfn}\label{def:symbolic_power}
The \textbf{nth symbolic power} $\scp^{(n)}$ of $\scp$ is defined by $\scp^{(n)}:=\iota^*((\iota_*\scp)^n)=\iota^*(\iota_*(\scp^n))$ for $\iota:\cala\lrta \cala_\scp$.
\end{dfn}
\begin{prop}
Let $\scp$ be a prime ideal in  a ring $\cala$. The $n$-th symbolic power of $\scp$ has the following properties:
\begin{enumerate}[label=(\alph*)]
\item $\scp^{(n)}=\{a\in\cala:\exists s\in S:=\cala-\scp, \text{ s.t. } as\in\scp^{n}\}$.
\item $\scp^{(n)}$ is the $\scp$-primary component of $\scp^n$.
\item $\scp^{(n)}=\scp^n$ iff $\scp^n$ is $\scp$-primary.
\end{enumerate}
\begin{proof}
(a) by definition,

(b) by Second uniqueness theorem~\ref{thm:secon_unique_decomposition}, $\scp^{(n)}$ it is primary component of $\scp^n$. It is $\scp$-primary because $\text{rad}(\iota^*\iota_*(\scp^n))=\iota^*\iota_*\text{rad}(\scp^n)=\iota^*\iota_*\scp=\scp$.

(c) $\scp^{(n)}\supseteq\scp^n$ is easily checked. The reverse inclusion holds when $\scp^n$ is $\scp$-primary because $\scp^{(n)}$ is the $\scp$-primary component of $\scp^n$ 
\end{proof}
\end{prop}
Here, we will give an application of Krull's intersection theorem.
\begin{thm}\label{thm:Noetherian_localization_kernel}
 $\cala$-Noetherian, then $ \text{Ker}(\cala\lrta \cala_\scp)=\cap_{i\geq 0}\scp^{(i)}$.
\end{thm}
\begin{proof}
We know $\text{Ker}(\cala\lrta \cala_\scp)=\iota^*((0))\overset{?}{=}\cap_{i\geq 0}\iota^*(\iota_*(\scp)^i)$.
 The last equality is guaranteed by the Corollary~\ref{cor:cor3} because $(0)=\cap_{i\geq 0}\iota_*(\scp)^i$, where $\iota_*(\scp)$ is the maximal in the local Noetherian ring $\cala_\scp$. 
\end{proof}
\end{exercise}



\subsection{Lecture 17. Krull's Principal Ideal Theorem}
We start from a special case of Krull's principal ideal theorem and will eventually reduce the theorem to the special case.
\begin{lemma}\label{lem_5}
$\cala$ Noetherian local integral domain: $(0)\text{ prime } \subseteq \scm \text{ maximal }\subseteq \cala$. Then the following are equivalent:
\begin{enumerate}[label=(\roman*)]
\item $\exists $ prime $\scp$ with $(0)\subsetneq \scp\subsetneq \scm$
\item $\forall f\in\scm,\exists\text{ prime }\scp\ni f \text{ s.t. }$ , $(0)\subsetneq \scp\subsetneq \scm$
\end{enumerate}
In other words, this means $\scm$ is the minimal prime that contains some $(f)$ iff $\text{Spec}(\cala)=\{(0),\scm\}$. 

N.b. $(ii)\Lrta(i)$ is clear: take $f=0$.
\end{lemma}

\begin{ex}
$\cala=k[[X,Y]]\supseteq \scm=(X,Y)\supseteq (0)$. There exists $(0)\subsetneq\scp\subsetneq\scm,$ e.g., $\scp=(X)$. The conclusion says that $\forall f\in\scm\exists $ prime $\scp\ni f$ with  $(0)\subsetneq \scp\subsetneq \scm$, e.g. $f=Y\in\scm$.
\end{ex}




\begin{dfn}
$\text{dim}(\cala)=\sup \{t\geq 0:\exists \text{ chain of primes $\scp_0\subsetneq \scp_1\subsetneq ...\subsetneq \scp_t\subseteq \cala$}\}$\\

For prime $\scp\subseteq \cala:$

 \textbf{ height }$\text{ht}(\scp):=\sup \{t\geq 0|\exists\text{chain $\scp_0\subsetneq ...\subsetneq \scp_t=\scp$}\}$
$$
\text{ht}(\scp)=\text{dim}(\cala_\scp)
$$

\textbf{coheight:} $\text{coht}(\scp):=\sup\{t\geq 0|\exists \scp=\scp_0\subsetneq ...\subsetneq \scp_t\subsetneq \cala\}$

$$
\text{coht}(\scp)=\text{dim}(\cala/\scp)
$$
\end{dfn}
 
Another version:
\begin{lemma}\label{lem_5'}
$0\neq f(\text{ non-unit })\in\cala:$ Noetherian integral domain. Then any minimal prime $\scm_0$ of $(f)$ satisfies $\text{ht}(\scm_0)= 1$, where
$\scm_0\supseteq (f)$ minimal for this inclusion, in other words, ``$\scm_0\in \text{Ass}'((f))$'', see~\ref{lem:Ass'_mimial_primes}.
\end{lemma}

We may assume that $\cala$ is local with $\scm$ a maximal ideal that contains $f$ and then we can reduce Lemma~\ref{lem_5'} to Lemma~\ref{lem_5} via the following steps: 
\begin{itemize}
\item replace $\cala$ by $\cala_{\scm}$,\ \  $\iota:\cala\lrta \cala_{\scm}$
\item replace $\scm$ by $\iota_*(\scm)$
\item replace $f$ by $f/1=\iota(f)$
\end{itemize}

Then there are bijections 
$$
\{\text{primes $\scp\subseteq \scm$}\}\llrta \text{\{primes of $\cala_{\scm}$\}}
$$
and  
$$
\{\text{primes $\scp\ni f$}\} \llrta\{\text{ primes of }\cala_{\scm}\text{ that contains } f/1\}
$$
So $(\cala_\scm,\iota_*\scm)$ is Noetherian local domain and $\text{ht}(\iota_*(\scm))=\text{ht}(\scm)$. (We will reload it as $(\cala,\scm)$)

\underline{Know}: $\scm\in \text{Ass}'((f))$, i.e., $\nexists \text{ prime }\scp\ni f$ s.t. $(0)\subsetneq \scp\subsetneq \scm$ (We know $\scp\ni f\neq 0$, if $f\in\scp\subsetneq\scm$, then $\scm$ would not be a minimal prime of $(f)$).

\underline{Want}: $\text{ht}(\scm)=1$, i.e.,
$1=\sup T$ where $T:=\{t\geq 0,\exists \text{ chain } \scp_0\subsetneq ...\subsetneq \scp_t=\scm\}$. which is equivalent to 
\begin{itemize}
\item $(0)\subsetneq \scm$,$(\Llta \scm\ni f\neq 0)$,\ \ \  $T\geq 1$
\item $\nexists$ prime $\scp:(0)\subsetneq \scp\subsetneq\scm$,\ \ \ $T< 2$,
\end{itemize}
Which is true if we assume Lemma~\ref{lem_5}.  

Now we come back to the proof of the special case of Noetherian local domain.
\begin{proof}
``$(i)\Lrta(ii)$'' in Lemma~\ref{lem_5}

$(ii)\Llrta \text{dim}(\cala/(f))\geq 1, \forall f\in\scm$, there are two bijections: 
$$
\scm\llrta \text{ the maximal ideal in }\cala/(f),
$$
$$
\scm\supsetneq\scp\supseteq(f)\llrta\text{ a prime ideal in }\cala/(f).
$$

Consider the canonical projection $\pi:\cala\lrta \cala/(f)$. Let $\scp:$ prime s.t. $\scm\supsetneq \scp\not \ni f$.

Assume the negation of $(ii)\Llrta \text{dim}(\cala/(f))=0$. Then by Theorem~\ref{thm:Artin_equiv_Noetherin+dim=0},
$\frac{\cala}{(f)}$ is  Artinian.  $\Lrta$ $\exists k$ s.t., $\forall i\geq k$, $\scp^{(k)}+(f)=\scp^{(i)}+(f)$, where $\scp^{(k)}$ is the $k$-th symbolic power defined in~\ref{def:symbolic_power}.

Indeed, $\frac{\scp^{(k)}+(f)}{(f)}$ is a descending chain in $\frac{\cala}{(f)}$.

The negation of $(ii):\exists f\in \scm$ s.t. $\forall \scp$ prime , either\\
(a). NOT $(0\subsetneq \scp\subsetneq\scm)$\\
or\\
(b). $\scp\not\ni f$

Case (a). OK $\Lrta $ NOT (i) for this $\scp$

Case (b). We focus on this now.

\underline{Know}: $f\notin \scp\subsetneq \scm$.

\underline{Want}: $\scp=(0)$

As above, $\exists k,\forall i\geq k$: 
\begin{equation}\tag{*}
\scp^{(k)}\subseteq\scp^{(i)}+(f)
\end{equation}

\underline{Claim}:
\begin{equation}\tag{**}
\scp^{(k)}=\scp^{(i)}+(f)\scp^{(k)}:
\end{equation}
\begin{proof} of Claim:

``$\supseteq$'' \checkmark

``$\subseteq$''. Let $x\in\scp^{(k)}$. By (*) $\exists y\in\scp^{(i)},z\in\cala$ s.t. $x=y+fz$

$x-y=fz\in \scp^{(k)}$

$\Lrta z\in(\scp^{(k)}:f)=\scp^{(k)}$ ($\scp^{(k)}$ is $\scp$-primary and $\scp\not\ni f$, we conclude the equality $(\scp^{(k)}:f)=\scp^{(k)}$ by~\ref{lem:p-primary_ideal})

Taking $i\geq k$,
$
\scp^{(k)}\subseteq\scp^{(i)}+(f)\scp^{(k)}
$
, hence we have prove the claim.
\end{proof}

Then we take $i=k+1$ and consider the module $M:=\scp^{(k)}/\scp^{(k+1)}$.
(Claim:$\scp^{(k)}=\scp^{(k+1)}+f\scp^{(k)}$)$\Lrta$ 
$$
\begin{aligned}
\scp^{(k)}/\scp^{(k+1)}&=(\scp^{(k+1)}+(f)\scp^{(k)})/\scp^{(k+1)}\\
&=\frac{(f)\scp^{(k)}}{\scp^{(k+1)}\cap (f)\scp^{(k)}}\\
&=\frac{(f)\scp^{(k)}}{(f)\scp^{(k+1)}}\\
&=(f)\frac{\scp^{(k)}}{\scp^{(k+1)}}
\end{aligned}
$$
$\cala$ is local Noetherian, $f$ non-unit, then
$(f)\subseteq \text{Jac}(\cala)=\scm$.
$$
(f)M=M\Lrta M=\scp^{(k)}/\scp^{(i)}=0\text{ by Nakayama~\ref{lem:Nakayama}}.\\
$$
$\Lrta\scp^{(i)}=\scp^{(k)},\ \forall i\geq k$\\
$\Lrta$ $\scp^{(k)}=\cap_i\scp^{(i)}=$  $\text{Ker}(\cala\lrta \cala_\scp)$, by Theorem~\ref{thm:Noetherian_localization_kernel}. 
But $\text{Ker}(\cala\lrta \cala_\scp)={0}$ because $\cala$ is a domain (there is no nontrivial zero-divisors).\\
$\Lrta \scp^k\subseteq\scp^{(k)}=(0)$\\
Because $\cala$ is domain, $\scp^{k}=0\Lrta\scp=(0)$ as desired.
\end{proof}

\begin{thm}\label{thm:krull_principal}
(Krull's Principal Ideal Theorem) $\cala$ a Noetherian ring and $a\in \cala$ is non-unit and non-zerodivisor.
$\scp\in \text{Ass}'((a))$, i.e. $\scp\supseteq (a)$ is minimal. Then $\text{ht}(\scp)=1$.
\end{thm}
Recall: $\text{dim}(\cala)=\sup\{t\geq 0|\exists \text{chain } \scp_0\subsetneq...\subsetneq \scp_t\subseteq \cala\}$

$\scp$ prime: $\text{ht}(\scp)=\sup\{t\geq 0|\exists \text{chain } \scp_0\subsetneq...\subsetneq \scp_t=\scp\}$
\begin{dfn}$\sca$ is any ideal in $\cala$. The \textbf{height} of $\sca$, $\text{ht}(\sca)=\inf\{\text{ht}(\scp)|\scp\supseteq\sca\}$
 and \textbf{coheight} $\text{coht}(\sca)=\sup\{\text{coht}(\scp)|\scp\supseteq \sca\}$
\end{dfn}

Then the Theorem~\ref{thm:krull_principal} is equivalent to 
``if $a$ is non-unit and non-zerodivisor, then $\text{ht}((a))=1$ ''
\begin{proof}
$\cala$ Noetherian, $\Lrta (0)$ decomposable, where $(0)=\cap_i\scq_i$, minimal priamry decomposition, $\scp_i=\text{rad}(\scq_i)$

Recall~\ref{prop:zero-divisors}:
$$
\{\text{zero-divisors in }\cala\} =\cup_i\scp_i,
$$
thus $a\notin\scp_i\forall i$. Let $i$ s.t. $\scp\supseteq \scp_i$ (exists because $\{\scp_i\}\supseteq \{\text{minimal primes of $\cala$}\}$)

$a\in\scp ,a\notin \scp_i,\Lrta\scp_i\subsetneq \scp\Lrta \text{ht}(\scp)\geq 1$

\underline{Want}: $\text{ht}(\scp)=1$. If not, we can find a longer chain $\scp''\subsetneq \scp'\subsetneq \scp$, we assume $\scp''$ minimal, and then after changing the index (if necessary), set $\scp''=\scp_i$.

Now replace
$\cala$ by $\cala/\scp_i$, $\scp'$ by $\scp'/\scp_i$, $\scp$ by $\scp/\scp_i$, $a$ by its image.

Then $\cala$ Noetherian integral domain, $0\neq a\in \cala,a\in\scp,\scp\supset(a)$, minimal.
Then by Lemma~\ref{lem_5'}$\Lrta \nexists \scp':(0)\subsetneq \scp'\subsetneq \scp\Lrta \text{dim}(\scp)=1$.
\end{proof}

\begin{rmk}
If $0\neq f\in\cplx[X_1,..,X_N]$, $Z(f)$ being the zero loci of $f$. Then every irreducible component $X$ of $Z(f)$ has dimension $N-1$.

$Z(f)\llrta\text{ prime }\scp\ni f$

$X\llrta $ minimal primes $\scp\supseteq (f)$ 

$codim_{\cplx^N}(X)=1\Llrta \text{ht}(\scp)=1$
\end{rmk}

Recall from linear algebra:
if $V$ is finite dimensional vector space over field $k$, and $l$ is a nonzero linear functional on $V$, then
$$
\text{dim}(ker(l))=\text{dim}(V)-1
$$
Krull dimension theorem is a variant for polynomials.



\subsection{Lecture 18. Krull Dimension Theorem}

\textbf{Geometric Interpretation}: suppose $k=\overline{k}$,
Suppose $\cala=k[x_1,..,x_n]/\scq$ (some prime $\scq$) $\llrta$ $X=V(\scq)$ irreducible variety in $k^n$, where $V(\scq)=\{z|f(z)=0\forall f\in\scq\}$.

Then $\text{dim}(\cala)\llrta \text{dim}(X)$ $:=\sup\{t\geq 0:\exists$ chain of irreducible subvarieties $ X=X_0\supsetneq X_1\supsetneq ...\supsetneq X_t\}$

\{primes in $\cala$\} $\llrta$ \{primes $\scp$ in $k[x_1,..,x_n]$ $|$ $\scp\supsetneq \scq$\} one to one corresponds to $Y\subseteq X$ irreducible subvarieties. (this correspondence is inclusion reversing)

$\text{ht}(\scp)$ $\llrta$ $codim_X(Y):=\sup\{t\geq 0|\exists $chain of irreducible subvarieties such that $X=X_0\supsetneq X_1\supsetneq ...\supsetneq X_t=Y\}$

$\sca\subseteq\cala$ any ideal with $\text{rad}(\sca)=\sca $ $\llrta$ $Z\subseteq X$ closed subvariety

$\scp_i\in \text{Ass}'(\sca) i.e. \scp_i\supseteq \sca$ minimal $\llrta$ irreducible components $Y_i\subseteq Z$

$codim_X(Z)=\inf_{Y_i}\{ codim_X(Y_i)| \text{$Y_i$ is irreducible component of $Z$}\}$

$\text{coht}(\scp)=\text{dim}(\cala/\scp)\llrta \text{dim}(Y)$

$\text{coht}(\sca)=\text{dim}(\cala/\sca)=\sup_i \{\text{coht}(\scp_i)\}$

$\text{dim}(Z)=\sup\{ \text{dim}(Y_i)| Y_i\text{ is irreducible component of $Z$}\}$

Krull principal intersection theorem says :``Every irreducible component of a hypersurface in $X$ has codimension 1''

$\text{ht}(\sca)=1:codim_X(Z)=1$, $X,\emptyset\neq Z\llrta\sca=(a)$, where $Z=\{p\in X:a(\scp)=0\}$ (subset cut out by one equation) and $a\neq 0\text{ non-unit}$

$\scp_i\supseteq \sca$ minimal $\text{ht}(\scp)=1$ $\llrta codim_X(Y_i)=1\llrta Y_i\subseteq Z$ irreducible component.

\begin{thm}\label{thm:Krull_dimension}
(Krull Dimension Theorem)
Let $\cala$ Noetherian, $r\geq 1$, $a_1,..,a_r\in\cala$, $\sca=(a_1,...,a_r)$,$\scp\in \text{Ass}'(\sca)$. Then $\text{ht}(\scp)\leq r$.

Geometrically:``every subvariety cut out by $\leq r$ equations has codimension $\leq r$''

\end{thm}
\begin{proof}
Induct on $r\geq 1$. $r=1$ case is just the Krull's intersection theorem. Suppose $\exists $ chain $\scp_0\subsetneq...\subsetneq\scp_t=\scp$\\
\underline{Want}: $t\leq r$. Replace $\cala$ by $\cala_\scp$, which does not change the height or the minimality assumption. Reduce to the case $(\cala,\scp)$ $\cala$ is Noetherian local ring and $\scp$ is the maximal ideal in $\cala$. We know $\scp$ is the minimal among those primes containing $\sca$ $\Lrta$ $\scp$ is the only prime that contain $\sca$.

So $\scp_t=\scp$ containing $\sca$ being minimal $\scp_{t-1}\nsupseteq\sca$ $\exists $ generator of $\sca$ not in $\scp_{t-1}$. Suppose $a_r\notin\scp_{t-1}$.

We may assume, enlarging the chain as necessary, that there are no primes between $\scp_{t-1}$ and $\scp_t$. (If $\exists$ prime between $\scp_{t-1},\scp_t$, then $\exists$ a prime $\scq$ s.t. maximal with the property $\scp_{t-1}\subsetneq \scq\subsetneq \scp_t$, then add $\scq$ to our chain. We can always attain the maximal one because $\cala$ is Noetherian)

$\scp_{t-1}\subsetneq \scp_{t-1}+(a_r)\subseteq\scp_t$ $\Lrta$ ``$\scp=\scp_t$ is the only prime containing $\scp_{t-1}+(a_r)$''\\
$\Lrta\text{rad}(\scp_{t-1}+(a_r))=\scp\supseteq \sca\ni a_i$\\
$\Lrta\exists N\geq 1: a_i^N=a_i'+a_r y_i\in \scp_{t-1}+(a_r)$\\
Define $\sca':=(a_1',...,a_{r-1}')\subseteq \scp_{t-1}$.

\underline{Want}:$\scp_{t-1}\in \text{Ass}'(\sca')$. If we can show this, then our inductive hypothesis gives $t-1\leq r-1\Lrta t\leq r$. Let $\scp'\in \text{Ass}'(\sca')$ s.t. $\scp'\subseteq \scp_{t-1}\subsetneq \scp_t=\scp$ (Such a $\scp'$ exists.)

To show that $\scp'=\scp_{t-1}$, it suffices to show $\text{ht}(\scp/\scp')\leq 1$ in $\cala/\scp'$. Let $\overline{a}_r:=$ images of $a_r$ in $\cala/\scp'$.
By the Krull's principal ideal theorem~\ref{thm:krull_principal}, it will suffice to show that 
$\scp/\scp'\in \text{Ass}'((\overline{a}_r))$ $\Llta \scp=\text{rad}(\scp'+(a_r))$.\\
To see this:\\
$\scp=\text{rad}(\sca)=\text{rad}(\sca'+(a_r))\subseteq \text{rad}(\scp'+(a_r))\subseteq\text{rad}(\scp)= \scp$.
\end{proof}
\begin{cor}
$\cala$ Noetherian, $\sca$ is an ideal in $\cala$\\
$\Lrta \text{ht}(\sca)<\infty$.
\end{cor}
\begin{proof}
$\sca=(a_1,...,a_r)\Lrta$ $\text{ht}(\sca)\leq r$ by the above theorem.
\end{proof}
\begin{rmkt}
This means each Noetherian semi-local ring is finite dimensional. But still a general Noetherian ring can be infinite dimensional. A counter example is given by Nagata, which solved Hilbert's 14th problem.
\end{rmkt}
\begin{cor}
$(\cala,\scm)$: Noetherian local ring with the maximal ideal. $k:=\cala/\scm$ field. Then $\text{dim}(\cala)\leq dim_k(\scm/\scm^2)$. $\scm/\scm^2$ is called \textbf{Zariski cotangent space} and $\cala$ is called \textbf{regular} if the equality holds.

N.b.: $\forall$ $\cala$-module $M$, the quotient $M/\scm M$ is a $k$-vector space.
\end{cor}
\begin{proof}
Suppose, $r=dim_k(\scm/\scm^2)$, $\pi(f_1),...\pi(f_r)$ is a basis of $\scm/\scm^2$. Let $f_1,...,f_r\in\scm$ be lifts of the $f_i$. 

Set $M=\scm$, $N:=M/(f_1,...,f_r)$.\\
Claim: $\scm N=N$.
 $N=\frac{M}{\scm M}$, Want: $\scm N\supseteq N\Llrta\forall y\in M,\exists z\in M, m\in\scm s.t. y=m\cdot z+\sum_i\alpha_i f_i$. And in fact, we know $\pi(y)=\sum_i\alpha_i\pi(f_i)\Lrta \pi(y-\sum_i\alpha_if_i)=0\Lrta \exists mz\in \scm M$ s.t. $mz+\sum_i\alpha_i f_i=y$. done.

Then by Nakayama lemma~\ref{lem:Nakayama}, $N=0$ $\Lrta$ $\scm=(\tilde{a}_1,...\tilde{a}_r)\Lrta \text{ht}(\scm)=\text{dim}(\cala)\leq r$
\end{proof}

\begin{cor}
$\cala$ Noetherian, $\sca$ is an ideal in $\cala$ with $\text{ht}(\sca)=r$. Then exists $a_1,...,a_r\in\sca:\text{ht}(\sca)=\text{ht}((a_1,...,a_r))$.
\end{cor}
\begin{proof}
It suffice by induction to show: For $s\leq r$, if we can find $a_1,...,a_{s-1}\in\sca$ with $\text{ht}((a_1,...,a_{s-1}))=s-1$, then there exists an $a_s\in\sca$ s.t. $\text{ht}((a_1,...,a_s))=s$.
Consider a MPD $\scb=(a_1,..,a_{s-1})=\cap\scq_i$ with $\scp_i=\text{rad}(\scq_i)$

$\text{ht}(\scb)=s-1$

It will suffice to show that $\sca\not\subseteq \cup\scp_i $
then any $a_s\in\cup \scp_i-\sca$ will give 

$\text{ht}(a_1,...a_s)\leq s$ by Krull dimension theorem~\ref{thm:Krull_dimension}

$\text{ht}(a_1,...,a_s)\geq s$ by considering MPD.

For a complete proof, see the Theorem~\ref{thm:Krull_converse}
\end{proof}



\subsection{Lecture 19. System of Parameters}
\underline{Know}:
$\cala$ Noetherian, $r\geq 1$, $\sca=(a_1,...,a_r), a_i\in\cala$, $\scp\supset \sca$ minimal, then 
$$
\text{ht}(\scp)\leq r.
$$
If $r=1$, and $a_1:$ not a zero divisor, then $\text{ht}(\scp)=1$.

What about the reverse direction?

\begin{thm}\label{thm:Krull_converse}
(Converse to Krull)\\
$\sca\subset \cala$, Noetherian,  set $r=\text{ht}(\sca):\inf\{\text{ht}(\scp)|\scp\supset \sca,\scp\text{prime}\}$
Then 

(i) $\forall s=1,...,r$ $\exists x_1,...,x_s\in\sca$ such that $\text{ht}(x_1,..,x_s)=s$

(ii) Let $\scp_0\subsetneq ...\subsetneq \scp_r$ be a chain that realize the height of $\sca$, then we can find $x_1,...,x_r\in\sca$ s.t. $\scp_i\supset(x_1,..,x_i)$ is minimal.

(iii) Any prime $\scp$ of $\text{ht}(\scp)=r$ is a minimal prime of some ideal $(a_1,...,a_r)$
\end{thm}
\underline{Note:} $(i)\Lrta(iii)$ take $\sca=\scp,s=r:\text{ht}(x_1,...,x_r)=r=\text{ht}(\scp)$, $\scp\supset (x_1,...,x_r)$ is minimal. 

\begin{proof}
(i): $\text{ht}(\sca)=r$, then we can find some chain $\scp_0\subsetneq ...\subsetneq\scp_r $ s.t. there is no intermediate primes between each $\scp_i,\scp_j,i,j\leq r$. We pick up the first $s$ primes in this chain, $\scp_0\subsetneq ...\subsetneq\scp_s$. 

We induct on $s$, . Assume we have found $x_1,...,x_s$ s.t.
$\scp_i\supset(x_1,...,x_i)$ minimal $\forall i\leq s$, then $\text{ht}(\scp_i)\leq i$ by Theorem~\ref{thm:Krull_dimension}. On the other hand, $\text{ht}(\scp_i)\geq i$ by the existence of $\scp_0\subsetneq...\subsetneq \scp_i$ $\Lrta\text{ht}(\scp_i)=i,\forall i\leq s$.

Consider the minimal primes $\{\scq_j\}=\text{Ass}'((x_1,...,x_s))$, then $\scp_s$ is one of $\scq_j$.

Claim: $\scp_{s+1}\not \subset \cup_j\scq_j$.

Indeed, if not, since $\scq_j$ prime $\scp_{i+1}\subseteq \scq_j$ for some $j$, by the ``avoidance of primes''~\ref{prop:prime_avoidance}. Then $\text{ht}(\scq_j)\leq s$, by Krull dimension~\ref{thm:Krull_dimension}, but $\text{ht}(\scp_{s+1})\geq s+1$. Contradiction, thus the claim holds.

Choose $x_{s+1}\in\scp_{s+1}-\cup_j\scq_j$. Then $\scp_{s+1}\supseteq(x_1,..,x_{s+1})$. Except for the $s+1=r$ case, $x_{s+1}$ is automatically in $\sca$. If $s+1=r$, we can choose $x_r\in \sca-\cup_j\scq_j$ because $\sca\not\subset\cup_j\scq_j$, otherwise contradicts the height of $\sca$.

\underline{Want}:$\scp_{s+1}\in \text{Ass}'((x_1,...,x_{s+1}))$, so $\scp_{s+1}\supsetneq $ some $\scq_j$ as above, in particular $\scp_{s+1}\supsetneq\scp_s$.

Take $\scp'\in \text{Ass}'((x_1,..,x_{s+1}))$ s.t. $\scp_{s+1}\supseteq\scp'.$ Then claim: $\text{ht}(\scp')=s+1$,

for the proof of the claim:
$\text{ht}(\scp')\leq s+1$ by Krull, and $\text{ht}(\scp')\geq s+1$ because $\scp'$ is not a minimal prime $\scq_j$ of $\scp_s$ because $\scp'\supsetneq \scp_s$

If $(\scp'\subsetneq \scp_{s+1})$ we can get a contradiction on our initial choice of chain that realize the height of $\sca$.

We have finished the proof of induction steps. For the case $s=1$, the claim of $(i)$ reduce to Krull's principal ideal theorem~\ref{thm:krull_principal}.  The choice of $(x_1,...,x_s)$ above also implies $(ii)$.
\end{proof}

\begin{cor}: $(\cala,\scm)$ Noetherian Local, Thus $\text{dim}(\cala)=\text{ht}(\scm)\leq \infty$.
\end{cor}
Then $\exists x_1,...,x_n\in\scm$ s.t. $\scm$ is minimal over $(x_1,...,x_n)$. Then $\scm$ is the only prime containing $(x_1,..,x_n)$, so $\scm=\text{rad}((x_1,...,x_n))$ and $(x_1,...,x_n)$ is $\scm$-primary. (Recall that any ideal whose radical is maximal is primary~\ref{lem:rad_maximal_primary})

\begin{dfn}$(\cala,\scm)$ Noetherian Local,
we say when $n=\text{dim}(\cala)=\text{ht}(\scm)$ that $x_1,...,x_n$ are \textbf{parameters} for $\scm$ (or form a \textbf{system of parameters}). Equivalently, any of the following holds:
\begin{enumerate}[label=(\roman*)]
\item $\scm\supseteq (x_1,...,x_n)$ is minimal
\item $\scm=\text{rad}(x_1,...,x_n)$
\item $(x_1,...,x_n)$ is $\scm$-primary.
\end{enumerate}
\end{dfn}

\begin{thm}\label{thm:dim_in_terms_of_parameters}
$(\cala,\scm)$ is Noetherian Local, $\text{dim}(\cala)=\text{ht}(\scm)=min\{n\geq 1:\exists x_1,...,x_n\text{ s.t. }\scm\subseteq (x_1,..,x_n)\text{ minimal.}\}$
\end{thm}
\begin{proof}
$\geq$ converse of Krull

$\leq $ Krull
\end{proof}


\begin{thm}\label{thm:system_of_parameters}
$(\cala,\scm)$ Noetherian local. Let $x_1,..,x_r\in\scm$. Consider the following assertions:
\begin{enumerate}[label=(\roman*)]
\item We can extend $x_1,..,x_r$ to a system of parameters for $\scm$.
\item $\text{dim}(\cala/(x_1,..,x_r))=\text{dim}(\cala)-r$.
\item $\text{ht}((x_1,...,x_r))=r$
\end{enumerate}
Then $(i)\Llrta(ii)\Llta(iii)$
\end{thm}
\begin{proof}
$(iii)\Lrta(i)$: If $x_1,...,x_r$ are not already a system of parameters, then $\scm\supseteq(x_1,..,x_r)$ is not minimal. So we can find $\scm=:\scp_{r+1}\supsetneq \scp_r\supsetneq ...\supsetneq \scp_0$ and apply the converse of Krull~\ref{thm:Krull_converse} to obtain $x_{r+1}\in\scp_{r+1}=\scm$ s.t. $\text{ht}(x_1,..,x_{r+1})=r+1$. Continue finitely many times to set the required system of parameters.

It remains to show $(i)\Llrta (ii)$. \\
``$(i)\Lrta(ii)$'': Consider $y_1,..,y_s\in\scm$. Let $\overline{\cala}:=\cala/(x_1,..,x_r)$. $\overline{\cala}\supseteq\overline{\scm}:=$ Image  of $\scm$. Then $(\overline{\cala},\overline{\scm})$ is Noetherian local. Write $\overline{y}_1,...,\overline{y}_s\in\overline{\cala}$ the image of $y_1,..,y_s$

$\{x_1,...,x_r,y_1,...,y_s\}$ system of parameters, by definition, is equivalent to $r+s=\text{dim}(\cala)$ and $(x_1,...,x_r,y_1,...,y_s)$ is $\scm$-primary.

Note:$(x_1,...,x_r,y_1,...,y_s)$ $\scm$-primary\\
$\Llrta$ $\scm$ is the only prime containing $(x_1,..,y_s)$\\
$\Llrta\overline{\scm}$ is the only prime containing $(\overline{y}_1,...,\overline{y}_s)$\\
$\Llrta(\overline{y}_1,...,\overline{y}_s)$: $\overline{\scm}$-primary\\
$\{\overline{y}_1,...,\overline{y}_s\}$ system of parameters for $(\overline{\cala},\overline{\scm})\Llrta s=\text{dim}(\overline{\cala})$ and $(\overline{y}_1,...,\overline{y}_s)$ is $\overline{\scm}$-primary.

FACT1:[$\exists y_1,...,y_s$ s.t. $(x_1,...,x_r,y_1,...,y_s)$ is $\scm$- primary] $\Lrta \text{dim}(\cala)\leq r+s$, by Krull's dimension theorem~\ref{thm:Krull_dimension}.

And in fact, if we start we a system of parameters $(\overline{z}_1,...,\overline{z}_t)$ of $\overline{A}$, $z_i$ are their preimages in $\cala$, we have proved that $(x_1,...,x_r,z_1,...,z_t)$ is $\scm$ primary, then $\text{dim}(\cala)\leq t+r= \text{dim}(\overline{\cala})+r$

$(i)\Lrta$ $\exists y_1,..,y_s$ s.t., $\{x_1,...x_r,y_1,...,y_s\}$ is system of parameters.
$\Lrta r+s=\text{dim}(\cala)$ and $(x_1,...,x_r,y_1,...,y_s)$ is $\scm$-primary. Then, as prove before, $(\overline{y}_1,...,\overline{y}_s)$: $\overline{\scm}$-primary, we have $\text{dim}(\overline{\cala})\leq s=\text{dim}(\cala)-r$, which indicates $(ii)$.

Now check that $(ii)$ implies $(i)$.

If $(ii)$ holds, with $s:=\text{dim}(\cala)-r=\text{dim}(\overline{\cala})$, then $\exists y_1,...,y_s\in\cala$ s.t. $\{\overline{y}_1,...,\overline{y}_s\}$ is a system of parameters of $\overline{\cala}$. $\Lrta(\overline{y}_1,...,\overline{y}_s)$ is $\overline{\scm}$-primary $\Lrta (x_1,..,x_r,y_1,...,y_s)$ is $\scm$-primary. Also, we know $\text{dim}(\cala)=r+s$, then by definition $(x_1,...,x_r,y_1,...,y_s)$ is a system of parameters of $\cala$. 
\end{proof}

\begin{cor}
$(\cala,\scm)$, Noetherian local, $a\in\cala$ non-zerodivisor. Then:
 $$
 \text{dim}(\cala/(a))=\text{dim}(\cala)-1
 $$
\end{cor}
\begin{proof}
Recall: $\text{ht}((a))=1$ by Krull principal ideal theorem~\ref{thm:krull_principal}.

By the above (~\ref{thm:system_of_parameters} (iii)implies (i) and (ii)), we may extend $\{a\}$ to a system of parameters $\{a_0,...,a_n\}$, $a_0=a$, with $\text{dim}(\cala)-1=\text{dim}(\cala/(a))$
\end{proof}


\subsection{Lecture 20-1. Dimension of Polynomial Rings, Regularity}
\begin{thm}
$\cala$ Noetherian $\Lrta \text{dim}(\cala[X_1,..,X_n])=\text{dim}(\cala)+n$
\end{thm}
\begin{proof}
We may assume $n=1$ (then iterate with $\cala$ replaced by $\cala[X_1], etc$)

Easy direction: $\text{dim}(\cala[X])\geq \text{dim}(\cala)+1$. Indeed, consider a chain $\scp_0\subsetneq ...\subsetneq \scp_n$ in $\cala$. Consider $\scp_0\cala[X]\subsetneq ...\subsetneq \scp_n\cala[X]\subsetneq \scp_n\cala[X]+X\cala[X]$.

N.b. If $\scp\subsetneq \cala$ is prime, then $\cala[X]/\scp\cala[X]\cong (\cala/\scp)[X]$ is  a domain. so $\scp\cala[X]$ is prime.
And $\scp_n\cala[X]+X\cala[X]$ is prime because $\cala[X]/(\scp_n\cala[X]+X\cala[X])\cong \cala/\scp_n$

Hard direction $\text{dim}(\cala[X])\leq \text{dim}(\cala)-1$. Consider $\scp_0\subseteq...$

Because $\text{dim}(\cala[X])=$ $\sup\{\text{ht}(\scm):\scm\subseteq \cala[X] \text{ maximal }\}$

So it suffices to show $\forall\scm\subseteq \cala[X]$ that $\text{ht}(\scm)\leq r+1$, where $r:=\text{dim}(\cala)$. May assume $r\leq \infty$.

Consider $\scp:=\scm\cap\cala$, it is a prime in $\cala$ because $\scp:=\scm\cap\cala=\scm/(X)$ and also maximal. It suffices to show $\text{ht}(\scm)\leq \text{ht}(\scp)+1$.

We localize at $\scp$. $S:=S_\scp=\cala-\scp$. $S^{-1}\cala=\cala_\scp$ is local with maximal ideal $\scp_\scp$. $S^{-1}(\cala[X])=(S^{-1}\cala)[X]=\cala_\scp[X]$. $S^{-1}\scm\subseteq S^{-1}\cala[X]$ remains a maximal ideal, and $\text{ht}(S^{-1}\scm)=\text{ht}(\scm)$, because the localization with respect to $S$, preserves the primes and their inclusions for those ideals not intersecting $S$. And the problem reduce to the case of Noetherian local ring.

We now assume that $(\cala,\scp)$: Noetherian local ring, $\scm\subseteq\cala[X]$ maximal, $\scm\cap\cala=\scp$. $r=dim\cala< \infty$.

\underline{Want}: $\text{ht}(\scm)\leq r+1$\\
It suffices by theorem~\ref{thm:dim_in_terms_of_parameters}  to construct $r+1$ elements of $\cala[X]$ that generate an ideal with radical $\scm$.

\underline{Know}: $r=\text{dim}(\cala)=\text{ht}(\scp)$, so we can find $x_1,...,x_r\in\cala$ s.t.
$\scp$ is the only prime of $\cala$ containing $(x_1,...,x_r)$ i.e., $\text{rad}((x_1,...,x_r))=\scp.$

Consider
$$
\cala[X]\lrta\cala[X]/\scp\cala[X]=(\cala/\scp)[X]$$
$$
\scm\longmapsto\overline{\scm}\text{ maximal}
$$
where $\scm\supseteq\scp\cala[X]$ and $\cala/\scp$ is a field, thus $\cala/\scp[X]$ is a PID.

$\overline{\scm}=(\overline{f})$ for some $\overline{f}\in(\cala/\scp)[X]$. Say $\overline{f}$ is the image of $f\in\scm$.

\textbf{Claim}:$\scm$ is the only prime  that contains $x_1,..,x_r,f.$

Indeed, assume $\scq$ a prime in $\cala$ that contains $x_1,..,x_r,f$ $\Lrta$ $\scq\cap \cala$ is a prime of $\cala$ containing $x_1,..,x_r$, hence $\scq\cap \cala=\scp$, so $\scq\supseteq \scp\cala[X]$, so $\scq$ identifies with a prime ideal $\overline{\scq}\subseteq \cala[X]/\scp\cala[X]$ which contains $\overline{f}$, hence $\overline{\scq}=\overline{\scm}$, hence $\scq=\scm$. $\scm=\text{rad}((x_1,...,x_r,f))$.

\end{proof}

\begin{ex}(All the bad examples in algebraic geometry is more or less related to this example)
One other example: $k$ is a field, $k[[X,Y]]:=$ \{formal power series over $k$ in $X,Y$\}$=\{\sum_{ij}c_{ij} X^i Y^j\}$, $k[[X,Y]]$ is Noetherian, local ring with maximal ideal $(X,Y)$

Assume $\cala:=k[[X,Y]]/(X^2,XY)$. what is  $\text{dim}(\cala)$?

$\cala/(x)\cong k[[y]]$, $\cala/(x,y)\cong k$ are integral domains $\Lrta (X)\subsetneq (X,Y)$ is a chain of prime, notice that $\cala$ is not a integral domain$\Lrta \text{dim}(\cala)\geq 1$

$\cala\supseteq \scm=(x,y)$ (x and y here means the image of x and y in the quotient ring.)

Claim $\text{rad}((y))=\scm$
\begin{proof}
$x^2=0\in(y), y^1\in(y)\rta \scm\subseteq \text{rad}((y))$, and by the fact that $\scm $ is maximal $\scm=\text{rad}((y))$
\end{proof}
By the theorem on parameters, deduce that $\text{dim}(\cala)\leq 1$. hence $\text{dim}(\cala)=1$.
\end{ex}

\begin{lemma}
$k=\overline{k}$ say $k=\cplx$. $\cala=k[X_1,...,X_n]$. Let $\scm\subseteq \cala$ be a maximal ideal, then $\scm=(X_1-x_1,...,X_n-x_n)$ for some $(x_1,..,x_n)\in k^n$. Then $\text{ht}(\scm)=n$, and $\cala_\scm$ a local ring of dimension $n$ whose maximal ideal $\scm\cala_\scm$ has $n$ generators.
\begin{proof}
$\text{dim}(\cala_\scm)=\text{ht}(\scm\cala_\scm)=\text{ht}(\scm)\leq \text{dim}(\cala)=n$. $\text{ht}(\scm)\geq n$ because $\scm=\scp_n\supsetneq ...\supsetneq \scp_0$, $\scp_i=(X_1-x_1,...,X_i-x_i)$ 
\end{proof}
\end{lemma}


\begin{lemma}Now let $(\cala,\scm):$ Noetherian local of $d:=\text{dim}(\cala)=\text{ht}(\scm)$ and we set $k=\cala/\scm$.

\begin{enumerate}[label=(\alph*)]
\item In general , $d\leq dim_k(\scm/\scm^2)$ (The later is a $k$-vector space because $M$ and $\cala$-module $\Lrta M/\scm M$ is a $k$-vector space.)
\item The following are equivalent:
    \begin{enumerate}[label=(\roman*)]
        \item $\scm$ admits a set of $d$ generator: $\scm=(x_1,..,x_d)$
        \item $d=dim_k(\scm/\scm^2)$
    \end{enumerate}
    And if these hold, we call $(\cala,\scm)$ is \textbf{regular}
\end{enumerate}
\end{lemma}
\begin{ex}
$(k[x_1,..,x_n],\scm)$ is regular.
\end{ex}
\begin{proof}\ 
\begin{enumerate}[label=(\alph*)]
\item Set $n:=dim_k(\scm/\scm^2)$. Choose $x_1,..,x_n\in\scm$ s.t. $\overline{x}_1,...,\overline{x}_n\in \scm/\scm^2$ form a basis.

By Nakayama Lemma $\Lrta\scm=(x_1,...,x_n)\Lrta d\leq n$ by Krull dimension theorem.

\item $(i)\Lrta (ii)$\\
$\scm=(x_1,...,x_d)\Lrta \scm/\scm^2 $ is spannd by $\overline{x}_1,...,\overline{x}_d$, so $dim_k(\scm/\scm^2)\leq d$. Combine with $(a)$ to get $(ii)$.

$(ii)\Lrta (i)$ Same proof as $(a)$

\end{enumerate}
\end{proof}



\section{Integral Extension of Rings}
We will cover the contents of \S 5 of A-M and \S 3 pf Bosch

Motivation: to show that $\text{dim}(\cala)=tr.deg_k(Frac(\cala))$, $\forall\cala$ integral domain that is finitely generated as an algebra over some field $k\subseteq\cala$.

For example: $\cala=k[x_1,..,x_n]$

\underline{Want}: Machinery for comparing a general ring $\cala$ as above to this example.

\subsection{Lecture 20-2. Integral Element}

Consider a monic polynomial equation with coefficients in $\cala$:
\begin{equation}\label{eq:integral_extension}\tag{*}
x^n+a_1 x^{n-1}+...+a_n=0
\end{equation}
\begin{dfn}
Let $\cala\subseteq \calb$ be rings. Say that $x\in\calb$ is \textbf{integral over $\cala$} if $\exists n\geq 1$, $a_1,..,a_{n}\in\cala$ s.t. the above Equation(\ref{eq:integral_extension}) holds.

And we say that $\calb$ is \textbf{integral over $\cala$} if each $x\in\calb$ is integral over $\cala$.
\end{dfn}

A non-obvious fact: $x,y\in \calb$ integral over $\cala$, then $x\pm y, xy$ are integral over $\cala$ (The elements in $\calb$ integral over $\cala$ form a ring)

\begin{lemma}\label{lem:characterization_integral}
$\cala\subseteq \calb$ are rings. The followings are equivalent for $x\in\calb$.
\begin{enumerate}[label=\roman*).]
\item $x$ is integral over $\cala$
\item $\cala[x]$ is finite over $\cala$, i.e., $\cala[x]$ is a finitely generated $\cala$-module: $\exists e_1,..,e_n\in\cala[x],s.t. \cala[x]=\sum_i\cala e_i$
\item $\exists $ subring $\cala[x]\subseteq \calc\subseteq \calb$ s.t. $\calc$ finitely generated $\cala$-module.
\item $\exists$ faithful $\cala[x]$-module $M$ which is finitely generated as an $\cala$-module.
(Here by faithful, we mean the only element $y\in\cala[x], y\cdot m=0,\forall m\in M$ $\Lrta y=0$ )
\end{enumerate}
\end{lemma}
\begin{ex}
$\frac{1}{2}\in\ratl$ is not integral over $\intg$, $\intg[\frac{1}{2}]$ not a finitely generated $\intg$-module. It equals to  $\sum_{n=0}^\infty 2^{-n}\intg$.
\end{ex}
\begin{proof}
$(i)\Lrta(ii)$ If $x$ satisfies $x^n+a_1 x^{n-1}+...+a_n=0$, then $\cala[x]=\sum^{n-1}_{i=0}\cala x^i\ni x^n=-(a_1 x^{n-1}+...+a_n)\Lrta x^{n+1}=-a_1x^n-(a_2 x^{n-1}+...+a_n x)$. By induction, we know $\cala[x]$ is a finitely generated $\cala$-module.

$(ii)\Lrta (iii)$ $\calc:=\cala[x]$,

$(iii)\Lrta(iv)$ $M:=\calc$

$(iv)\Lrta(i)$ Suppose a finitely generated $\cala$-module $M$ which is simultaneously a faithful $\cala[x]$-module. $M=\sum_i^n\cala e_i, e_i\in M$. Because $M$ is a $\cala[x]$-module, we can apply the action of $x$ on each $e_i$ and get a system of linear equations:
$$
\begin{array}{ c }
x\cdot e_{1} =a_{11} e_{1} +...+a_{1n} e_{n}\\
\vdots \\
x\cdot e_{n} =a_{n1} e_{1} +...+a_{nn} e_{n}
\end{array}
$$
with coefficients $a_{ij}\in\cala$. In terms of matrices, we can write
\begin{center}
$\Delta \cdot \begin{pmatrix}
e_{1}\\
\vdots \\
e_{n}
\end{pmatrix} =0$,
\end{center}
where $\Delta=(\delta_{ij}x-a_{ij})\in (\cala[x])^{n\times n}$. Now consider the Cramer's rule in linear algebra:
$$
\Delta^{ad}\cdot \Delta=(det\Delta)\cdot Id,
$$
we have the following equality
\begin{center}
$\det \Delta \cdot \begin{pmatrix}
e_{1}\\
\vdots \\
e_{n}
\end{pmatrix} =0$,
\end{center}
hence $\det\Delta m=0,\ \forall m\in M$, by the assumption in $(iv)$, M is a faithful $\cala[x]$-module $\Lrta \det \Delta=0$. Therefore $x$ satisfies the following monic polynomial equation 
$$
\det (\delta_{ij} X-a_{ij})=0
$$
as desired.

\end{proof}

\subsection{Lecture 21. Normal Domain}
Last time we proved Lemma~\ref{lem:characterization_integral}, many corollary can be derived form it.
\begin{lemma}\label{lem:integral_lemma2}
$\cala\subseteq\calb\subseteq \calc$, $x\in\calc$. Then:
$$
[x\text{ integral over }\cala]\Lrta [x\text{ integral over }\calb]
$$
\end{lemma}
\begin{lemma}\label{lem:integral_lemma3}
$\cala\subseteq\calb\subseteq \calc$ are rings. If $\calc$ finite over $\calb$ and $\calb$ finite over $\cala$, then $\calc$ is finite over $\cala$. This can proved trivially by flattening the definition.
\begin{proof}
$\calc=\sum_{i=1,..,m}\calb y_i$ and $\calb=\sum_{j=1,..,n}\cala x_j$ $\Lrta$
$$
\calc=\sum_{i,j}\cala x_j y_i,\ \ x_j\in \calb,y_i\in\calc\Lrta x_j y_i\in \calc.
$$
\end{proof}

\end{lemma}

\begin{lemma}\label{lem:integral_lemma4}
Suppose $\cala\subseteq \calb$ rings, $x_1,..,x_n\in\calb$ integral over $\cala$. Then
\begin{enumerate}[label=(\roman*)]
 \item  $\cala[x_1,..,x_n]$ is finite over $\cala$
 \item $\cala[x_1,..,x_n]$ is integral over $\cala$
\end{enumerate}
{\color{red} Notice here $\cala[x_1,...,x_2]$ does not mean the polynomial ring but some ring generated by replacing the indeterminates $X_i$ by the corresponding element $x_i$ in $\calb$}
\begin{proof}
In fact, $(i)$ implies $(ii)$. 
By Lemma~\ref{lem:characterization_integral} part $iii).$ because $\forall x\in\cala[x_1,...,x_n],$ $ \cala[x]\subseteq \calc\subseteq \cala[x_1,...,x_n]$ where $\calc=\cala[x_1,...,x_n]$ and $\calc$ is finite over $\cala$.

Now we prove $(i)$. Induct on $n$. $n=1$ apply Lemma~\ref{lem:characterization_integral} part $ii).$, done. 
For $n\geq 2$, consider the inclusion $\cala[x_1,...,x_{n-1}]\subseteq \cala[x_1,...,x_{n-1}][x_n]\subset\cala[x_1,...,x_n]$, where $\cala[x_1,...,x_{n-1}][x_n]$ is finite over $\cala[x_1,..,x_{n-1}]$ and then apply Lemma~\ref{lem:integral_lemma3}, done.
\end{proof}
\end{lemma}

\begin{lemma}\label{lem:integral_lemma5}
$\cala\subseteq \calb$. The following are equivalent:
\begin{enumerate}[label=(\roman*)]
\item $\calb$ is integral over $\cala$ and finitely generated as an $\cala$-algebra.
\item $\calb$ is finite over $\cala$ (i.e., finitely generated as an $\cala$-module).
\end{enumerate}
\begin{proof}
``$(i)\Lrta(ii)$'':$\calb$ is finitely generated $\cala$-algebra, then $\calb=\cala[x_1,..,x_n]$, $\Lrta$( each $x_j$ is integral over $\cala$, and $\calb=\cala[x_1,...,x_n]$ is finite over $\cala$ by Lemma~\ref{lem:integral_lemma4}

``$(ii)\Lrta(i)$'': $\calb$ is finite over $\cala$ automatically means $\calb$ is finitely generated $\cala$-algebra. By Lemma~\ref{lem:characterization_integral}, part $iii).\Lrta i).$, $\forall x\in\calb, \cala[x]\subseteq \calb\subseteq\calb$, where $\calb$ is itself finitely generated $\cala$-module, then we know $x$ is integral over $\cala$.
\end{proof}
\end{lemma}

\begin{lemma}\label{lem:integral_lemma6}
$\cala\subseteq \calb$ are rings. Then $\overline{\cala}:=\{x\in \calb|x$ integral over $\cala\}$ is an $\cala$-subalgebra of $\calb$.
\begin{proof}
If $x,y\in \calb$ are integral over $\cala$. then by Lemma~\ref{lem:integral_lemma4}, $\cala[x,y]$ is finite over $\cala$ $\Lrta$ $\cala[x,y]$ is integral over $\cala$.
so $xy,a_1x+a_2y\in\cala[x,y],\forall a_1,a_2\in\cala$ are integral over $\cala$.
\end{proof}
\end{lemma}

\begin{lemma}\label{lem:integral_lemma7}
$\cala\subseteq \calb\subseteq\calc$ where $\calb$ is integral over $\cala$, and $\calc$ is integral over $\calb$, $\Lrta$ $\calc$ is integral over $\cala$.
\begin{proof}
Let $x\in\calc$. Write
$$
x^n+b_1x^{n-1}+...+b_n=0 \text{  for some $b_1,...,b_{n}\in\calb$}.
$$
Set $\calb_0:=\cala[b_1,...,b_n]$. Then by some Lemma~\ref{lem:integral_lemma4} above, we know $\calb_0$ is finite and integral over $\cala$, and ``$x$ integral over $\calb_0$'' $\Lrta$ ``$\calb_0[x]$ finite over $\calb_0$''.

Then we know  ``$\calb_0$ is finite over $\cala$'', and ``$\calb_0[x]$ is finite over $\calb_0$'', then by Lemma~\ref{lem:integral_lemma2} above, we know $\calb_0[x]$ is finite over $\cala$. Then by Lemma~\ref{lem:characterization_integral} part $iii)$, $\cala[x]\subseteq \calb_0[x]\subseteq\calc$ and $\calb_0[x]$ is finite over $\cala$ $\Lrta$ $x$ is integral over $\cala$.
\end{proof} 
\end{lemma}

\begin{dfn}
$\cala\subseteq \calb$ rings, $\overline{\cala}:=\{x\in\calb|x\text{ integral over }\cala\}=:$`` the \textbf{integral closure of $\cala$ in $\calb$}''. We call $\cala$ is \textbf{integrally closed in $\calb$} if $\overline{\cala}=\cala$.
\end{dfn}

\begin{cor}\label{cor_integral_cor8}
$\overline{\cala}$ is integrally closed in $\calb$: $\overline{\overline{\cala}}=\overline{\cala}$,``integral closures are integrally closed''
\begin{proof}
Suppose $x\in\calb$ is integral over $\overline{\cala}$. Since by definition, $\overline{\cala}$ is  integral over $\cala$. Then by Lemma~\ref{lem:integral_lemma7}, $x$ is integral over $\cala$ $\Lrta$ $x\in \overline{\cala}\Lrta\overline{\overline{\cala}}=\overline{\cala}$.
\end{proof}
\end{cor}

\begin{lemma}\label{lem:integral_lemma9}(Lemma 9)\\
$\cala\subseteq \calb$ rings, $\scb\subseteq\calb$ an ideal, and set $\sca:=\cala\cap\scb$. If $\calb$ is integral over $\cala$, then $\calb/\scb$ is integral over $\cala/\sca$.
\begin{proof}
Let $x+\scb\in \calb/\scb$. Write $x^n+...=0$ with coefficients in $\cala$, and then reduce to the conclusion by $\mod \scb$.
\end{proof}
\end{lemma}

\begin{lemma}\label{lem:integral_lemma10}(Lemma 10)
Let $\cala\subseteq \calb$ are rings, and multiplicative set $S\subseteq \cala$. Then $\cala$, then $S^{-1}\calb$ is integral over $S^{-1}\cala$.
\begin{proof}
Let $\frac{x}{s}\in S^{-1}\calb$, $x\in \calb, s\in S$.
Indeed
$$
x^n+a_1 x^{n-1}+...+a_n=0
$$
implies
$$
\left(\frac{x}{s}\right)^n+\frac{a_1}{s}\left(\frac{x}{s}\right)^{n-1}+...+\frac{a_n}{s^n}=0
$$
which means $\frac{x}{s}$ is integral over $S^{-1}\cala$.
\end{proof}
\end{lemma}

\begin{dfn}
Let $\cala$ a domain (:= integral domain).
set $K:=Frac(\cala)$ field of fractions. Call $\cala$ \textbf{normal} if $\cala$ is integrally closed in $K$, i.e., $x\in K, $ integral over $\cala\Lrta x\in\cala$.
Note in some references e.g., Atiyah-Macdonald ``normal'' is equivalent to ``integrally closed''
\end{dfn}

\begin{lemma}\label{lem:integral_lemma11}(Lemma 11)
$\intg$ is normal.
\begin{proof}
Let $x\in \ratl^\times$, say $x=r/s$, $gcd(x,s)=1$, $r,s\in\intg, s\neq 0$. Suppose $\exists a_1,..,a_n\in\intg$ s.t.,
$$
x^n+a_1 x^{n-1}+...+a_n=0.
$$
Then after multiplying it by $s^n$, set
$$
r^n=-(a_1 r^{n-1}s+a_2 r^{n-2}s^2+...+a_n s^n)
$$
$\Lrta s|r^n$, $gcd(r^n,s)=1,\Lrta s\in \intg^\times\Lrta x\in \intg$.
\end{proof}
\end{lemma}

\begin{lemma}\label{lem:integral_lemma11'}(Lemma11')
Any UFD (unique factorization domain) is normal (via the same proof): e.g. $\intg,k[x_1,...,x_n]$
\end{lemma}

Consider an example of ring which is not normal:
\begin{ex}
$\cala=k[x^2,x^3]\subset K=Frac(\cala)=k(x),(\text{because } x^3/x^2)$ is not normal.

The element $x\in K$ is integral over $\cala$, but not in $\cala$.

Similarly, $k[x(x-1),x^2(x-1)]$ is not normal.
\end{ex}
\begin{prop}\label{prop:integral_closure_in_algebraic_field_extension}
$\cala$ is a domain. $K:=Frac(\cala)$. $L/K$ is an algebraic field extension. Suppose $\calb:=$integral closure of $\cala$ in $L$. Then $\calb$ is normal.
\end{prop}
\begin{proof}
Integral closure $\calb$ is a subring of a field $L$, thus it is a integral domain.

Check that $Frac(\calb)=L$: By definition, $\calb$ is a the set of integral element of $L$ over $\cala$, then $Frac(\calb)\subseteq L$. For the converse inclusion, $x\in L$, $L$ is an algebraic field extension of $K$, then $x$ satisfies some  polynomial equation with coefficients in $K$.
$$
x^n+k_1 x^{n-1}+...+k_n=0
$$
each $k_i$ can be written as $a_i/s_i$ where $s_i\in \cala^\times $, multiply the above equation by $s^n$, where $s:=\prod_i s_i\in \cala\in\calb$,
then we get
$$
(s x)^n+(a_1s_2...s_n) (s x)^{n-1}+...=0,
$$
which means $sx\in\overline{\cala}= \calb\Lrta x\in Frac(\calb)$. This proof in fact says each element $x\in L$ can be written as $\frac{b}{a}$, $b\in\calb, a\in\cala^\times$.
\end{proof}
\begin{ex}
$\cala=\intg, K=\ratl$, $L/K$ is finite extension ($L$ is a number field.) $\calb$ is the integral closure of $\cala$ in $L$.

$\calb=:\calo_L$ ``ring of integers in $L$''.
\end{ex}

\begin{ex}
$\cala=\intg[\sqrt{3}]$,$L=\ratl(\sqrt{3})$,
FACT: $\calo_L=[(1+\sqrt{3})/2]\supsetneq \intg[\sqrt 3]$

$\intg[\sqrt{3}]$ is not normal.
\end{ex}

\begin{dfn}
$\cala$ is a domain, $\cala^{norm}:=$ ``integral closure of  $\cala$ in the faction field $K=Frac(\cala)$'' is called the \textbf{normalization} of $\cala$. It is normal by Prop~\ref{prop:integral_closure_in_algebraic_field_extension}.
Examples include
$$
k[X^2,X^3]^{norm}=k[X]
$$
$$
\intg[\sqrt{3}]^{norm}=\intg\left[\frac{1+\sqrt{3}}{2}\right]
$$
\end{dfn}
\begin{lemma}\label{integral_lemma12}(Lemma 12)
$\cala\subseteq \calb$, integral extension of rings.
\begin{enumerate}[label=(\roman*)]
\item ($\cala$ is a field $\Llrta$ $\calb$ is a field) provided that $\cala$ and $\calb$ are domains
\item  Let $\scq\subseteq \calb$ prime, and $\scp:=\scq^{c}=\scq\cap \cala$. prime (in $\cala$). Then 
$\scq$ maximal $\Llrta$ $\scp$ maximal.
\end{enumerate}
\end{lemma}
\begin{proof}
$(i)$ ``$\Lrta$'', Let $x\in \calb-\{0\}$. Write $x^n+a_1 x^{n-1}+...+a_n=0$ with $a_i\in\cala$ and $n$ minimal. Then $a_n\neq 0$, because otherwise we could cancel a factor of $x\neq 0$ to reduce $n$.

Then $x^{n-1}+a_1 x^{n-2}+...+a_n/x=0$ in $Frac(\calb)$. Then $\frac{1}{x}=-(x^{n-1}+a_1 x^{n-2}+...)/a_n\in \calb$ (because $\cala$ is a field $a_n\in\cala^\times$).

``$\Llta$'', $\calb$ is  field, $x\in\cala-\{0\}\subseteq\calb-\{0\}$, $1/x\in\calb$ is integral over $\cala$
$$
\left(\frac{1}{x}\right)^n+a_1 \left(\frac{1}{x}\right)^{n-1}+...+a_n=0
$$
with $a_i\in\cala$ and $n$ minimal. Multiply by $x^{n-1}$,
$$
\frac{1}{x}=-(a_1 +...+a_n x^{n-1})\in\cala
$$
$\Lrta\cala$ is a field.

$(ii)$:  $\calb/\scq$ is integral over $\cala/\scp$ by Lemma~\ref{lem:integral_lemma9} and then apply part $(i)$.

\end{proof}

\subsection{Lecture 22. Going-Up}
\begin{cor}
If $(\cala,\scm)$: local ring and $\cala\subseteq \calb$: integral extension, then 
$$
\{\text{primes $\scq$ of $\calb$ with $\scq\cap\cala=\scm$}\}=\{\text{maximal ideals in $\calb$}\}
$$
\end{cor}
\begin{proof}
$\subseteq$: $\scq\cap \cala$: maximal $\Lrta$ $\scq$ maximal by Lemma~\ref{integral_lemma12}.

$\supseteq$: $\scq$ maximal implies by Lemma~\ref{integral_lemma12}. $\scq\cap \cala$ maximal, $\scq\cap\cala=\scm$.
\end{proof}
\begin{dfn}
$\cala\subseteq \calb$, integral extensions, $\scq\in \text{Spec}(\calb)$ \textbf{lies over} $\scp\in \text{Spec}(\cala)$ iff $\scq\cap\cala=\scp$.
\end{dfn}
\begin{thm}\label{thm:integral_extension_goingup}
Let $\cala\subseteq \calb$ integral extensions:
\begin{enumerate}[label=(\roman*)]
\item (Maximality)  Let $\scq\subseteq \calb$ prime, and $\scp:=\scq^{c}=\scq\cap \cala$. prime (in $\cala$). Then 
$\scq$ maximal $\Llrta$ $\scp$ maximal. This has been proved in Lemma~\ref{integral_lemma12}, but we put it here for consistency.
\item (Lying-Over): Every  prime $\scp\subset\cala$ has some prime $\scq\subseteq \calb$ lying over it. (equivalently, then map $\text{Spec}(\calb)\lrta \text{Spec}(\cala)$: $\scq\mapsto \scq\cap \cala$ is surjective.)

\item (Incomparablity) The primes lying over a given prime satisfy no inclusion relations, i.e.,
$$
\left.
\begin{aligned}
&\scq,\scq'\in \text{Spec}(\calb)\\
& \scq\supseteq\scq', \scq\cap\cala=\scq'\cap\cala
\end{aligned}
\right\}\Lrta \scq=\scq'.
$$
Equivalently, if $\scq\supsetneq \scq'$ (primes in $\calb$), then $\scq\cap\cala\supsetneq \scq'\cap\cala$. The direction $\scq\cap\cala\supsetneq \scq'\cap\cala\Lrta \scq\supsetneq \scq'$ holds automatically, we have $\scq\cap\cala\supsetneq \scq'\cap\cala\Llrta \scq\supsetneq \scq'$. 
\item (Going-Up) For all $\scp,\scp'\in \text{Spec}(\cala),\scq\in \text{Spec}(\calb)$ s.t. $\scp\subseteq \scp',\scq\cap\cala=\scp$, \\
$\exists \scq'\in \text{Spec}(\calb)$ s.t. $\scq'\supseteq \scq,$ $\scq'\cap \cala=\scp'$
Equivalently, if we start with a chain 
$\scp=\scp_1\subseteq ....\subseteq \scp_n\in \text{Spec}(\cala)$ and a prime $\scq$ lying over $\scp$, then there exists a chain 
$\scq=\scq_1\subseteq ...\subseteq \scq_n\in \text{Spec}(\calb)$, s.t., $\scq_i\cap\cala=\scp_i$. 
Moreover, by ``Incomparablity'', if $\scp\subsetneq \scp'$, then $\scq\subsetneq \scq'$.
\end{enumerate}
\end{thm}

Equivalently,

\begin{cor}
$\cala\subseteq\calb$ integral extension, $\scb\subseteq\calb$ ideal, $\sca:=\scb\cap\cala$
\begin{enumerate}[label=(\roman*)]
\item $\text{dim}(\cala)=\text{dim}(\calb)$
\item $\text{dim}(\cala/\sca)= \text{dim}(\calb/\scb)$, i.e. $\text{coht}(\sca)=\text{coht}(\scb)$.
\item $\text{ht}(\scb)\leq \text{ht}(\sca)$.
\end{enumerate}
\begin{proof}\ \\
$(i)$\checkmark. In general ring morphism, for each (strictly inclusion) chain in $\calb$, there exists a (possibly not strictly inclusion) chain  in $\cala$. In the case of integral extension, the incomparability alone guarantees the strict inclusion of the chain in $\cala$. We know $\text{dim}(\cala)\geq \text{dim}(\calb)$. In return, the Going-Up+Incomparability guarantee $\text{dim}(\cala)\leq\text{dim}(\calb) $ \\ 
$(ii)$\checkmark. By Lemma~\ref{lem:integral_lemma9}, $\calb/\scb$ is integral over $\calb/\scb$ and $(ii)$ reduce to $(i)$.\\
$(iii)$. For primes $\scq\subsetneq\calb$ $\scp\subseteq \cala$ s.t. $\scq$ lies over $\scq$, we have $\text{ht}(\scp)\geq \text{ht}(\scq)$ because for each proper including chain of primes that ends with$\scq\subseteq\calb$, there exists a proper including chain of primes ending with $\scq\subseteq\cala$, where the proper inclusion is guaranteed by Incomparability. (We can not use Going-Up to argue $\text{ht}(\scp)\leq \text{ht}(\scq)$).

 $\text{ht}(\scb)\leq \text{ht}(\sca):=\inf_{\scp\supseteq \sca} \text{ht}(\scp)$ and $\text{ht}(\scp):=\sup\{t|\exists \scp_0\subsetneq...\subsetneq\scp_t=\scp\}$. 

\underline{Want}: if $\scp\supseteq \sca$, then $\text{ht}(\scp)\geq \text{ht}(\scb)$.

Given a prime $\scp\supseteq\sca$, then by Lying-Over,  $\exists\text{ prime } \scq\in\calb$ s.t. $\scq\cap\cala=\scp$. We may assume that $\scp\supseteq\sca$ is minimal, then by Incomparability $\scq\supseteq\scb$ is minimal.
$$
\text{ht}(\scp)\geq \text{ht}(\scq)\geq \text{ht}(\scb)
$$ 
\end{proof}
\end{cor}

\begin{proof}(of Theorem~\ref{thm:integral_extension_goingup})
{\color{red} the initial proof of Lying-Over in lecture used the term :``Let $\scp\in \text{Spec}(\cala)$. $\cala_\scp\subseteq\calb_\scp$ integral extension''. Here the $\scp$ is not necessarily prime in $\calb$, hence the notion $\calb_\scp$ should be replaced by $\varphi(S)^{-1}\calb$ where $S:=\cala-\scp$ and $\varphi$ is the inclusion map: $\cala\inj\calb$.}

Lying-Over:  

\[
\begin{tikzcd}
\scn\cap\calb=:\scq \arrow[r, Subseteq] \arrow[d, dash] & \calb \arrow[r, hook ] & \varphi(S)^{-1}\calb \arrow[r, Supseteq] & \exists\scn\text{ maximal }  \arrow[d,dash] \\
\scm\cap\cala=:\scp \arrow[r, Subseteq] & \cala \arrow[r, hook] \arrow[u, hook] & S^{-1}\cala \arrow[u, hook] \arrow[r, Supseteq] & \scm\text{ maximal} 
\end{tikzcd}
\]

$\scq:=\scn\cap\calb$ lies over $\scp$ because
$$
(\scn\cap\calb)\cap\cala=(\scn\cap\varphi(S)^{-1}\calb)\cap\cala=\scm\cap\cala=\scp 
$$

Incomparability: The construction above gives a bijection between
$$
\{\text{primes of $\calb$ lying over $\scp$}\}\llrta\{\text{primes of $\varphi(S)^{-1}\calb$ lying  over $\scm=S^{-1}\scp$}\}
$$
and by Lemma~\ref{integral_lemma12}, the later can be identified as
$$
\{\text{ maximal ideals in $\varphi(S)^{-1}\calb$ that lies over $\scm$}\},
$$
which is always incomparable.



Going up:
\[
\begin{tikzcd}
\scq\ar[r,Subseteq]\ar[d,dash] & \exists ?\scq'\ar[r, Subseteq]\ar[d,dash] & \calb\\
\scp\ar[r, Subseteq] & \scp'\ar[r, Subseteq] & \cala\ar[u, hook]
\end{tikzcd}
\]
Consider the prime $\scp'/\scp\subset\cala/\scp\subseteq\calb/\scq$, where the second inclusion is integral extension. By lying over, we can find a prime $Q\subseteq\calb/\scq$ lying over $\scp'/\scp$. Then $Q=\scq'/\scq$ for some $\scq'\in \text{Spec}(\calb)$
$$
\scp'/\scp=(\scq'/\scq)\cap(\cala/\scp)=\frac{\scq'\cap\cala}{\scq\cap\cala}=\frac{\scq'\cap\cala}{\scq}\Lrta \scp'=\scq'\cap\cala
$$
Then $\scq'$ lies over $\scp'$.
\end{proof}


\subsection{Lecture 23. Galois Transitivity and Going-Down}
In order to prove the Going-Down theorem, we digress for a while to discuss some facts in field theory.
\begin{dfn}
A \textbf{normal} extension $L/K$ of fields, is an extension s.t., each irreducible $f\in K[X]$ that has $\geq 1$ root in $L$ splits completely in $L$. (In other words, $L/K$ is  a union of ``splitting fields'')
\end{dfn}

\begin{dfn}
$L/K$ is \textbf{Galois} if it is normal and separable
\end{dfn}

\begin{dfn}
$L/K$ is \textbf{separable} if each $\alpha\in L$ is separable over $K$. i.e.,
$$
\# Hom_K(K(\alpha),\overline{K})=dim_K K(\alpha),
$$
(``$\leq$'' holds in general)
\end{dfn}
$\alpha\in L$ separable over $K$ is equivalent to ``the minimal polynomial $f\in K[X]$ for $\alpha$ ($f(\alpha)=0, deg(f)\text{minimal}$) has no repeated roots.''

N.b. $char(K)=0\Lrta$ every extension is separable.

\begin{ex}
$K=\bbf_p(t)$, $L:=K(t^{1/p^n})$ is not separable. In fact, it is purely inseparable: 
$$
\#Hom_K(K(\alpha),\overline{K})=1\ \forall \alpha\in L
$$
\underline{FACT}: let $L/K$ be a normal extension. Let $G:=Aut(L/K), L^G:=\{\alpha\in L:g(\alpha)=\alpha\forall g\in G\}$

\[
      \mathrlap{\overbrace{\phantom{Kaa \subseteq\ }}^{\text{purely insep}}}
      K\subseteq 
      \mathrlap{\underbrace{\phantom{L^G\subseteq\ \ \    }}_{\text{Galois}}}
       L^G\subseteq L.
\]
See GTM 211 for details.
\end{ex}




\begin{thm}\label{thm:normal_domain_normal_Galois}
Let $\cala$: normal domain, $K:=Frac(\cala)$.
Let $L/K$: normal extension of fields. Let $\calb:=$ integral closure of $\cala$ in $L$. Then $G:=Aut(L/K)$ acts transitively on the primes of $\calb$ lying over a given prime of $\cala$:
\begin{enumerate}[label=(\roman*)]
\item For each $g\in G$, the restriction of $g$ to $\calb$ induces a ring automorphism $g:\calb\overset{\sim}{\lrta}\calb$

\item $\forall g\in G, \scq\in \text{Spec}(\calb)\Lrta g(\scq)\in \text{Spec}(\calb)$ and $\scq\cap\cala=g(\scq)\cap\cala$.

\item $\forall \scq,\scq'\in \text{Spec}(\calb)$ with $\scq\cap\cala=\scq'\cap\cala$, $\exists g\in G$, s.t. $g(\scq)=\scq'$:
\end{enumerate}
\end{thm}

\begin{proof}\ 
\begin{enumerate}[label=(\roman*)]
\item Let $x\in\calb$, $g\in G$\\
\underline{Want}: $g(x)\in\calb$:\\
Indeed, write
$$
x^n+a_1 x^{n-1}+...+a_n=0,\ a_i\in\cala,
$$ 
then
$$
\begin{aligned}
0&=g(x^n+a_1 x^{n-1}+...+a_n)\\
&=g(x)^n+g(a_1)g(x)^{n-1}+..+g(a_n)\\
&=g(x)^n+a_1g(x)^{n-1}+...+a_n \ \ (\text{$g$ fixes $K\supseteq \cala$})
\end{aligned}
$$
$\Lrta g(x)\in\calb$.

We have shown that $g\in Aut(L/K)$ satisfies $g(\calb)\subset\calb\forall g\in\in G$. True also for $g^{-1}$. Then we know after restricting to $\calb$ $g\circ g^{-1}$ and $g^{-1}\circ g$ are also identities. $Aut(L/K)$ restricts to a group of ring automorphism.

\item Let $g\in G$, $\scq\in\text{Spec}(\calb)$. $g$ restrict to a ring morphism then $g(\scq)=(g^{-1})^{-1}(\scq)$ always prime $g(\scq)\in\calb$. Also $\scq\cap\cala=g(\scq\cap\cala)=g(\scq)\cap g(\cala)=g(\scq)\cap\cala$ because $g$ fixes $\cala$.

\item $(a)$ Assume first that $L/K$ finite, then $\#G<\infty$. Let $\scq,\scq'\in \text{Spec}(\calb)$ with $\scq\cap\cala=\scp=\scq'\cap\cala$. 

\underline{Claim}:
$$
\scq'\subseteq\cup_{g\in G}g(\scq).
$$
By prime avoidance~\ref{prop:prime_avoidance}, the claim $\Lrta$ $\exists g\in G,\scq\subseteq g(\scq)$ both lying over $\scq$ (by part $(ii)$), then by incomparability~\ref{thm:integral_extension_goingup} we know $\scq'=g(\scq)$, as desired.

\underline{Proof of the claim}: Let $x\in \scq'$. Set $y:=\prod_{g\in G}g(x)\in L^G$.
By Galois theory, $\exists n\geq 1$ s.t. $y^n\in K$. Moreover, since each $g(x)\in\calb$, and $\calb:$ integral over $\cala$, we see that $y^n$ is integral over $\cala$ and belongs to $K$. (It is an integral element in $\text{Frac}(\cala)$). Since $\cala$ is normal, we get that $y^n\in \cala\cap\scq'=\scq\cap\cala$.

Since $\scq$ is prime, and $y^n=\prod_{g\in G}g(x)^n$, deduce that $g(x)\in\scq$ for some $g\in G$. \textbf{Notice that this step relies on the finiteness of $\#G$}\\
 Hence, we know $x\in g^{-1}(\scq)$. Thus $\scq'\subseteq \cup_{g\in G}g^{-1}(\scq)=\cup_{g\in G}g(\scq)$ as claimed.

This completes the proof of $(iii)$ in the case that $L/K$ is finite.

$(b)$ For the infinite case.

Recall the \textbf{Zorn's Lemma}: In a nonempty partially ordered set $(A,\leq) $ in which each chain $C\subseteq A$ has an upper bound in $A$, then there is a maximal element.

We will use this to deduce the infinite case from the finite case. Consider a subextension $L/E/K$, with $E/K$ normal. Then $R_E:=\calb\cap E$ is the integral closure of $A$ in $E$. $\scq_1\cap R_E=\scq_1\cap E$ and $\scq_2\cap R_E=\scq_2\cap E$ are primes of $R_E$ that lies over $\scp$
$$
A:=\left\{
\begin{aligned}
(E,g):& E \text{ as above }\\
& g\in Aut(E/K)\\
&\text{s.t. } g(\scq\cap E)=\scq_2\cap E
\end{aligned}
\right\}
$$
define an order on $A$:

 $(E,q)\leq (E',g')$ iff $E\subseteq E', g'|_E=g$

\underline{Want}: $\exists g\in Aut(L/K)$ s.t. $(L,g)\in A$ 

$A\neq \emptyset\Llta$ $(K,id) \in A$. Let $C=\{(E_i,g_i)\}_{i\in I}\subseteq A$ be a chain, where $i\leq j\Lrta (E_i,g_i)\leq (E_j,g_j)$.

Then $C$ has an upper bound $(E,g)\in A$
$$
\left\{
\begin{aligned}
& E:=\cup_i E_i\\
& \exists ! g\in Aut(E/K)\\
& \text{ s.t. } g|_{E_j}=g_j
\end{aligned}
\right.
$$
Thus by Zorn's lemma, $\exists $ maximal $(E,g)\in A$. 

\underline{Claim}: $E=L$.

If not. then $\exists $ finite normal extension $E'/E$ with $E'\subseteq L$ and $E'\supsetneq E.$ (Take any $\alpha\in L$, $\alpha\notin E$. Let $f\in E[X]$ be the minimal polynomial of $\alpha$ over $E$. Take $E':=$ field obtained by adjoining to $E$ all roots of $f$ in $L$.)

{\tiny
\[
\begin{tikzcd}
\scq_1\ar[d,dash] & & & & \scq_2\ar[d,dash]\ar[r,Subseteq] & \calb\ar[r,Subseteq] & L\\
\scq_1\cap E'\ar[rrrr, "g'", bend left]\ar[rr,"\tilde{g}"]\ar[dr,dash] & & \tilde{g}(\scq\cap E')\ar[rr,"\exists\sigma"]\ar[dr,dash] & & \scq_2\cap E'\ar[r,Subseteq]\ar[dl,dash] & R_{E'}\ar[r,Subseteq]\ar[u,Subseteq] & E'\ar[u,Subseteq]\\
& \scq_1\cap E\ar[rr,"g"]\ar[dr,dash] & & \scq_2\cap E\ar[rr,Subseteq]\ar[dl,dash] & & R_E\ar[r,Subseteq]\ar[u,Subseteq] & E\ar[u,Subseteq]\\
& & \scp & & & \cala\ar[r,Subseteq]\ar[u,Subseteq] & K\ar[u,Subseteq]
\end{tikzcd}
\]
}
Let $\tilde{g}\in Aut(E'/K)$ be any extension of $g$ (such $\tilde{g} $ exists).\\
Then $\tilde{g}(\scq_1\cap E')$ lies over $\scq_2\cap E$.\\
Since theorem holds for $E'/E$ (finite normal extension), $\exists \sigma \in Aut(E'/E)$ s.t. $\sigma(\tilde{g}(\scq_1\cap E'))=\scq_2\cap E'$.\\
 Set $g':=\sigma\circ \tilde{g}\in Aut(E'/K)$. Clearly, $g'(\scq_1\cap E')=\scq_2\cap E'$, so $(E',g')\in A$. Also, $E\subsetneq E'$ and $g'|E=g$, which contradict the maximality of $(E,g)$
\end{enumerate}
\end{proof}
Then let's talk about the so called going-down property.
\begin{dfn}
Let $\cala\subseteq \calb$ are rings. We say that $\cala\subseteq \calb$ has property \textbf{Going-Down} (GD) if 
$$
\forall \text{ primes, } \scp'\subsetneq \scp\subset \cala, \scq\subset\calb 
$$
with $\scq\cap \cala=\scp$, $\exists $ prime $\scq'\subsetneq \scq$ with $\scq'\cap\cala=\scp'$
\[
\begin{tikzcd}
\exists\scq'\ar[r,Subsetneq]\ar[d,dash] & \scq\ar[r, Subsetneq]\ar[d,dash] & \calb\\
\scp'\ar[r, Subsetneq] & \scp\ar[r, Subsetneq] & \cala\ar[u, Subseteq]
\end{tikzcd}
\]
\end{dfn}
See P239 of Eisenbud or 32-33
 of Matsumura for a non-example.

\begin{thm}\label{thm:normal_domain_goingdown}(Going-Down for integral extension over normal ring)
Let $\cala\subseteq \calb$ be domains with $\cala$ normal, $\calb$ integral over $\cala$. Then $\cala\subseteq \calb$ has Going-Down property.
\end{thm}
\begin{proof}
Let $K:=Frac(\cala)$, $L_1:=Frac(\calb)$. $\Lrta $ $L_1$ is integral over $K$ as rings by Lemma~\ref{integral_lemma12}, equivalently $L/K$ is algebraic field extension.  

Let $L$ be any normal algebraic extension of $K$, that contains $L_1$ (e.g., $L=\overline{K}\supseteq L_1$) (e.g., $L:=$``normal closure of $L_1$ in $\overline{K}\supseteq L_1$'')

Hence $x,y$ belong to a finite extension of $K$ $\Llrta$ $x,y$ algebraic over $K$, $\Lrta x/y$ algebraic over $K$.

Let $\calc:=(\text{ integral closure of $\cala$ in $L$})$=$(\text{integral closure of $\calb$ in $L$})$

\[
\begin{tikzcd}
{\color{blue}Q'}\ar[r,orange, Subsetneq]\ar[dd,dash,bend right, blue]& {\color{orange}Q_1}\ar[ddr,orange,dash]\ar[r,"\text{\tiny{$\exists g\in Aut(L/K)$}}"] &{\color{green}Q}\ar[d,dash,green] & \calc \arrow[r,Subseteq]  & L \\
{\color{red}\exists \scq':=g(Q')\cap\calb}\ar[d,dash,red,"?"]\ar[rr, Subsetneq, red,"?"]&  &\scq&\calb \arrow[r,Subseteq] \arrow[u,Subseteq] & L_1 \arrow[u,Subseteq] \\
\scp'\ar[rr, Subsetneq]& &\scp\ar[u,dash] & \cala \arrow[r,Subseteq] \arrow[u,Subseteq] & K\arrow[u,Subseteq] \\
\end{tikzcd}
\]
Let $Q'\subseteq\calc$ lies over $\scp'$, it exists by Lying-Over.\\
Let $Q_1\subseteq\calc$ lies over $\scp$, with $Q_1\supseteq Q'$. It exists by Going-Up.\\
Let $Q\subseteq\calc$ lies over $\scq$, it exists by Lying over. 

Notice that both $Q$ and $Q_1$ lies over $\scp$, by Theorem~\ref{thm:normal_domain_normal_Galois}, $\exists g\in\text{Aut}(L/K)$ s.t. $g(Q_1)=Q$.

$Q'\subsetneq Q_1\Lrta g(Q')\subsetneq Q_1$\\
$\Lrta \scq'= g(Q')\cap\calb\subsetneq g(Q_1)\cap\calb=\scq$ by Incomparability.

Note that $g$ fixes $\cala$ so $\scq'\cap \cala=(g(Q')\cap \calb)\cap\cala=g(Q')\cap \cala=g(Q'\cap \cala)=g(\scp')=\scp'$.
\end{proof}

As an application of Going-Down. Recall $\forall \cala\subseteq \calb$ integral, $\forall \scb\subseteq \calb,\sca\subseteq \cala\cap \scb$
\begin{enumerate}[label=(\roman*)]
\item $\text{dim}(\cala)=\text{dim}(\calb)$
\item $\text{dim}(\cala/\sca)=\text{dim}(\calb/\scb)$, i.e., $
\text{coht}(\sca)=\text{coht}(\scb)$
\item $\text{ht}(\scb)\leq \text{ht}(\sca)$.
\end{enumerate}
\begin{cor}
Suppose $\cala\subseteq \calb$ are domains, with $\cala$ noraml, $\calb$ integral over $\cala$. Let $\scb\subseteq \calb$, $\sca=\cala\cap \scb$. Then $\text{ht}(\sca)=\text{ht}(\scb)$.
\end{cor}
\begin{proof}
\underline{Want}: $\text{ht}(\scb)\overset{?}{\geq} \text{ht}(\sca)$, where $\text{ht}(\scb)=\inf_{\scq\supseteq \scb} \text{ht}(\scq)$ and  $\text{ht}(\sca)=\inf_{\scp\supseteq \sca} \text{ht}(\scp)$.

It suffices to show for each prime $\scq\subset\scb$ that $\scp:=\scq\cap \cala\supseteq \sca$ satisfies $\text{ht}(\scq)\geq \text{ht}(\scp)$. Let $\scp_0\subsetneq ...\subsetneq \scp_r=\scp$ be a chain of primes. By the going-down property, there exists a chain of primes $\scq_0\subsetneq ...\subsetneq \scq_r=\scq$ in $\calb$ such that $\scq_i$ lies over $\scp_i$

$\Lrta \text{ht}(\scq)\geq r$. Since $\text{ht}(\scp)=\sup\{\text{r as above}\}$, we then conclude that $\text{ht}(\scq)\geq \text{ht}(\scp)$.
\end{proof}

\subsection{Lecture 24. Noether Normalization Theorem}

\begin{dfn}
``$k$-domain $\cala$'' ($k$ is a field and $\cala$ is a $k$-algebra as well as a domain)

\textbf{finitely generated $k$-domain} means a $k$-domain which is a finitely generated as $k$-algebra
$\Llrta$ $\cala\cong k[X_1,...,X_n]/\sca$ for some $\sca$, $n$ $\Lrta \text{dim}(\cala)\leq n$
\end{dfn}

\begin{thm}\label{thm:Noether_Normalization}(Noether Normalization)
Let $\cala$ finitely generated $k$-algebra. Set $d:=\text{dim}(\cala)\in \intg_{\geq 0}$. Then there exists an injective morphism of $k$-algebras
$$
k[X]:=k[X_1,..,X_d]\overset{\kappa}{\inj} \cala
$$
which is integral: $\cala$ is integral over $\kappa(k[X])$.
\end{thm}

N.b. $\kappa$ is determined by $x_1:=\kappa(X_1),...,x_n:=\kappa(X_d)\in\cala$. $\kappa $ is injective $\Llrta$ $x_1,...,x_d\in \cala$ are algebraically independent over $k$.  So the theorem says : $\exists$ algebraically independent $x_1,..,x_d\in \cala$ s.t., $\cala$ is integral over the $k$-algebra $\cala_0:=k[x_1,...,x_d]\subseteq \cala$.
\begin{cor}\label{cor:k-domain_dim_tr.deg}
Let $\cala$ finitely generated $k$-domains, then $K:=Frac(\cala)$. Then $\text{dim}(\cala)=tr.deg_k(K)$
\end{cor}
\begin{proof} of Corollary~\ref{cor:k-domain_dim_tr.deg}. Let $d:=\text{dim}(\cala)$ $\cala_0=k[x_1,..,x_d]$ as above. 
$K_0=Frac(\cala_0)\cong k(x_1,...,x_d)$

$\cala$: integral over $\cala_0$ $\Lrta$ $K$ algebraic over $K_0$ (Confer the proof of Theorem 2 today).

$\Lrta tr.deg_k(K)=tr.deg_k(K_0)=d=\text{dim}(\cala)$.
\end{proof}
N.b., If $\kappa: k[X_1,...,X_n]\lrta\cala$ is injective and integral, then automatically $n=\text{dim}(\cala)$, because we have seen that integral extension preserves dimension.

First, we give a key lemma for Noether Normalization (NN).
\begin{lemma}\label{lem:key_lemma_noether_normalization}
Let $\cala$ be a $k$-algebra, with $x_1,..,x_n\in \cala$, $0\neq f\in k[X_1,..,X_n]$ where $k[X_1,..,X_n]$ is the free polynomial ring. $w:=f(x_1,..,x_n)\in k[x_1,...,x_n]\subseteq \cala$. Then $\exists z_1,..,z_{n-1}\in k[x_1,..,x_n]$ s.t. $k[x_1,...,x_n]$ is integral over $k[z_1,..,z_{n-1},w]$.
\end{lemma}

And we have to give some motivation for this key lemma in that the lemma indicates the NN:
\begin{proof}(Lemma~\ref{lem:key_lemma_noether_normalization}$\Lrta$ NN~\ref{thm:Noether_Normalization}) $\cala$ is finitely generated $k$-algebra, say $\cala$ generated by $x_1,...,x_n$. If $x_1,...,x_n$ are algebraic independent, then done: $\cala=k[x_1,..,x_n]$. 

Else $\exists 0\neq f\in k[X_1,..,X_n]$ s.t. $0=f(x_1,..,x_n)$, then by the key lemma (here $w=0$), $\exists z_1,..,z_{n-1}$ s.t. $k[x_1,...,x_n]$ integral over $k[z_1,..,z_{n-1}]$. Iterate finitely many times: $\cala$ is integral over $k[u_1,...,u_d]$, where $u_1,..,u_d$ are algebraic independent, $d\leq n-1$. 
\end{proof}

For pedagogical reason, we start with a Baby case
(Baby case, $n=2,w=0$) $\cala=k[X,Y]/(f)$ for some $0\neq f\in k[X,Y]$. $x,y$ are images of $X,Y$, thus $0=f(x,y)$. 

\underline{Want} $\exists z\in \cala$ s.t. $\cala$ is integral over $k[z]$.

\begin{ex}
For example, we can choose $f=XY-1$ $(\Lrta xy=1,y=1/x)$. Then $\cala$ \underline{Not} integral over $k[x]$. Thus the choice $z=x$ doesn't work.
$$
k[X]\cong k[x]\subsetneq \cala=\frac{k[X,Y]}{XY-1}\cong k\left[x,\frac{1}{x}\right]\cong k(x)\cong k(X).
$$

$k[X]$ is normal because it is UFD, hence it is integrally closed in $k(X)$ $\Lrta$ $\cala$ is \underline{NOT} integral over $k(x)$. ($y$ is algebraic over $k[x]$ but not integral over $k[x]$.)

Similarly, $\cala$ is not integral over $k[y]$.

But if we choose $z=y-ax$, then
$$
zx=-ax^2+xy=-ax^2+1
$$
$$
-ax^2-zx+1=0
$$
$\Lrta \cala=k[x,z]$ is integral over $k[z], \forall a\in k, a\neq 0$.

We have also a geometric interpretion of the above example:
$\text{Spec}(\cala)=\{(x,y): xy=1\}$, by the lying-over properties of integral extensions in Theorem~\ref{thm:integral_extension_goingup}, we know there should be a surjective map from $\text{Spec}(\cala)$ to $\text{Spec}(k[z])$
{\centering
\begin{tikzpicture}
    \begin{axis}
        \addplot [red,thick,domain=0.2:5] ({x},{1/x});
        \addplot [red,thick,domain=-5:-0.2] ({x},{1/x});
        \addplot [blue, thick, domain=-1.5:1.5] ({x},{3*x});
    \end{axis}
\end{tikzpicture}
\begin{tikzpicture}
    \begin{axis}
        \addplot [red,thick,domain=0.2:5] ({x},{1/x});
        \addplot [red,thick,domain=-5:-0.2] ({x},{1/x});
        \addplot [blue, thick, domain=-1.5:1.5] ({x},{-3*x});
    \end{axis}
\end{tikzpicture}
}


{\color{red} The general surjective map looks like $(x-c_0,y-d_0)\longmapsto (x-c_0,y-d_0)\cap k[z]=(z-d_0+a c_0) $, it should be interpreted as the projection along blue line to $y$-axis. However when we choose $a<0$, although $k[x,z]$ is still integral over $k[z]$, this geometric interpretation fails because the correspondence between maximals and points relies on the Hilbert Nullstellensatz which requires the the field to be algebraically closed. }
\end{ex}

The above simple example gives us implication for the proof of the baby case:
\begin{lemma}
In the context of Baby case, $\cala=k[X,Y]/(f)$ write $f=f_n+...+f_0$. where $f_i$ homogeneous of degree $i$ and $f_n\neq 0$. If $Y-aX\nmid f_n$, $a\in k$. Then $\cala$ is integral over $k[y-ax]$
\end{lemma}
\begin{proof}
By substituting $X':=X$, $Y':=Y-aX$, reduce to the case $a=0$.

If $Y\nmid f_n$, then $f_n=X^{n}+(\text{lower powers in $X$ with coefficients in $Y$})$. Then $f(x,y)=0\Lrta$ $x^n+(\text{lower powers in $x$ with coefficients in $y$})$. Then we know $\cala=k[X,Y]/(f)=k[x,y]$ is integral over $k[y]$.
\end{proof}
\begin{cor}
If $k$ is infinite, then Baby case holds.
\end{cor}
\begin{proof}
By the above lemma, it suffices to find $a\in k$ s.t. $Y-aX\nmid f_n$. Over $\overline{k}$, $f_n=\prod_{i=1...,n} (\alpha_i X-\beta_i Y)$ $\alpha_i,\beta_i\in \overline{k}$ not both zero. 

Just need that $a\neq \alpha_i/\beta_i\forall i$. This is always possible because $k$ is infinite.
\end{proof}

How about finite $k$?

\begin{ex}
$k=\bbf_2$, $f=Y(Y-X)-1$, denote $f_2=Y(Y-X)$ Then $Y-aX|f_2\ \forall a\in k$ so previous strategy fails. ( in fact $\cala$ is not integral over $k[y-ax]$ for all $a$)

Try $z:y-x^s$, $s\in \intg_{\geq 0}$. Say $s\geq 2$.

$0=f(x,y)=f(x,x^s+z)=(x^s+z)(x^s+z-x)-1$

$\Lrta 0=x^{2s}+(....)$ the $(...)$ are of lower order in $x$ with coefficients in $z$

$\Lrta x$ integral over $k[z]\Lrta\cala=k[x,z]$ is integral over $k[z]$. This choice works for any $f\neq 0$ if $s$ is large enough in terms of $f$.
\end{ex}

\begin{proof}(of key lemma~\ref{lem:key_lemma_noether_normalization} due to Nagata)
Write $f=\sum_{\alpha\in I}c_\alpha X^\alpha$, where $c_\alpha\in k^\times$ and $X^\alpha:=X_1^{\alpha_1}\cdot\cdot \cdot X^{\alpha_n}_n$. For some finite $I\subseteq \intg_{\geq }^n$. Choose $z_j:=x_j-x^{s_j}_n$ for $j=1,...,n-1$, where $s_j\in \intg_{\geq 0}$ to be chosen later.

Then $x_j=x^{s_j}_n+z_j$, so
$$
\begin{aligned}
w&=f(x_1,...,x_n)=f(x_n^{s_1}+z_1,...,x_n^{s_{n-1}}+z_{n-1},x_n)\\
&=\sum_{\alpha\in I}c_\alpha (x^{s_1}_n+z_1)^{\alpha_1}\cdot\cdot \cdot (x_n^{s_{n-1}}+z_{n-1})^{\alpha_{n-1}}x_n^{\alpha_n}\\
& \text{where each power equals } x_n^{s_j\alpha_j}+(...) \text{ lower powers with coefficients in $z_j$}\\
&=\sum_{\alpha\in I}c_\alpha x_n^{l(\alpha)}+(...),\ \ \ l(\alpha):=s_1\alpha_1+...+s_{n-1}\alpha_{n-1}+\alpha_n,\\ 
&\text{ where $(...)$ are of lower powers in $x_n$ with coefficients in $k[z_1,..,z_{n-1}]$}
\end{aligned}
$$
To make sure the leading term does not cancel out, we need
\underline{Sublemma:} $\exists (s_1,...,s_{n-1})$ s.t., $\forall, \alpha,\beta\in I$
\begin{equation}\tag*{(*)}
\alpha\neq \beta\Lrta l(\alpha)\neq l(\beta)
\end{equation}

\underline{Proof1}: Take $s_j=s^j$, where $s:=\max\{|\alpha_j|+1|\alpha\in I, j=1,...,n\}$.

\underline{Proof2}: $(*)$ basically says that $(s_1,...,s_{n-1})$ have to avoid finitely many proper subspaces of $\ratl^{n-1}$, which is always possible, because finite union of proper subspaces can not be the vector space it self.

Choose $s$ as in sublemma. Choose $\alpha\in I$ s.t. $l(\alpha)$ maximal. Then $w=c_\alpha x_n^{l(\alpha)}+(...)$

$\Lrta x_n$ is integral over $k[z_1,...,z_{n-1},w]$

$\Lrta$ each $x_{j}=x_n^{s_j}+z_j$ is integral over $k[z_1,...,z_{n-1},w]$

$\Lrta k[x_1,...,x_n]$ is integral over $k[z_1,...,z_{n-1},w]$.
\end{proof}

The above proved the key Lemma~\ref{lem:key_lemma_noether_normalization} thus the Noether Normalization~\ref{thm:Noether_Normalization}.

\begin{thm}\label{thm:finitelygeneratedk-domain_dim_equality}
Let $\cala$ be finitely generated $k$-domain, $\scp\in \text{Spec}(\cala)$. Then $\text{ht}(\scp)+\text{coht}(\scp)=\text{ht}(\scp)+\text{dim}(\cala/\scp)=\text{dim}(\cala)$
\end{thm}
\begin{proof}
Set $n:=\text{dim}(\cala)$. $\text{NN}$~\ref{thm:Noether_Normalization}$\Lrta\exists x_1,..,x_n\in\cala$ algebraic independent s.t. $\cala$ is integral over $\cala_0:=k[x_1,..,x_n]\cong k[X_1,..,X_n]$.

$\cala_0$ is UFD $\Lrta$ $\cala_0$ is normal.

Both $\cala_0$  $\cala$  are domains and $\cala_0\subseteq \cala$ is an integral extension. So by the Going-Down properties~\ref{thm:normal_domain_goingdown} , we have 
$$
\scp_0:=\cala_0\cap\scp\in \text{Spec}(\cala_0)
$$
that 
$\text{ht}(\scp)=\text{ht}(\scp_0)$, $\text{coht}(\scp)=\text{coht}(\scp_0)$, 
$\text{dim}(\cala)=\text{dim}(\cala_0)$. Thus by replacing $\cala$ by $\cala_0$, we may assume $\cala=k[X_1,...,X_n]$. (And now our problem reduces to understanding $\text{Spec}(k[X_1,...,X_n])$)

If $\scp=(0)$, then we are done: $\text{ht}(\scp)=0$, $\text{coht}(\scp)=\text{dim}(\cala)$. 

So we may assume $\scp\neq (0)$.
Suppose a special case where $\scp\ni X_n$. Then $\scp\supseteq (X_n)$. 

Set $\overline{\cala}:=\cala/(X_n)\cong k[X_1,...,X_{n-1}]$, $\overline{\scp}:=\scp/(X_n)$.

Then $0\subsetneq (X_n)\subseteq \scp$, so $\text{ht}(\scp)\geq \text{ht}(\overline{\scp})+1$.
(Given $(0)=\overline{\scq_0}\subsetneq ...\subsetneq \overline{\scq_r}=\overline{\scp}$, get $(0)\subsetneq (X_n)=\scq_0\subsetneq...\subsetneq \scq_r=\scp $)

Also $\text{coht}(\overline{\scp})=\text{dim}(\overline{\cala})=\text{coht}(\overline{\scp})$,

 $\text{dim}(\overline{\cala})=n-1=\text{dim}(\cala)-1$.

In general $\text{ht}(\scp)+\text{coht}(\scp)\leq \text{dim}(\cala)$ holds trivially. so we just need to show
 $$\text{ht}(\scp)+\text{coht}(\scp)\geq \text{dim}(\cala),$$
  where $\text{ht}(\scp)\geq \text{ht}(\overline{\scp})+1$, $\text{coht}(\scp)=\text{coht}(\overline{\scp})$ and $\text{dim}(\cala)=\text{dim}(\overline{\cala})+1$. (If we are able to show $\text{ht}(\overline{\scp})+\text{coht}(\overline{\scp})\geq \text{dim}(\overline{\cala})$, we are done)

So we can argue by induction on $n$ in the special case $X_n\in \scp$. 

We now reduce the general case to this one.
Choose any $0\neq f\in \scp$. By the key lemma~\ref{lem:key_lemma_noether_normalization} for NN, $\exists z_1,...,z_{n-1}\in\cala=k[x_1,...,x_n]$, s.t. $\cala$ integral over $\cala_0:=k[z_1,...,z_{n-1},z_n]$, where $z_n:=f(x_1,...,x_n)$. Then $\text{tr.deg}_k (\text{Frac}(\cala_0))=\text{tr.deg}_k(\text{Frac}(\cala))=n$, so $\{z_j\}$ are algebraically independent. Thus $\cala_0$ is again a polynomial ring, hence $\cala_0$ is normal.

By arguing as in the beginning of the proof, we have with $\scp_0:=\scp\cap\cala_0$ that $\text{dim}(\cala_0)=\text{dim}(\cala)$, $\text{coht}(\scp_0)=\text{coht}(\scp)$, $\text{ht}(\scp_0)=\text{ht}(\scp)$. So it suffices to show that $\text{coht}(\scp_0)+\text{ht}(\scp_0)\geq \text{dim}(\cala_0)$. 

But now $f\in\scp\Lrta z_n\in\scp_0$, so we reduce to the special case $x_n\in\scp$. Argued as above. 
\end{proof}

\begin{lemma}
$\cala$ is finitely generated $k$-domain. Let $\scp\subsetneq \scp'$ be ``adjacent primes''i.e., no primes contained in between. Then 
$$
\text{ht}(\scp')=\text{ht}(\scp)+1
$$
\end{lemma}
\begin{proof}
Apply previous theorem to $(\cala,\scp)$, $(\cala,\scp')$ and $(\overline{\cala},\overline{\scp'}),$ where $\overline{\cala}=\cala/\scp$ and $\overline{\scp'}=\scp'/\scp$. Hypothesis that $\scp$, $\scp'$``adjacent'' $\Lrta \text{ht}(\overline{\scp'})=1$.
Then by Theorem~\ref{thm:finitelygeneratedk-domain_dim_equality}
$$
\text{ht}(\scp)+\text{coht}(\scp)=\text{ht}(\scp)+\text{dim}(\overline{\cala})=\text{dim}(\cala)
$$
$$
\text{ht}(\scp')+\text{coht}(\scp')=\text{ht}(\scp')+\text{coht}(\overline{\scp'})=\text{dim}(\cala)
$$
$$
\text{ht}(\overline{\scp'})+\text{coht}(\overline{\scp'})=\text{dim}(\overline{\cala})
$$
Then
$$
\text{ht}(\scp')-1=\text{ht}(\scp')-\text{ht}(\overline{\scp}')=\text{dim}(\cala)-\text{dim}(\overline{\cala})=\text{ht}(\scp)
$$.
\end{proof}


Recall what we have know about the dimension theory of finitely generated $k$-domain. $\forall k$ field, $\cala$ a finitely generated $k$-domain, then
\begin{enumerate}[label=(\roman*)]
\item $\text{dim}(\cala)=tr.deg_k(K),$ where $K:=Frac(\cala)$
\item $\text{ht}(\scp)+\text{coht}(\scp)=\text{dim}(\cala),\forall \scp\in \text{Spec}(\cala)$
\item $\text{ht}(\scm)=\text{dim}(\cala),\forall \scm$ maximal
\item If $\scp\subsetneq \scp'$ are adjacent,,i.e., $\text{ht}(\scp'/\scp)=1$, then $\text{ht}(\scp')=\text{ht}(\scp)+1$
\end{enumerate}

\begin{cor}
If $\cala$ is  finitely generated $k$-domain. Every maximal chain of primes in $\cala$ has length $\text{dim}(\cala)$. That is to say: if $\scp_0\subsetneq ...\subsetneq \scp_r\subset \cala$ is a chain of primes that cannot be enlarged, then $r=\text{dim}(\cala)$.
\end{cor}
The above corollary is false for general rings $\cala$. See the exercises, Matsumura, the keyword is \textbf{``Catenary''}
\begin{proof}
Maximality of the chain implies: $\scp_0=(0)\Lrta \text{ht}(\scp_0)=0$ and $\scp_r$ maximal $\Lrta \text{ht}(\scp_r)=\text{dim}(\cala)$. Also $\forall \text{ht}(\scp_i/\scp_{i-1})=1\Lrta \text{ht}(\scp_i)=\text{ht}(\scp_{i-1})+1$ $\Lrta \text{dim}(\cala)=\text{ht}(\scp_r)-\text{ht}(\scp_0)$.

Note that this Corollary implies $(ii),(iii),(iv)$
\end{proof} 

\begin{cor}
(Another proof of Zariski's Lemma~\ref{thm:finite_field_extension} thus the Nullstellensatz~\ref{cor:Nullstellensatz}) Let $K/k$ be field extension s.t. $K$ is finitely generated $k$-algebra, then $K/k$ is finite.
\end{cor}
\begin{proof}
It suffices to show that $K/k$ is algebraic (i.e.,integral) because by~\ref{lem:integral_lemma5} integral +finitely generated $\Llrta$ finite. That is, we want $tr.deg_k(K)=0$. But $tr.deg_k(K)=\text{dim}(K)=0$.
\end{proof}


\section{Valuation Rings and Normality}
\subsection{Lecture 25. Valuation}
Recall the proof that the ring $\cala:=k[X,Y]/(XY-1)$ is not integral over $k[x]$. We denote by $x,y$ the image of $X,Y$ in $\cala$.

We embed 
$$\cala\inj k(X)$$
$$
x,y\longmapsto X,1/X
$$
We then argued that $k[X]$ is normal, hence that $\cala \cong k[X,1/X]$ is Not integral over $k[X]$.

Here, we will give another proof.
\begin{dfn}
Any $0\neq f\in\cala$ may be written in the form
$$
a_{-n}X^{-n}+...+a_m X^{m},
$$
where $a_j\in k, a_{-n}\neq 0$.

Set $v(f):={-n}\in \intg$.
Note:
\begin{enumerate}
\item 
$
v(f_1f_2)=v(f_1)+v(f_2)
$
\item $v(f_1+f_2)\geq min(v(f_1),v(f_2))$, if $v(f_1)\neq v(f_2)$, then $v(f_1+f_2)=\min (v(f_1),v(f_2))$
\end{enumerate}

Now suppose that $f\in k[X,1/X]$, and $f\notin k[X]$. Then $v(f)\leq -1$, but 
$$
f^n+a_1 f^{n-1}+...a_0=0
$$
with $a_{j}\in k[X]$. Note $v(a_j)\geq 0$\\
$\Lrta v(a_j f^{n-j})\geq v(f^{n-j})=(n-j)v(f)\leq -1$\\
$\Lrta v(f^n)=nv(f)< v(a_1 f^{n-1}+....+a_n)$, contradicting to $f^n+a_1 f^{n-1}+..+a_n=0$.
\end{dfn}

\begin{dfn}
Let $K$ be a field, $(G,0, +,\leq)$ totally ordered abelian group e.g. $( G=\intg)$. A map $v:K^\times\lrta G$ is called a \textbf{valuation} if it satisfies the property
\begin{enumerate}
\item 
$
v(f_1f_2)=v(f_1)+v(f_2)
$
\item $v(f_1+f_2)\geq min(v(f_1),v(f_2))$,\\ if $v(f_1)\neq v(f_2)$, then $v(f_1+f_2)=\min (v(f_1),v(f_2))$
\end{enumerate}
In that case, the set $\cala:=\{x\in K^\times:v(x)\geq 0\}\cup \{0\}$ is a subring of $K$, called the \textbf{valuation ring of $v$}.
\end{dfn}

\begin{lemma}
The set $\scm:=\{x\in K^\times:v(x)> 0\}\cup \{0\}$ is a maximal ideal of $\cala$ and $(\cala,\scm)$ is a local ring with $\cala^\times=\{x\in K^\times:v(x)=0\}$
\end{lemma}
\begin{proof}
$x\in K^\times \cap \cala$, $v(x)=0$, $\Lrta v(1/x)+v(x)=v(1)=0\Lrta v(1/x)=0$.

$\Lrta 1/x\in \cala$, so $x\in \cala^\times.\Lrta (\cala,\scm)$ is local ($\Llta \cala-\scm\subseteq\cala^\times$~\ref{prop:local_ring_maximal})

\end{proof}


\begin{dfn}
($K$: field), We say that a subring $\cala\subseteq K$ is a \textbf{valuation ring} if $\exists $ valuation $v:K^\times\lrta G$ s.t. $\cala$ is the valuation ring of $v$. We call $G$ the \textbf{valuation group of $v$}.
\end{dfn}

\begin{lemma}\label{lem:VR_normal}
Valuation ring $\cala\subseteq K$  are normal. 
\end{lemma}
\begin{proof}
Valuation ring $\cala$ is a subring of a field, thus always an integral domain, and $\text{Frac}(\cala)\subseteq K$.
Suppose $f\in K-\cala$ is integral over $\cala:$
$$
f^n+a_1 f^{n-1}+...+a_n=0
$$
Each $v(a_i)\geq 0$ because $a_i\in \cala$ but $v(f)\leq 0$ get a contradiction as before.
\end{proof}

Custom: one extends $v: K^\times\lrta G$ to $v: K\lrta G\cup \{\infty\}$ by $v(0):=\infty$.
Then $\cala:=\{x\in K:v(x)\geq 0\}$, $\scm:=\{x\in K:v(x)>0\}$.\\

\begin{ex}
$K=k(X)=Frac(k[X])$. Each $f\in K^\times$ may be written $f=X^n\frac{P}{Q}$, where $P,Q\in k[X]$ and $X\nmid P\cdot Q$ in $k[X]$, $v(f):=n$. This defines a valuation with the corresponding ring 
$\cala=k[X]_\scp,\scp=(X)$. 

for example
$v(X+X^2)=v(X(X+1))=1$
\end{ex}
\begin{ex}
$\cala=k[[X]], K=k((X)), v(\sum a_i X^i):=min\{i:a_i\neq 0\}$ is  a valuation ring.
\end{ex}
\begin{ex}
$k[X^2,X^3]$ is not normal thus not a valuation ring.
\end{ex}
\begin{ex}
$k[X(X-1),X^2(X-1)]$ is not normal thus not a valuation ring.
\end{ex}

\begin{lemma}\label{lem:equiv_defs_VR}
Let $\cala\subseteq K$ be a subring in a field. Then the following are equivalent:
\begin{enumerate}[label=(\roman*)]
\item $\cala$ is a valuation ring (VR) of some $v$
\item $x\in K-\cala\Lrta 1/x\in \cala$ (i.e., $\forall x\in K$, either $x\in \cala$ or $1/x\in \cala$ or both.)
\end{enumerate}
\begin{proof}
$(i)\Lrta (ii)$, Say $\cala$ is a VR
 corresponding to $v:K^\times\lrta G$, if $x\in K-\cala$, then $v(x)< 0$, so $v(1/x)>0$, so $1/x\in \cala$. 

 $(ii)\Lrta (i)$:\\
Set $G:=K^\times/\cala^\times$ (quotient of multiplication group), 
$\sigma:K^\times\lrta G$\\
Define $``\leq \text{ on }G'':$
$x\cala^\times\leq y\cala^\times\Llrta y\in x\cala$ or equivalently $(y x^{-1}\in\cala)$.

\underline{Claim}: Then ``$\leq $'' is total order. 

Indeed, let $x\cala^\times, y\cala^\times\in G$. Take representatives $x,y\in K^\times$. Then $x/y\in K^\times$. If $x/y\in \cala$, then $x\in y\cala^\times$, so $y \cala^\times\leq x \cala^\times$.

If $x/y\in\cala$. Then $x\in y\cala$, $y\cala^\times\leq x\cala^\times$.

Else, $x/y\in K-\cala$, so $y/x\in\cala$ by $(ii)$ hence $x\cala^\times\leq y\cala^\times$.

We also have the equality, $x\cala^\times=y\cala^\times\Llrta $ both $x/y$ and $y/x$ are in $\cala$.

\underline{Claim}: $\sigma$ satisfies the valuation criteria and $\cala$ is induced by $\sigma$.

$\sigma(f_1f_2)=\sigma(f_1)\sigma(f_2)$: because $\sigma$ is a group morphism.

$\sigma(f_1+f_2)\geq \min\{\sigma(f_1),\sigma(f_2)\}$ and $\sigma(f_1+f_2)=\min\{\sigma(f_1),\sigma(f_2)\}$ if $\sigma(f_1)\neq \sigma(f_2)$: 

Suppose $\sigma(f_1)\geq \sigma(f_2)$ $\Lrta f_1 f_2^{-1}\in\cala$: $(f_1+f_2)f_2^{-1}=f_1f_2^{-1}+1\in\cala$, then $\sigma(f_1+f_2)\geq \min\{\sigma(f_1),\sigma(f_2)\}$.\\
If $\sigma(f_1)\neq \sigma(f_2)$ $\Llrta$ either $f_1/f_2$ or $f_2/f_1\in K-\cala$ but not both. Assume $f_1/f_2\in\cala, f_2/f_1\in K-\cala$, $\Lrta \min\{\sigma(f_1),\sigma(f_2)\}=\sigma(f_2)$. $(f_1+f_2)f_2^{-1}\in\cala$ always holds, it remains to check whether $f_2(f_1+f_2)^{-1}\in \cala$.
Indeed
$$
\frac{f_2}{f_1}\in K-\cala\Lrta \frac{f_1+f_2}{f_1}=1+f_2/f_1\in K-\cala\Lrta  \frac{f_1}{f_1+f_2}\in\cala
$$
$$
f_2(f_1+f_2)^{-1}=\frac{(f_1+f_2)-f_1}{f_1+f_2}=1-\frac{f_1}{f_1+f_2}\in\cala
$$ 

Set $\cala'=\{x\in K^\times:\sigma(x)\geq 0_G\}\cup\{0_K\}$, where $0_G$ is multiplicative identity $1\cdot\cala^\times$ in $K^\times/\cala^\times$. 

\underline{Claim}: $\cala=\cala'$.

$x\in \cala'\Lrta \sigma(x)\geq 0_G=1\cdot\cala^\times\Lrta x\in 1\cdot\cala=\cala$ $\cala'\subseteq\cala$.

$x\in \cala, x\in 1\cdot\cala\Lrta \sigma(x)\geq 0\Lrta x\in \cala'$.


\end{proof}
\end{lemma}

\begin{thm}\label{thm:integral_closure_VR}
Let $\cala\subseteq K$ $K$ is a field. $\overline{\cala}:=$ integral closure of $\cala$ in $K$. Then 
$$
\overline{\cala}=\cap_{\substack{\calb:\text{VR, in $K$}\\, \text{with $\cala\subseteq \calb\subseteq K$}}}\calb
$$
\end{thm}
\begin{proof}
``$\subseteq$'': if $x\in K$ is integral over $\cala$, then $x$ is also integral over each $\calb\supseteq \cala$, but $\calb: \text{ VR }\Lrta\calb$ normal~\ref{lem:VR_normal}, hence $x\in \calb$. Thus $\overline{\cala}\subseteq \cap_{...}\calb$

``$\supseteq$'': Need to show that if $f\in K$ is not integral over $\cala$.

\underline{Want}: $\exists $ VR $\calb\supseteq \cala$ with $f\notin \calb$.

$f$ not integral over $\cala$ $\Lrta f\notin \cala[1/f]\Lrta 1/f\notin \cala[1/f]^\times$: \\
$\exists \scp\subset\cala[1/f]$ primes so that $1/f\in \scp$.

Then quote the Lemma bellow
\begin{lemma}\label{lem:VR_lieover}
$\calr\subseteq K$ , a subring in a field, given $\scp\in \text{Spec}(\calr)$, then there exists a valuation ring $\calb$ s.t., $\calr_\scp\subseteq\calb\subseteq K$ s.t. the maximal $\scm$ of $\calb$ s.t. $\scm\cap\calr=\scp$.
\end{lemma}

With Lemma~\ref{lem:VR_lieover}, we can proceed on. Set $\calr=\cala[1/f]$ and $\scp$ to be a prime in $\cala[1/f]$ that contains $1/f$. Then $1/f\in\scp\Lrta f\notin\calb$.
\end{proof}

\begin{proof}(of Lemma~\ref{lem:VR_lieover} due to Matsumura)

Set $\Sigma:=$ \{rings $\calc$: $\calr_\scp\subseteq \calc\subseteq K, \scp\calc\subsetneq \calc$\}, partially ordered by inclusion. We have $\calr\in\Sigma$, so $\Sigma \neq \emptyset$. Moreover a union of a chain is again an element in $\Sigma$, so by Zorn's Lemma, there is a maximal element. We assume $\calb$ is the maximal element of $\Sigma$. Since $\scp\calb\subsetneq \calb$, there exists a maximal ideal $\scm$ of $\calb$ containing $\scp\calb$. Since $\calb\subseteq\calb_\scm$ and $\scp\calb_\scm\subsetneq\calb_\scm$ $\Lrta\calb_\scm\in \Sigma$, by maximality of $\calb$, we have $\calb=\calb_\scm$. So $(\calb,\scm)$ is a local ring. Also $\text{rad}(\scp\calb)=\scm$. Indeed, we have that for any prime that contains $\scp\calb$, the ring $\calb$ is local with maximal ideal $\scm$. Thus there is only one such prime.

\underline{Claim}: $\scm\cap\calr=\scp$:

$\scp\subseteq\scp\calb\cap\calr\subseteq\scm\cap\calr$ (This is guaranteed by $\scp\calb$ being a proper ideal)

$\scm\cap\calr=\scm\cap\calr_\scp\cap\calr$ 
(This is guaranteed by $\calr\subseteq\calr_\scp\subseteq K$, and $\calr\subseteq\calb\subseteq K$, where we regard it as intersection of subsets in $K$)

$\scm\cap\calr_\scp$ is an ideal of $\calr_\scp$ 
(This is gauranteed by $\calr_\scp\subseteq\calb$)
$\Lrta \scm\cap\calr_\scp\subseteq\scp\calr_\scp$

$\scm\cap\calr\subseteq\scp\calr_\scp\cap\calr=\scp$. 

Altogether, we have $\scp=\scm\cap\calr$. 

\underline{Claim}: $(\calb,\scm)$ is a valuation ring of $K$.

\underline{Want}: For $x,1/x\in K^\times$, at least one of $x,1/x$ lies in $\calb$.

Assume $x$ is not contained in $\calb$. Then $\calb[x]$ properly contains $\calb$. So by maximality of $\calb$, we know $\scp\calb[x]=\calb[x]$
$$
1=b_0+...b_{n-1}x+b_nx^n, \text{ where $b_i\in\scp\calb$}
$$



Write: $(1-b_0)=\sum_{i=1,...,n}b_i x^i\equiv 1\mod \scp\calb$. Hence $(1-b_0)\equiv 1\mod \scm$, hence  $(1-b_0)\in \calb^\times$. If we multiply both side by $x^{-n}$:
$$
(1-b_0)x^{-n}=\sum_{i=1,...,n}b_i x^{i-n}.
$$
Thus $\frac{1}{x}: $ integral over $\calb$. Thus $\calb[\frac{1}{x}]$ integral over $\calb$.

\underline{Want}: $1/x\in \calb$. 

By ``Lying-Over''~\ref{thm:integral_extension_goingup}, $\exists \scn\in \text{Spec}(\calb[\frac{1}{x}])$ with $\scn\cap \calb=\scm$.

Then $\scp\calb[\frac{1}{x}]\subseteq\scm\calb[\frac{1}{x}]\subseteq \scn\subsetneq \calb[\frac{1}{x}]$.

So maximality of $\calb\Lrta \calb[\frac{1}{x}]=\calb\Lrta \frac{1}{x}\in \calb$.
\end{proof}

\subsection{Lecture 26. Discrete Valuation Ring and Normality}
\begin{dfn}
A valuation $v:K^\times\lrta G$ is \textbf{discrete} if $G\cong \intg, v\neq 0$. It is \textbf{normalized} if $v$ is surjective: $v(G)=\intg$. In general, $v(K^\times)=n\intg$ for some $n\in \intg_{\geq 1}$, so $\frac{1}{n}v$ is normalized. A \textbf{discrete valuation ring} (DVR) is a VR attached to a normalized discrete valuation.
\end{dfn}

\begin{ex}
$\cala=k[x]_{(x)}$, $v(x^n\frac{u}{v}):=n$ for $x\nmid uv$, $u,v\in k[x]$

or $\cala=k[[x]]$ as before.

$\intg_{(p)}:\{x=p^n\frac{a}{b}\in \ratl|a,b,n\in \intg, b\neq 0,p\nmid ab\}$, $v(x):=n\}$.
\end{ex}
\begin{nex}
$\cala=\cup_{n\geq 1}k[[X^{1/n}]]\ni f=\sum_{i\in\ratl}a_i X^{i}$. $v(f):=\min\{i:a_i\neq 0\}$, $v:K^\times\lrta \ratl$.
\end{nex}

\begin{dfn}
Let $\cala\subset K$ be a DVR with normalized valuation
$$
v:K\lrta \intg\cup \{\infty\}
$$
$$
\scp=\{x\in K|v(x)\geq 1\}
$$

A \textbf{uniformizer} is an element $\varpi$ with $v(\varpi)=1$.
\end{dfn}
\begin{lemma}
Each $x\in K^\times$ is uniquely of the form
$$
x=u \varpi^n
$$
for some $u\in \cala^\times, n\in \intg$. One has $v(x)=n$, hence $n\geq 0\Llrta x\in \cala$, $n\geq 1\Llrta x\in \scp$.
\begin{proof}
Let $n:=v(x),u:=x\varpi^{-n}$, then $v(u)=v(x)-n v(\varpi)=n-n=0$, so $u\in \cala^\times$. This proof is independent on the choice of uniformizer $\varpi$.
\end{proof}
\end{lemma}

\begin{lemma}\label{lem:DVR_PID+}
The ideals in $\cala$ are $(0)$ and $(\varpi^n)$. Moreover: $(\varpi^n)=\scp^n$ $\forall n\in \intg_{\geq 0}$. Any two uniformizer differ by a unit: $\varpi'=u\varpi,u\in \cala^\times$. Moreover,
$$
\{\text{uniformizer}\}=\scp-\scp^2.
$$
\begin{proof}
If $x=u\varpi^n\in \cala (n\geq 0)$, then $(x)=(\varpi^n)$. If $\sca\subseteq \cala$ is any nonzero ideal, let $n:=\min\{v(x):0\neq x\in \sca\}$.

Then $\forall y\in \sca$, we have $v(y)\geq n =v(\varpi^n)$. So $v(y\varpi^{-n})\geq 0$, so $y\varpi^{-n}\in\cala$. Hence, any $y\in (\varpi^n)$. Thus $\sca\subseteq (\varpi^n)$. Conversely, $\exists x\in \sca$ with $v(x)=n$. Then $v(\varpi^n/x)=0$. So $\frac{\varpi^n}{x}\in \cala^\times$, so $(\varpi^n)\subseteq (x)\subseteq \sca$. Thus $\sca=(\varpi^n)$

Thus, $\scp$ maximal $\Lrta$ $\scp=(\varpi)\Lrta \scp^n=(\varpi^n)$.

The same argument works for any other $\varpi'$. Gives $(\varpi')=\scp=(\varpi)\Lrta \varpi'\in\cala^\times\varpi$.

Also $\varpi\notin\scp^2$, alse $(\varpi)=(\varpi^2)\Lrta v(\varpi)=0$ contradiction.

See form the proof that $\forall 0\neq x\in \cala,$
$v(x)=\min\{n\geq 0|x\in \scp^n\}$. Thus the last statement holds.
\end{proof}
\end{lemma}
\begin{cor}
($\cala$ DVR) then $\cala$ is Noetherian.
\begin{proof}
Indeed, every ideal is principal hence finitely generated.
\end{proof}
\end{cor}

\begin{cor}
$\text{Spec}(\cala)=\{(0),\scp\}$, $\scp\neq (0)$.
\end{cor}

\begin{cor}
$\text{dim}(\cala)=1$.
\end{cor}

\begin{cor}\label{cor:PID-_regular}
$\cala$ regular:
\begin{proof}
i.e., $dim_k(\scp/\scp^2)=\text{dim}(\cala)=1$. 
$$
dim_k(\scp/\scp^2)=\{\text{minimal number of generators of $\scp$}\}
$$
by a corollary of Nakayama lemma~\ref{cor:Nakayama}:
And it equals to 1 because $\scp=(\varpi)$
\end{proof}
\end{cor}

\begin{cor}
$\cala$ DVR $\Lrta \cala$ VR $\Lrta $ $\cala$ normal.
\end{cor}

\begin{cor}
The set \{nonzero $\cala$-submodule of $K$\} forms a group $\cong \intg$. They are of the form $\cala\varpi^n, n\in \intg$. $\cala\varpi^m\cdot \cala\varpi^n=\cala\varpi^{m+n}$
\end{cor}

Now, Let $\cala:$ Noetherian local domain of dimension $\text{dim}(\cala)=1$. DVR gives examples of such $\cala$. But there are also Non-DVR examples
$$
\cala=k[[x^2,x^3]]=\left\{f=\sum^{\infty}_{i=0}a_i x^i|a_i\in k, a_1=0\right\},
$$
$$
\scm=(x^2,x^3).
$$
because it is  not normal, nor regular.
\begin{thm} $(\cala,\scp)$ is Noetherian local domain with $\text{dim}(\cala)=1$.  
The following are equivalent.
\begin{itemize}
\item $\cala$ DVR
\item $\cala$ normal
\item $\cala$ PID
\item $\cala$ regular
\end{itemize}

We also introduce the some other notions:
\begin{itemize}
\item $PID^-:$ $\scp$ is principal $\exists \varpi\in \cala$ s.t $\scp=(\varpi)$.
\item
 $PID^{+}:$ $\exists \varpi \in\cala$ s.t. every nonzero ideal in $\cala$ is of the form $(\varpi^n)$, for some $n\geq 0$.
\end{itemize}
The interdependence of is the following diagram:
\[
\begin{tikzcd}
\boxed{DVR} \arrow[d, "\checkmark by~\ref{lem:VR_normal}"] \arrow[r, "\checkmark by~\ref{lem:DVR_PID+}", bend left] & \boxed{PID^+} \arrow[l, "(III)"', bend left] \arrow[d, "\checkmark"] \\
\boxed{Normal} \arrow[u, "(I)", bend left] & \boxed{PID} \arrow[d, "\checkmark"] \\
\boxed{Regular} \arrow[r, leftrightarrow, "\checkmark by \ref{cor:PID-_regular}"] & \boxed{PID^-} \arrow[uu, "(II)"', bend right]
\end{tikzcd}
\]
\end{thm}

\textbf{Sublemma 1}\\
$\cala$ Noetherian local domain, $\text{dim}(\cala)=1$, $\scp:=$ the maximal ideal, $K:=Frac(\cala)$.
Then $\forall x\in K,\exists n\geq 0$ s.t., $x\scp^n\subseteq \cala$,
\begin{proof}
Write $x=u/v, 0\neq v\in \cala$. It suffices to find $n\geq 0$ s.t., $\scp^n\subseteq(v)$. But $\text{dim}(\cala)=1$ $\scp$ is the only prime that contains $(v)$. $\text{dim}(\cala/(z))=0$. Then, by~\ref{thm:Artin_equiv_Noetherin+dim=0},  $\cala/(z)$ is local Artinian with maximal ideal $\scp/(z)$ but by~\ref{prop:Noetherian_local_Artinian_nilpotent}, $\exists n\geq 0$ s.t. $(\scp/(z))^n=0$. $\exists n\geq 0$ s.t. $\scp\subseteq(z)$.
\end{proof}

\textbf{Sublemma 2}\\
$(\cala,\scp)$ Noetherian local domain $K:=Frac(\cala)$. Let $y\in K$ s.t. $y\scp\subseteq \cala$. Then either
\begin{enumerate}[label=(\roman*)]
\item $1/y\in \scp$, or
\item $y$ integral over $\cala$
\end{enumerate}
\begin{proof}
If $y\scp=\cala$, then $yt=1$ for some $t\in \scp$, hence $1/y=t\in\scp$. Else $y\scp\subsetneq \cala$, so $y\scp\subset\scp$. $\cala$ Noetherian, so $\scp$ finitely generated. $\scp$ is a faithful $\cala[y]$-module which is finitely generated as $\cala$-module, then by~\ref{lem:characterization_integral}, $y$ is integral over $\cala$.
\end{proof}
\textbf{Sublemma 3} $\cala$ is Noetherian valuation ring $\Llrta$ $\cala$ is a field or $\cala$ is a DVR.
\begin{proof}\ \\
$(\Llta), \checkmark$\\
$(\Lrta)$:\\
Suppose $\cala$ is a Noetherian VR, by definition it is local integral domain. Then $\scp=(\varpi_1,...,\varpi_n)$.

Let $v: K\lrta G\cup \{\infty\}$ be valuation that determines $\cala$. If $\cala=K$, then $\cala$ is a field. Else $v(K^\times)=K^\times/\cala^\times\neq \{0\}$. Recall the construction of the valuation in~\ref{lem:equiv_defs_VR}, $\exists x\in\cala $ s.t. $1/x\notin\cala$. So $\cala$ contains nonzero non-units, so $\scp\neq (0)$, and $v(\varpi_j)> 0$. Let $g:=\min(v(\varpi_1),...,v(\varpi_n))$. Say $g=v(\varpi_1)$, Then $v(\varpi_j/\varpi_1)\geq 0$, so $\varpi_j\in \cala \varpi_1$, so $\scp=(\varpi_1)$. ($PID^-$)

Now given $x\in \cala-\{0\}$. by Krull's intersection theorem~\ref{thm:Krull_intersection} that $\cap_{n\geq 0}\scp^n=(0)$, we may choose $n\geq 0$, s.t. $x\in \scp^n$, $x\notin \scp^{n+1}$. Thus $\frac{x}{\varpi^n}=:u\in \cala-\scp=\cala^\times$. So $(x)=\scp^n$, $v(x)=ng$. ($PID^+$)

Thus $v:K^\times \surj \intg g\cong \intg$, the second isomorphism because $g\neq 0$.
\end{proof}

The proof of sublemma 3 also shows
$$
PID^-\Lrta PID^+\Lrta DVR
$$
which finishes the $(II)$ and $(III)$ in the diagram (Under the condition that $\cala$ is a Noetherian VR).
\begin{proof}\ \\
Now it suffices to show that a normal Noetherian local domain $\cala$, with $\text{dim}(\cala)=1$ is VR.
As we showed in theorem~\ref{lem:VR_lieover}, there is a VR $(\calb,\scm)$, with $\cala\subseteq \calb\subseteq K$ and $\cala\cap \scm=\scp$, it suffices to show that $\calb=\cala$. Here we choose $K=\text{Frac}(\cala)$. 

Let $v:K\lrta G\cup \{\infty\}$ be a defining valuation for $\calb,$ then $\calb=\{x\in K|v(x)\geq 0\},\scm=\{x\in K: v(x)>0\}$. So $v(\scp)>0$. Let $x\in \calb$. Then $x\in K$, so by sublemma 1, $\exists n\geq 0$ so that $x\scp^n\subseteq \cala$. Choose $n$ minimal with this property.

If $n=0$, then $x\in \cala$, so we are done. 

Else $n\geq 1$, and $x\scp^{n-1}\not\subseteq\cala$, so $\exists y\in x\scp^{n-1},y\notin \cala$. Then $y\scp \subseteq x\scp^n\subseteq \cala$,  so by Sublemma 2: either $1/y\in\scp$ or $y$ integral over $\cala$.

If $1/y\in\scp$, then $v(1/y)=-v(y)>0$, but $y\in\scp^{n-1}x$ and $v(x)\geq 0$, $v(\scp)>0$, so $v(y)\geq 0$. contradiction.

If $y$ is integral over $\cala$, then since $\cala$ is normal, deduce that $y\in\cala$, but $y\notin \cala$ contraction.
\end{proof}

\subsection{Lecture 27. Dedekind Domain}
\begin{dfn}
A \textbf{Dedekind domain} $\cala$ is a normal Noetherian domain of dimension one. Equivalently, $\cala$ is Noetherian domain s.t.
\begin{itemize}
    \item $\cala$ is integrally closed in $K=Frac(\cala)$,
    \item Every nonzero prime is maximal,
    \item $\cala\neq K$
\end{itemize}
\end{dfn}

\underline{Restatement of Last theorem:} A local Dedekind domain is a DVR. 
\begin{lemma}If $\cala$ is a Dedekind domain.
Any localization such that $S^{-1}\cala\neq K$ is a Dedekind domain. In particular: $\cala$ is Dedekind and $\text{Spec}(\cala)\ni\scp\neq 0$, then $\cala_\scp$ is Dedekind domain.
\end{lemma} 
\begin{proof}
Just need to check that every condition is preserved by localization. Remains only to check:
\begin{lemma}
Let $\cala$ domain. Then the following are equivalent:
\begin{enumerate}[label=(\roman*)]
\item $\cala$ normal
\item $\cala_\scp$ is normal $\forall$ primes $\scp$
\item $\cala_\scm$ normal $\forall$ maximal ideals $\scm$
\end{enumerate}
\begin{proof}
$K:= Frac(\cala)=Frac(\cala_\scp)$,
$(i)\Lrta (ii)$ Let $x\in K$ be integral over $\cala_\scp$: 
$$
x^n+a_1 x^{n-1}+...+a_n=0
$$
with each $a_j\in\cala_\scp$, say $a_j=\frac{b_j}{s_j}$, $b_j\in \cala$, $s_j\in\cala-\scp$.
Set $s:=s_1\cdot\cdot\cdot s_n\in\cala-\scp$. $y:=sx\in K$, $x=y/s$, $sa_j\in\cala b_j\subseteq \cala$.
Then 
$$
y^n+s a_1 y^{n-1}+...+s^{n-1}a_n
=0
$$
with each coefficients in $\cala$, so since $\cala$ is normal, deduce that $y\in\cala$, hence that $x=y/s\in\cala_\scp$

$(ii)\Lrta (iii)\checkmark$

$(iii)\Lrta (i)\checkmark$: Let $x\in K$ be integral over $\cala$. Know each $\cala_\scm$ is normal. So $\forall \scm:$ maximal, we may write 
$$
x^{N}+a_1x^{N-1}+...+a_{N}=0
$$
for some $N\geq 0$, $a_{j}\in\cala_\scm$. $x\in\cala_\scm$ because $\cala_\scm$ is normal. Then there exists an $s_\scm\in\cala-\scm$ s.t. $s_\scm x\in\cala$. The ideal $\sum_{\scm,\text{max'l}}\cala s_\scm\not\subseteq \scm\forall\scm$, hence $\sum_{\scm}\cala s_\scm=\cala\ni 1$, so $\exists \scm_1,...,\scm_n,$ $\lambda_1,...,\lambda_n\in \cala$ s.t.,
$$
1=\sum\lambda_js_{\scm_j}
$$
Then $x=x\cdot 1=\sum_j\lambda_j s_{\scm_j}x$, where $s_{\scm_j}x\in\cala\Lrta x\in\cala$.
\end{proof}
\end{lemma}
Being normal is a local property, then $S^{-1}(\cala)$ is normal for a normal ring $\cala$ and arbitrary multiplicative set.
\end{proof}

\begin{lemma}
$\cala$ Dedekind domain $\Llrta $ $\cala_\scm$ is Dedekind domain $\forall\scm$.
\end{lemma}


\begin{ex}
If $\cala$ is a PID, not a field, then $\cala$ is Dedekind.
\begin{proof}
PID $\Llrta$ every ideal principal (finitely generated) $\Lrta $ Noetherian.

PID $\Lrta $ UFD $\Lrta$ normal.

$\forall\scm\in Spem(\cala)$, $\cala_\scm$ Noetherian local domain with principal maximal ideal $\Lrta \text{dim}(\cala_\scm)\leq 1$ by Krull principal ideal theorem~\ref{thm:Krull_dimension}.\\
$\text{dim}(\cala)\leq sup_\scm \text{dim}(\cala_\scm)$. $\cala$ not a field then $\cala\neq 0$. 
\end{proof}
\end{ex}

\begin{thm}\label{thm:finitness_integral_closure}
Let $\cala$ be a normal Noetherian domain, $K:=Frac(\cala)$, $L/K$ is a finite separable field extension. and $\calb$ is the integral closure of $\cala$ in $L$. Then $\calb$ is finite over $\cala$ and is Noetherian.
\end{thm}
as a corollary, because integral extension preserves dimension, we have:
\begin{prop}
$\cala$ is Dedekind, $K:=\text{Frac}(\cala)$, $L/K$ is a finite separable field extension. Then the integral closure $\calb$ of $\cala$ in $L$ is also Dedekind.
\end{prop}

\begin{cor} Choose the special case $\cala=\intg$ and $K=\ratl$.
The ring of integers (integral closure of $\intg$ in the number field) in any number field (finite field extension over $\ratl$) is Dedekind. 
\end{cor}

\begin{proof}
Reduced the proof to checking that $\calb$ is Noetherian. For this, it suffices to show that $\calb$ is finitely generated $\cala$-module because $\cala$ is Noetherian.

 Recall (every finite field extension is algebraic) the proof of~\ref{prop:integral_closure_in_algebraic_field_extension}, we saw $\exists u_1,...,u_n\in\calb$, a $K$-basis of $L$. $\leadsto$ dual basis $v_1,...,v_n\in L$, a $K$-basis for $L/K$ separable. s.t., with
 $$T:L\lrta K$$
$$z\longmapsto trace_{L/K}(M_z),$$
where $M_z$ is multiplication by $z$
we have $T(u_iv_j)=\delta_{ij}$.We had used without proof that $L/K:$ Separable $\Lrta $ the bilinear form $L\times L\ni (x,y)\longmapsto T(xy)\in K$ is non-degenerate. 

Sketch of the proof: non-degeneracy means 
$$
\nexists 0\neq x\in L, s.t., T(xy)=0,\forall y\in L
$$
$$
\Llrta L \lrta L^*=Hom_{K}(L,K)
$$
$$
x\longmapsto [y\mapsto T(xy)] 
$$
is isomorphism.

Since this system is linear in $x$, we can extend scalar: it suffices to check $\nexists 0\neq x\in L\otimes_K K^s$, $K^s$ is the separable closure of $K$. s.t., $T(xy)=0\forall y\in L\otimes_K K^s$. But $L\otimes_K K^s=(K^s)^{[L:K]}$ $\Llrta L/K$ separable. Hence $T$ is the $K^s$-linear extension of $T$
$$
T:L\otimes_K K^s\lrta K^s
$$
$$
t\otimes z\longmapsto T(t)z
$$
$\leadsto$
$$
T:(K^s)^{[L:K]}\lrta K^s
$$
$$
(z_i)\longmapsto \sum z_i
$$
s.t.  with $T:L\lrta K$, $z\longmapsto trace_{L/K}(M_z)$, we have $T(u_i v_i)=\delta_{ij}$

\underline{Claim}: $\calb\subseteq \oplus_i \cala v_i\subseteq \oplus_i K v_i=L$. $\cala$ Noetherian $\Lrta \oplus \cala v_i$ is Noetherian $\Lrta \calb$ is finitely generated $\cala$-module $\Lrta \calb$ is Noetherian.

Indeed, let $x\in \calb$. Write $x=\sum x_i v_i$ with $x_i\in K$. 

\underline{Want:} $x_i\in \cala=\calb\cap K$.

Indeed, 
$$
T(x\cdot u_i)=x_i,
$$
 where $x\cdot u_i\in\calb$ and the equality from $T:K$-linear.

Reduce to checking: $T(\calb)\subseteq \cala$. Case $L/K$ Galois:
$$
T(x)=\sum_{\sigma\in Gal(L/K)
} x^\sigma
$$

Recall that $G(L/K) $ acts on $\calb$, $x\in \calb\Lrta $ each $x^\sigma\in \calb$. $T(x)\in\calb\cap K=\cala$, the last equality from $\cala$ being normal.

For the purpose of proving that $\calb$ Noetherian, we can reduce to the Galois case.
\[
\begin{tikzcd}
\calb_1 \arrow[r, Subseteq] & L_1 \\
\calb \arrow[r,Subseteq] \arrow[u,Subseteq] & L \arrow[u,Subseteq] \\
\cala \arrow[r,Subseteq] \arrow[u,Subseteq] & K \arrow[u,Subseteq]
\end{tikzcd}
\]
There always exists a extension $L_1/L$ such that $L_1/K$ is Galois, and we define the $\calb_1$ to be the integral closure of $\calb$ in $L_1$.
Our proof the show that $\calb_1$ is fin. gen $\cala$-module. since $\cala$ is Noetherian, conclude that $\calb$ is fin.gen. $\cala$-module, thus $\calb$ is Noetherian.
\end{proof}

\subsection{Lecture 28. Fractional Ideals}
\begin{lemma}
$\cala$ Noetherian domain of dimension 1, (every prime  ideal is maximal.) Then every nonzero ideal $\sca\subseteq \cala$ factor uniquely(up to reordering) as a product of primary ideals with distinct radicals.
$$
\sca=\prod_{i=1}^n\scq_i
$$
where $\text{rad}(\scq_i)=:\scp_i\neq \scp_j:=\text{rad}(\scq_j)$
\end{lemma}
\begin{proof}
\underline{Existence}: Let $\scq=\cap_i\scq_i$  be a MPD, $\scp_i=\text{rad}(\scq_i)$. Then, since $\sca\neq 0$, know that each $\scp_i\neq 0$, hence the $\scp_i$ are maximal and distinct: $\scp_i+\scp_j=\cala,\forall i\neq j$. Hence the $\scq_i$ are pairwise coprime. Hence $\cap\scq_i=\scq=\prod\scq_i$.

\underline{Uniqueness}: Suppose $\scq=\prod\scq_i$, with $\scp_i\neq \scp_j\forall i\neq j$. Then as before, the $\scp_i\neq 0$, hence maximal and distinct, hence pairwise coprime, hence $\sca=\cap \scq_i$ is a MPD with each component isolated. we conclude by ``2nd uniqueness theorem''~\ref{thm:secon_unique_decomposition} isolated components in a MPD are unique.
\end{proof}

\begin{thm}
In a Dedekind domain, 
\begin{enumerate}[label=(\roman*)]
\item any power of a nonzero prime is primary,
\item any nonzero primary  is a power of its radical,
\item any nonzero ideal is uniquely a product of prime ideals.
\end{enumerate}
\begin{proof}
(i): nonzero prime $\Lrta$ maximal, (dim =1). power of maximal ideals are primary.

(ii) True if $\cala$ local, because the $\cala$ DVR. In general.
$$
\{\scp\text{-primary ideals in }\cala\}\llrta \{\scp\cala_\scp\text{-primary idaels in }\cala_\scp\}
$$
$$
=\{\text{non-zerp ideals in $\cala_\scp$}\}=\{\text{powers of $\scp\cala_\scp$}\}
$$

(iii)$\Llta$ (i)+(ii)+Lemma above. 
\end{proof}
\end{thm}

\begin{dfn}
Let $\cala$ domain. $\cala$ fractional ideal is a submodule $T\subseteq K:=Frac(\cala)$ s.t. $x I\subseteq \cala$ for some $0\neq x\in\cala$.
\end{dfn}
\begin{ex}
If $I=\cala y$ for some $y\in K$, then $I$ is fractional ideal: $y=u/v$, $u,v\in\cala$, $v\neq 0$
So $v I=\cala u\subseteq \cala$. More generally, any finitely generated submodule $I\subseteq K$ is a fractional ideal:
$$
I=\sum_{i=1}^n\cala y_i, y_i=\frac{u_i}{v_i}.
$$
then $v_1,...,v_n I\subseteq \sum\cala u_i\subseteq \cala$.
\end{ex}
If $\cala$ Noetherian and $I$ fractional ideal, then $I $ finitely generated 
(Pf. $x I\subseteq \cala$ for some $0\neq x\in \cala$ $\Lrta xI$ finitely generated, say $xI =\sum\cala z_i,z_i\in \cala$ ,then $I=\sum\cala \frac{z_i}{x}$
)

\begin{dfn}
$$
I\cdot J:=\{\sum_i a_i b_j: a_i \in I, b_i\in J\}
$$
\end{dfn}

\begin{dfn}
An \textbf{invertible ideal} is a submodule $I\subseteq K$ s.t. $\exists$ submodule $J\subseteq K$ s.t., $IJ=A$
\end{dfn}

If $I$ is invertible and $IJ=\cala$ $\Lrta J=(\cala: I):=\{x\in K: xI \subseteq \cala\}$. This is because 
$J\subseteq (\cala:I)=(\cala:I) I\cdot J\subseteq \cala\cdot J=J$

So invertible ideals form a group.
\begin{thm}
$\cala$ Dedekind domain. The every nonzero fractional ideal is invertible. The group of nonzero fractional ideal is free on the nonzero primesL
$$
\oplus_{0\neq \scp\subset\cala}\intg\lrta \{\text{nonzero fractional ideals}\}
$$
$$
(n_\scp)_\scp\longmapsto \prod_\scp\scp^{n_\scp}
$$
\begin{proof}
Let $I$ nonzero fractional idael. Thus $xI \subseteq\cala$ for some $0\neq x\in \cala$. If $\cala$ local, then
$$
x=\varpi^nu,n\geq 0
$$
$$
xI=(\varpi^m),m\geq 0
$$
$$
\Lrta I=\cala\varpi^{m-n}
$$
$$
\Lrta I\text{ invertible}
$$

$$
\intg\lrta \{\text{invertible ideals }=\}=\{\text{nonzero fractional ideals}\}
$$
$$
n\longmapsto \scp^n=(\varpi^n)
$$
\end{proof}
\end{thm}

In general, we know that $I_\scp$ is invertible $\forall \scp\neq 0$ by the local case just established. But $I\cdot(\cala:I)=\cala\Llta (I\cdot (\cala:I))_\scp\overset{?}{=}\cala_\scp$

But $(I\cdot (\cala:I))_\scp=I_\scp\cdot (\cala: I)_\scp=(\cala_\scp\cdot I_\scp)$ because $I$ finitely generated. so the general case reduce to the local case.

The last equality is left as an exercise


What is $\intg/3\otimes \intg_2$?

What is $\text{Spec}(\intg[1/6])$

What is the $\text{Ker}(\cala\lrta \cala_f)$

Fluent in goingup going down

Characterization of DVR,

nonexample of 1-dim local ring that is not DVR $k[[x^2,x^3]]$

equivalence of defs like radicals

Show that valuation ring is normal.

example of artin local ring which is not a field.

give an example of non-flat module

Going through homework and exercise of A-M.

Eisenbud chap1 motivation.

\end{document}


